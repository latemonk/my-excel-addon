/*! For license information please see taskpane.js.LICENSE.txt */
!function(){var e={58394:function(e,n,t){"use strict";e.exports=t.p+"e5a3431ffc548452db5a.css"}},n={};function t(r){var o=n[r];if(void 0!==o)return o.exports;var a=n[r]={exports:{}};return e[r](a,a.exports,t),a.exports}t.m=e,t.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},function(){var e;t.g.importScripts&&(e=t.g.location+"");var n=t.g.document;if(!e&&n&&(n.currentScript&&"SCRIPT"===n.currentScript.tagName.toUpperCase()&&(e=n.currentScript.src),!e)){var r=n.getElementsByTagName("script");if(r.length)for(var o=r.length-1;o>-1&&(!e||!/^http(s?):/.test(e));)e=r[o--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),t.p=e}(),t.b=document.baseURI||self.location.href,function(){"use strict";new URL(t(58394),t.b)}(),function(){function e(n){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(n)}function n(e,n){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,n){if(e){if("string"==typeof e)return t(e,n);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?t(e,n):void 0}}(e))||n&&e&&"number"==typeof e.length){r&&(e=r);var o=0,a=function(){};return{s:a,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,c=!0,l=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return c=e.done,e},e:function(e){l=!0,s=e},f:function(){try{c||null==r.return||r.return()}finally{if(l)throw s}}}}function t(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=Array(n);t<n;t++)r[t]=e[t];return r}function r(){var e,n,t="function"==typeof Symbol?Symbol:{},a=t.iterator||"@@iterator",s=t.toStringTag||"@@toStringTag";function c(t,r,a,s){var c=r&&r.prototype instanceof u?r:u,i=Object.create(c.prototype);return o(i,"_invoke",function(t,r,o){var a,s,c,u=0,i=o||[],d=!1,g={p:0,n:0,v:e,a:m,f:m.bind(e,4),d:function(n,t){return a=n,s=0,c=e,g.n=t,l}};function m(t,r){for(s=t,c=r,n=0;!d&&u&&!o&&n<i.length;n++){var o,a=i[n],m=g.p,f=a[2];t>3?(o=f===r)&&(c=a[(s=a[4])?5:(s=3,3)],a[4]=a[5]=e):a[0]<=m&&((o=t<2&&m<a[1])?(s=0,g.v=r,g.n=a[1]):m<f&&(o=t<3||a[0]>r||r>f)&&(a[4]=t,a[5]=r,g.n=f,s=0))}if(o||t>1)return l;throw d=!0,r}return function(o,i,f){if(u>1)throw TypeError("Generator is already running");for(d&&1===i&&m(i,f),s=i,c=f;(n=s<2?e:c)||!d;){a||(s?s<3?(s>1&&(g.n=-1),m(s,c)):g.n=c:g.v=c);try{if(u=2,a){if(s||(o="next"),n=a[o]){if(!(n=n.call(a,c)))throw TypeError("iterator result is not an object");if(!n.done)return n;c=n.value,s<2&&(s=0)}else 1===s&&(n=a.return)&&n.call(a),s<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),s=1);a=e}else if((n=(d=g.n<0)?c:t.call(r,g))!==l)break}catch(n){a=e,s=1,c=n}finally{u=1}}return{value:n,done:d}}}(t,a,s),!0),i}var l={};function u(){}function i(){}function d(){}n=Object.getPrototypeOf;var g=[][a]?n(n([][a]())):(o(n={},a,function(){return this}),n),m=d.prototype=u.prototype=Object.create(g);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,o(e,s,"GeneratorFunction")),e.prototype=Object.create(m),e}return i.prototype=d,o(m,"constructor",d),o(d,"constructor",i),i.displayName="GeneratorFunction",o(d,s,"GeneratorFunction"),o(m),o(m,s,"Generator"),o(m,a,function(){return this}),o(m,"toString",function(){return"[object Generator]"}),(r=function(){return{w:c,m:f}})()}function o(e,n,t,r){var a=Object.defineProperty;try{a({},"",{})}catch(e){a=0}o=function(e,n,t,r){function s(n,t){o(e,n,function(e){return this._invoke(n,t,e)})}n?a?a(e,n,{value:t,enumerable:!r,configurable:!r,writable:!r}):e[n]=t:(s("next",0),s("throw",1),s("return",2))},o(e,n,t,r)}function a(e,n,t,r,o,a,s){try{var c=e[a](s),l=c.value}catch(e){return void t(e)}c.done?n(l):Promise.resolve(l).then(r,o)}function s(e){return function(){var n=this,t=arguments;return new Promise(function(r,o){var s=e.apply(n,t);function c(e){a(s,r,o,c,l,"next",e)}function l(e){a(s,r,o,c,l,"throw",e)}c(void 0)})}}var c=null,l=!1,u="https://excel-addon-backend.vercel.app/api/openai-proxy";Office.onReady(function(e){if(e.host===Office.HostType.Excel){!function(){te.apply(this,arguments)}(),document.getElementById("executeButton").onclick=d,document.getElementById("clearButton").onclick=z,document.getElementById("voiceButton").onclick=function(){return function(){if("https:"===window.location.protocol&&!window.location.hostname.includes("localhost"))return W("Excel Online에서는 보안 정책상 음성 인식을 사용할 수 없습니다. 데스크톱 Excel에서 이용해주세요.","error"),void(document.getElementById("voiceStatus").textContent="웹 버전 미지원");if(c)if(l)c.stop();else try{c.start()}catch(e){console.error("Voice recognition start error:",e),e.message&&e.message.includes("not-allowed")?W("마이크 권한이 필요합니다. 브라우저 설정에서 마이크 접근을 허용해주세요.","error"):W("음성 인식을 시작할 수 없습니다.","error")}else W("이 브라우저는 음성 인식을 지원하지 않습니다.","error")}()},document.getElementById("authButton").onclick=$,document.getElementById("contactButton").onclick=ee,K();var n=document.getElementById("modelSelect"),t=localStorage.getItem("excel_addon_selected_model"),r=localStorage.getItem("excel_addon_auth_key");"gpt-4.1-2025-04-14"!==t||r?t?n.value=t:(n.value="gpt-4.1-nano-2025-04-14",localStorage.setItem("excel_addon_selected_model","gpt-4.1-nano-2025-04-14")):(localStorage.setItem("excel_addon_selected_model","gpt-4.1-nano-2025-04-14"),n.value="gpt-4.1-nano-2025-04-14");var o=document.getElementById("authModal");o.querySelector(".close").onclick=function(){return q()};var a=document.getElementById("deauthModal");window.onclick=function(e){e.target==o?q():e.target==a&&H()},document.getElementById("submitAuthKey").onclick=X,document.getElementById("confirmDeauth").onclick=Z,document.getElementById("cancelDeauth").onclick=H,document.getElementById("modelSelect").onchange=ne,document.querySelectorAll(".example-item").forEach(function(e){e.onclick=function(){var e;e=this.getAttribute("data-command"),document.getElementById("commandInput").value=e,document.getElementById("commandInput").focus()}}),document.getElementById("commandInput").addEventListener("keydown",function(e){"Enter"!==e.key||e.shiftKey||(e.preventDefault(),d())}),function(){if("https:"===window.location.protocol&&!window.location.hostname.includes("localhost")){console.log("Voice recognition disabled in web environment");var e=document.getElementById("voiceButton"),n=document.getElementById("voiceStatus");return e.disabled=!0,e.style.opacity="0.5",e.style.cursor="not-allowed",n.textContent="웹 환경에서는 음성 인식 미지원",n.style.color="#666",e.title="Excel Online에서는 보안상 음성 인식을 사용할 수 없습니다. 데스크톱 Excel을 사용해주세요.",null}var t=window.SpeechRecognition||window.webkitSpeechRecognition;if(!t)return W("음성 인식이 지원되지 않는 브라우저입니다.","error"),document.getElementById("voiceButton").disabled=!0,document.getElementById("voiceStatus").textContent="음성 인식 미지원",null;(c=new t).lang="ko-KR",c.continuous=!1,c.interimResults=!0,c.maxAlternatives=1,c.onstart=function(){l=!0,document.getElementById("voiceButton").classList.add("listening"),document.getElementById("voiceStatus").textContent="듣고 있습니다... 말씀해주세요",document.getElementById("voiceStatus").classList.add("listening")},c.onresult=function(e){var n=e.results[0][0].transcript;document.getElementById("commandInput").value=n,e.results[0].isFinal?document.getElementById("voiceStatus").textContent="음성 인식 완료":document.getElementById("voiceStatus").textContent="인식중: "+n},c.onerror=function(e){console.log("Speech recognition error:",e.error,"Location:",window.location.hostname),l=!1,document.getElementById("voiceButton").classList.remove("listening"),document.getElementById("voiceStatus").classList.remove("listening");var n="음성 인식 오류",t="https:"===window.location.protocol&&!window.location.hostname.includes("localhost");switch(e.error){case"no-speech":n="음성이 감지되지 않았습니다.";break;case"audio-capture":n="마이크를 찾을 수 없습니다.";break;case"not-allowed":t?(n="Excel Online에서는 보안 정책상 음성 인식을 사용할 수 없습니다. 데스크톱 Excel에서 이용해주세요.",document.getElementById("voiceStatus").textContent="웹 버전 미지원"):n="마이크 권한이 거부되었습니다. 브라우저 설정을 확인해주세요.";break;case"network":n="네트워크 오류가 발생했습니다.";break;default:t&&e.error&&(n="Excel Online에서는 보안 정책상 음성 인식을 사용할 수 없습니다. 데스크톱 Excel에서 이용해주세요.",document.getElementById("voiceStatus").textContent="웹 버전 미지원")}t&&"not-allowed"===e.error?document.getElementById("voiceStatus").textContent="웹 버전 미지원":document.getElementById("voiceStatus").textContent=n,W(n,"error")},c.onend=function(){l=!1,document.getElementById("voiceButton").classList.remove("listening"),document.getElementById("voiceStatus").classList.remove("listening"),document.getElementById("commandInput").value.trim()?(document.getElementById("voiceStatus").textContent="음성 인식 완료. 실행 버튼을 눌러주세요.",document.getElementById("executeButton").focus()):document.getElementById("voiceStatus").textContent="음성 인식 준비"}}()}});var i=!1;function d(){return g.apply(this,arguments)}function g(){return g=s(r().m(function e(){var n,t,o,a;return r().w(function(e){for(;;)switch(e.p=e.n){case 0:if(!i){e.n=1;break}return console.log("Command already executing, ignoring duplicate call"),e.a(2);case 1:if(n=document.getElementById("commandInput").value.trim()){e.n=2;break}return W("명령어를 입력해주세요.","error"),e.a(2);case 2:return i=!0,t=document.getElementById("executeButton"),o='<span class="ms-Button-label">실행</span>',t.disabled=!0,t.innerHTML='<span class="loading"></span><span>처리중...</span>',W("명령을 처리하고 있습니다...","info"),e.p=3,e.n=4,Excel.run(function(){var e=s(r().m(function e(a){var s,c,l,u,i,d,g,f,p,y,b,v,k,w,C;return r().w(function(e){for(;;)switch(e.p=e.n){case 0:return console.log("Starting Excel.run for command execution"),s=a.workbook.worksheets.getActiveWorksheet(),c=null,e.p=1,(l=a.workbook.getSelectedRanges()).load(["areas","areaCount"]),e.n=2,a.sync();case 2:if(!(l.areaCount>1)){e.n=5;break}return(u=l.areas.items[0]).load(["address","rowIndex","columnIndex","rowCount","columnCount"]),e.n=3,a.sync();case 3:for(i=[],d=0;d<l.areas.items.length;d++)l.areas.items[d].load("address");return e.n=4,a.sync();case 4:for(g=0;g<l.areas.items.length;g++)i.push(l.areas.items[g].address);c={address:i.join(","),row:u.rowIndex+1,column:u.columnIndex+1,numRows:u.rowCount,numColumns:u.columnCount,isMultipleRanges:!0},e.n=7;break;case 5:return(f=l.areas.items[0]).load(["address","rowIndex","columnIndex","rowCount","columnCount"]),e.n=6,a.sync();case 6:c={address:f.address,row:f.rowIndex+1,column:f.columnIndex+1,numRows:f.rowCount,numColumns:f.columnCount,isMultipleRanges:!1};case 7:e.n=9;break;case 8:e.p=8,C=e.v,console.log("Error getting selected ranges, using fallback:",C),c={address:"A1",row:1,column:1,numRows:1,numColumns:1,isMultipleRanges:!1};case 9:return s.load("name"),(p=s.getUsedRange()).load(["rowCount","columnCount","values"]),e.n=10,a.sync();case 10:if(y={sheetName:s.name,activeRange:c,lastRow:p?p.rowCount:0,lastColumn:p?p.columnCount:0,headers:[],dataRange:p?p.values:[],isLargeSheet:p&&p.rowCount>1e3},p&&p.rowCount>0)for(b=p.values[0],v=0;v<b.length;v++)y.headers.push({column:v+1,columnLetter:P(v),label:b[v]?b[v].toString():""});return e.n=11,m(n,y);case 11:if((k=e.v).success){e.n=12;break}throw new Error(k.error);case 12:return console.log("Executing interpreted command..."),e.n=13,h(a,k.data);case 13:w=e.v,console.log("Command execution result:",w),t.disabled=!1,t.innerHTML=o,w.success?(console.log("Operation completed successfully:",w),W(w.message||"명령이 성공적으로 실행되었습니다.","success"),setTimeout(function(){document.getElementById("commandInput").value=""},1e3)):(console.error("Operation failed:",w),W(w.error||"명령 실행에 실패했습니다.","error")),console.log("Excel.run completing...");case 14:return e.a(2)}},e,null,[[1,8]])}));return function(n){return e.apply(this,arguments)}}());case 4:console.log("Excel.run completed"),e.n=6;break;case 5:e.p=5,a=e.v,console.error("Error in executeCommand:",a),console.error("Error stack:",a.stack),t.disabled=!1,t.innerHTML=o,W("오류가 발생했습니다: "+a.message,"error");case 6:return e.p=6,i=!1,e.f(6);case 7:return e.a(2)}},e,null,[[3,5,6,7]])})),g.apply(this,arguments)}function m(e,n){return f.apply(this,arguments)}function f(){return(f=s(r().m(function e(n,t){var o,a,s,c,l,i,d;return r().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,o=localStorage.getItem("excel_addon_selected_model")||"gpt-4.1-nano-2025-04-14",a=localStorage.getItem("excel_addon_auth_key"),s=localStorage.getItem("excel_addon_auth_email"),c={command:n,sheetContext:t,model:o},"gpt-4.1-2025-04-14"===o&&(c.authKey=a,c.authEmail=s),console.log("Sending request with:",{model:o,hasAuthKey:!!c.authKey,hasAuthEmail:!!c.authEmail,command:n}),e.n=1,fetch(u,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)});case 1:if((l=e.v).ok){e.n=3;break}return e.n=2,l.json();case 2:return i=e.v,e.a(2,{success:!1,error:i.error||"서버 오류 (".concat(l.status,")")});case 3:return e.n=4,l.json();case 4:return e.a(2,e.v);case 5:return e.p=5,d=e.v,console.error("Proxy API Error:",d),e.a(2,{success:!1,error:"API 요청 오류: ".concat(d.toString())})}},e,null,[[0,5]])}))).apply(this,arguments)}function h(e,n){return p.apply(this,arguments)}function p(){return(p=s(r().m(function e(t,o){var a,s,c,l,u,i,d;return r().w(function(e){for(;;)switch(e.p=e.n){case 0:if(!o.operations||!Array.isArray(o.operations)){e.n=9;break}console.log("Executing multiple operations:",o.operations.length),a=[],s=0,c=n(o.operations),e.p=1,c.s();case 2:if((l=c.n()).done){e.n=5;break}return u=l.value,e.n=3,y(t,u.operation,u.parameters||{});case 3:i=e.v,a.push(i),i.success&&s++;case 4:e.n=2;break;case 5:e.n=7;break;case 6:e.p=6,d=e.v,c.e(d);case 7:return e.p=7,c.f(),e.f(7);case 8:return e.a(2,{success:s===o.operations.length,message:"".concat(s,"/").concat(o.operations.length," 작업이 완료되었습니다."),results:a});case 9:return e.n=10,y(t,o.operation,o.parameters||{});case 10:return e.a(2,e.v)}},e,null,[[1,6,7,8]])}))).apply(this,arguments)}function y(e,n,t){return b.apply(this,arguments)}function b(){return(b=s(r().m(function e(n,t,o){var a,s;return r().w(function(e){for(;;)switch(e.p=e.n){case 0:console.log("[".concat((new Date).toISOString(),"] Executing operation: ").concat(t," with params:"),o),e.p=1,a=t,e.n="merge"===a?2:"sum"===a?4:"average"===a?6:"count"===a?8:"format"===a?10:"sort"===a?12:"filter"===a?14:"insert"===a?16:"delete"===a?18:"formula"===a?20:"chart"===a?22:"conditional_format"===a?24:"translate"===a?26:"compress"===a?28:"retry_translation"===a?30:"remove_border"===a?32:"border_format"===a?34:36;break;case 2:return e.n=3,v(n,o);case 3:case 5:case 7:case 9:case 11:case 13:case 15:case 17:case 19:case 21:case 23:case 25:case 27:case 29:case 31:case 33:case 35:return e.a(2,e.v);case 4:return e.n=5,w(n,o);case 6:return e.n=7,E(n,o);case 8:return e.n=9,R(n,o);case 10:return e.n=11,T(n,o);case 12:return e.n=13,_(n,o);case 14:return e.n=15,ce(n,o);case 16:return e.n=17,ue(n,o);case 18:return e.n=19,de(n,o);case 20:return e.n=21,me(n,o);case 22:return e.n=23,N(n,o);case 24:return e.n=25,j(n,o);case 26:return e.n=27,U(n,o);case 28:return e.n=29,ae(n,o);case 30:return e.n=31,he(n,o);case 32:return e.n=33,ye(n,o);case 34:return e.n=35,re(n,o);case 36:return e.a(2,{success:!1,error:"알 수 없는 작업: ".concat(t)});case 37:e.n=39;break;case 38:return e.p=38,s=e.v,console.error("Error in executeInterpretedCommand:",s),e.a(2,{success:!1,error:"작업 실행 중 오류: ".concat(s.message||s.toString())});case 39:return e.a(2)}},e,null,[[1,38]])}))).apply(this,arguments)}function v(e,n){return k.apply(this,arguments)}function k(){return(k=s(r().m(function e(n,t){var o,a,s;return r().w(function(e){for(;;)switch(e.n){case 0:return console.log("executeMerge started with params:",t),o=n.workbook.worksheets.getActiveWorksheet(),a=t.range?o.getRange(t.range):n.workbook.getSelectedRange(),console.log("Loading range address..."),a.load("address"),e.n=1,n.sync();case 1:return console.log("Range address loaded:",a.address),s=a.address,console.log("Merging range..."),a.merge(),e.n=2,n.sync();case 2:return console.log("Merge completed successfully"),e.a(2,{success:!0,message:"".concat(s," 범위가 병합되었습니다.")})}},e)}))).apply(this,arguments)}function w(e,n){return C.apply(this,arguments)}function C(){return(C=s(r().m(function e(n,t){var o,a,s,c,l,u,i,d,g,m,f,h,p,y,b,v,k,w,C,x,I,E,S,R,B,T,A,_,O,N,L,j,D,U,V,M,F,W,z,K,$,H,Z,J,q,X,Y,Q,ee,ne,te,re,oe,ae,se,ce,le;return r().w(function(e){for(;;)switch(e.p=e.n){case 0:if(o=n.workbook.worksheets.getActiveWorksheet(),"row"!==t.sumType||!t.row){e.n=10;break}if(console.log("Sum by row:",t.row),a=o.getUsedRange()){e.n=1;break}return e.a(2,{success:!1,error:"시트에 데이터가 없습니다."});case 1:return a.load(["columnCount"]),e.n=2,n.sync();case 2:return(s=o.getRangeByIndexes(t.row-1,0,1,a.columnCount)).load(["values"]),e.n=3,n.sync();case 3:c=s.values[0],l=-1,u=c.length-1;case 4:if(!(u>=0)){e.n=6;break}if(null===c[u]||""===c[u]||void 0===c[u]){e.n=5;break}return l=u,e.a(3,6);case 5:u--,e.n=4;break;case 6:if(-1!==l){e.n=7;break}return e.a(2,{success:!1,error:"".concat(t.row,"행에 데이터가 없습니다.")});case 7:return i=l+1,d=o.getCell(t.row-1,i),g=P(l),m="=SUM(".concat("A").concat(t.row,":").concat(g).concat(t.row,")"),d.formulas=[[m]],e.n=8,n.sync();case 8:return d.load(["values","address"]),e.n=9,n.sync();case 9:return e.a(2,{success:!0,message:"".concat(t.row,"행의 합계를 ").concat(d.address,"에 계산했습니다: ").concat(G(d.values[0][0])),value:d.values[0][0]});case 10:if(!t.columnName&&"column"!==t.sumType){e.n=24;break}return console.log("Sum by column name:",t.columnName),(f=o.getUsedRange()).load(["values","rowCount","columnCount"]),e.n=11,n.sync();case 11:if(f&&0!==f.rowCount){e.n=12;break}return e.a(2,{success:!1,error:"시트에 데이터가 없습니다."});case 12:if(h=-1,p="",!t.columnName||!t.columnName.match(/^[A-Z]+$/)){e.n=13;break}for(p=t.columnName,h=0,y=0;y<p.length;y++)h=26*h+(p.charCodeAt(y)-64);h--,console.log("Column letter specified:",p,"index:",h),e.n=16;break;case 13:b=f.values[0],v=0;case 14:if(!(v<b.length)){e.n=16;break}if(!b[v]||b[v].toString().toLowerCase()!==(t.columnName||"").toLowerCase()){e.n=15;break}return h=v,p=P(v),e.a(3,16);case 15:v++,e.n=14;break;case 16:if(-1!==h){e.n=17;break}return e.a(2,{success:!1,error:'"'.concat(t.columnName,'" 열을 찾을 수 없습니다.')});case 17:for(k=1,w=1;w<f.rowCount;w++)null!==f.values[w][h]&&void 0!==f.values[w][h]&&""!==f.values[w][h]&&(k=w+1);C="".concat(p,"2:").concat(p).concat(k),x=k,I=!1,E=0;case 18:if(!(E<10)){e.n=21;break}return(S=o.getCell(k+E,h)).load("values"),e.n=19,n.sync();case 19:if(null!=(R=S.values[0][0])&&""!==R){e.n=20;break}return x=k+E,I=!0,e.a(3,21);case 20:E++,e.n=18;break;case 21:return I||(x=k),B=o.getCell(x,h),console.log("Summing range: ".concat(C,", placing result in row ").concat(x+1)),B.formulas=[["=SUM(".concat(C,")")]],e.n=22,n.sync();case 22:return B.load(["values","address"]),e.n=23,n.sync();case 23:return e.a(2,{success:!0,message:"".concat(t.columnName," 열의 합계를 ").concat(B.address,"에 계산했습니다: ").concat(G(B.values[0][0])),value:B.values[0][0]});case 24:if(!t.sourceRange){e.n=26;break}return(T=o.getRange(t.sourceRange)).load(["columnIndex","rowIndex","rowCount","address"]),e.n=25,n.sync();case 25:A="=SUM(".concat(T.address,")"),e.n=41;break;case 26:return e.p=26,(_=n.workbook.getSelectedRanges()).load(["areas","areaCount"]),e.n=27,n.sync();case 27:if(!(_.areaCount>1)){e.n=30;break}for(O=[],N=0;N<_.areas.items.length;N++)_.areas.items[N].load("address");return e.n=28,n.sync();case 28:for(L=0;L<_.areas.items.length;L++)O.push(_.areas.items[L].address);return A="=SUM(".concat(O.join(","),")"),(T=_.areas.items[0]).load(["columnIndex","rowIndex","rowCount"]),e.n=29,n.sync();case 29:e.n=32;break;case 30:return(T=n.workbook.getSelectedRange()).load(["columnIndex","rowIndex","rowCount","address"]),e.n=31,n.sync();case 31:A="=SUM(".concat(T.address,")");case 32:e.n=41;break;case 33:return e.p=33,ce=e.v,console.log("Error getting selected ranges, trying fallback:",ce),e.p=34,(j=n.workbook.getSelectedRanges()).load(["areas","areaCount"]),e.n=35,n.sync();case 35:if(!(j.areas.items.length>0)){e.n=38;break}for(D=[],U=0;U<j.areas.items.length;U++)j.areas.items[U].load("address");return e.n=36,n.sync();case 36:for(V=0;V<j.areas.items.length;V++)D.push(j.areas.items[V].address);return A="=SUM(".concat(D.join(","),")"),(T=j.areas.items[0]).load(["columnIndex","rowIndex","rowCount"]),e.n=37,n.sync();case 37:e.n=39;break;case 38:throw new Error("No ranges selected");case 39:e.n=41;break;case 40:return e.p=40,le=e.v,console.error("Fallback also failed:",le),e.a(2,{success:!1,error:"선택한 범위를 처리할 수 없습니다. 연속된 범위를 선택해주세요."});case 41:if(!0!==t.addNewRow){e.n=44;break}return M=T.columnIndex,F=T.rowIndex+T.rowCount,(W=o.getCell(F,M)).formulas=[[A]],e.n=42,n.sync();case 42:return W.load(["values","address"]),e.n=43,n.sync();case 43:return e.a(2,{success:!0,message:"".concat(W.address,"에 합계를 계산했습니다: ").concat(G(W.values[0][0])),value:W.values[0][0]});case 44:if(!t.targetCell){e.n=47;break}return(z=o.getRange(t.targetCell)).formulas=[[A]],e.n=45,n.sync();case 45:return z.load(["values","address"]),e.n=46,n.sync();case 46:return e.a(2,{success:!0,message:"".concat(z.address,"에 합계를 계산했습니다: ").concat(G(z.values[0][0])),value:z.values[0][0]});case 47:return(K=o.getUsedRange()).load(["rowCount","columnCount"]),e.n=48,n.sync();case 48:if(!A.includes(",")){e.n=57;break}H=K?K.rowCount:1,Z=K?K.columnCount:1,J=!1,q=Z;case 49:if(!(q<Z+5)){e.n=52;break}return(X=o.getCell(T.rowIndex,q)).load("values"),e.n=50,n.sync();case 50:if(X.values[0][0]){e.n=51;break}return $=X,J=!0,e.a(3,52);case 51:q++,e.n=49;break;case 52:if(J){e.n=56;break}Y=H;case 53:if(!(Y<H+5)){e.n=56;break}return(Q=o.getCell(Y,0)).load("values"),e.n=54,n.sync();case 54:if(Q.values[0][0]){e.n=55;break}return $=Q,J=!0,e.a(3,56);case 55:Y++,e.n=53;break;case 56:J||($=o.getCell(H+2,0)),e.n=62;break;case 57:ee=T.columnIndex,ne=T.rowIndex+T.rowCount,te=ne,re=!1,oe=0;case 58:if(!(oe<10)){e.n=61;break}return(ae=o.getCell(ne+oe,ee)).load("values"),e.n=59,n.sync();case 59:if(null!=(se=ae.values[0][0])&&""!==se){e.n=60;break}return te=ne+oe,re=!0,e.a(3,61);case 60:oe++,e.n=58;break;case 61:re||(te=ne),$=o.getCell(te,ee);case 62:return $.formulas=[[A]],e.n=63,n.sync();case 63:return $.load(["values","address"]),e.n=64,n.sync();case 64:return e.a(2,{success:!0,message:"".concat($.address,"에 합계를 계산했습니다: ").concat(G($.values[0][0])),value:$.values[0][0]});case 65:return e.a(2)}},e,null,[[34,40],[26,33]])}))).apply(this,arguments)}function x(e){return I.apply(this,arguments)}function I(){return(I=s(r().m(function e(n){var t,o,a,s,c;return r().w(function(e){for(;;)switch(e.n){case 0:if(t=n.workbook.worksheets.getActiveWorksheet(),o=t.getUsedRange()){e.n=1;break}return e.a(2,[]);case 1:return o.load(["values","columnCount"]),e.n=2,n.sync();case 2:if(a=[],s=o.values[0])for(c=0;c<s.length;c++)a.push({column:c+1,columnLetter:P(c),label:s[c]?s[c].toString():""});return e.a(2,a)}},e)}))).apply(this,arguments)}function E(e,n){return S.apply(this,arguments)}function S(){return(S=s(r().m(function e(n,t){var o,a,s,c,l,u,i,d,g,m,f,h,p,y,b,v,k,w,C,I,E,S,R,B,T,A,_,O,N,L,j,D,U,V,M;return r().w(function(e){for(;;)switch(e.p=e.n){case 0:if(o=n.workbook.worksheets.getActiveWorksheet(),s="",c="",e.p=1,"column"!==t.averageType){e.n=23;break}if(!t.column){e.n=8;break}if(l=o.getUsedRange()){e.n=2;break}return e.a(2,{success:!1,error:"데이터가 없습니다."});case 2:return l.load(["rowCount","columnCount"]),e.n=3,n.sync();case 3:if(!((u=t.column.charCodeAt(0)-65)<0||u>=l.columnCount)){e.n=4;break}return e.a(2,{success:!1,error:"유효하지 않은 열입니다."});case 4:if(!(l.rowCount>1)){e.n=5;break}a=o.getRangeByIndexes(1,u,l.rowCount-1,1),s="".concat(t.column,"열"),e.n=6;break;case 5:return e.a(2,{success:!1,error:"평균을 계산할 데이터가 없습니다."});case 6:return a.load(["address"]),e.n=7,n.sync();case 7:c="=AVERAGE(".concat(a.address,")"),e.n=22;break;case 8:if(!t.columnName){e.n=22;break}if(!t.columnName.match(/^[A-Z]+$/)){e.n=15;break}for(i=t.columnName,d=0,g=0;g<i.length;g++)d=26*d+(i.charCodeAt(g)-64);if(d--,m=o.getUsedRange()){e.n=9;break}return e.a(2,{success:!1,error:"데이터가 없습니다."});case 9:return m.load(["rowCount","columnCount"]),e.n=10,n.sync();case 10:if(!(d<0||d>=m.columnCount)){e.n=11;break}return e.a(2,{success:!1,error:"유효하지 않은 열입니다."});case 11:if(!(m.rowCount>1)){e.n=12;break}a=o.getRangeByIndexes(1,d,m.rowCount-1,1),s="".concat(t.columnName,"열"),e.n=13;break;case 12:return e.a(2,{success:!1,error:"평균을 계산할 데이터가 없습니다."});case 13:return a.load(["address"]),e.n=14,n.sync();case 14:c="=AVERAGE(".concat(a.address,")"),e.n=22;break;case 15:return e.n=16,x(n);case 16:if(f=e.v,h=f.find(function(e){return e.label===t.columnName})){e.n=17;break}return e.a(2,{success:!1,error:'"'.concat(t.columnName,'" 열을 찾을 수 없습니다.')});case 17:return(p=o.getUsedRange()).load(["rowCount"]),e.n=18,n.sync();case 18:if(!(p.rowCount>1)){e.n=19;break}a=o.getRangeByIndexes(1,h.column-1,p.rowCount-1,1),s='"'.concat(t.columnName,'" 열'),e.n=20;break;case 19:return e.a(2,{success:!1,error:"평균을 계산할 데이터가 없습니다."});case 20:return a.load(["address"]),e.n=21,n.sync();case 21:c="=AVERAGE(".concat(a.address,")");case 22:e.n=45;break;case 23:if("row"!==t.averageType){e.n=28;break}if(y=o.getUsedRange()){e.n=24;break}return e.a(2,{success:!1,error:"데이터가 없습니다."});case 24:return y.load(["rowCount","columnCount"]),e.n=25,n.sync();case 25:if(!((b=t.row-1)<0||b>=y.rowCount)){e.n=26;break}return e.a(2,{success:!1,error:"유효하지 않은 행입니다."});case 26:return a=o.getRangeByIndexes(b,0,1,y.columnCount),s="".concat(t.row,"행"),a.load(["address","rowIndex","columnIndex","columnCount"]),e.n=27,n.sync();case 27:c="=AVERAGE(".concat(a.address,")"),e.n=45;break;case 28:if(!t.sourceRange){e.n=30;break}return a=o.getRange(t.sourceRange),s=t.sourceRange,a.load(["address"]),e.n=29,n.sync();case 29:c="=AVERAGE(".concat(a.address,")"),e.n=45;break;case 30:return e.p=30,(v=n.workbook.getSelectedRanges()).load(["areas","areaCount"]),e.n=31,n.sync();case 31:if(!(v.areaCount>1)){e.n=34;break}for(k=[],w=0;w<v.areas.items.length;w++)v.areas.items[w].load("address");return e.n=32,n.sync();case 32:for(C=0;C<v.areas.items.length;C++)k.push(v.areas.items[C].address);return c="=AVERAGE(".concat(k.join(","),")"),s="선택한 셀",(a=v.areas.items[0]).load(["columnIndex","rowIndex","rowCount","columnCount"]),e.n=33,n.sync();case 33:e.n=36;break;case 34:return a=n.workbook.getSelectedRange(),s="선택한 범위",a.load(["columnIndex","rowIndex","rowCount","columnCount","address"]),e.n=35,n.sync();case 35:c="=AVERAGE(".concat(a.address,")");case 36:e.n=45;break;case 37:return e.p=37,U=e.v,console.log("Error getting selected ranges for average, trying fallback:",U),e.p=38,(I=n.workbook.getSelectedRanges()).load(["areas","areaCount"]),e.n=39,n.sync();case 39:if(!(I.areas.items.length>0)){e.n=42;break}for(E=[],S=0;S<I.areas.items.length;S++)I.areas.items[S].load("address");return e.n=40,n.sync();case 40:for(R=0;R<I.areas.items.length;R++)E.push(I.areas.items[R].address);return c="=AVERAGE(".concat(E.join(","),")"),s="선택한 셀",(a=I.areas.items[0]).load(["columnIndex","rowIndex","rowCount","columnCount"]),e.n=41,n.sync();case 41:e.n=43;break;case 42:throw new Error("No ranges selected");case 43:e.n=45;break;case 44:return e.p=44,V=e.v,console.error("Average fallback also failed:",V),e.a(2,{success:!1,error:"선택한 범위를 처리할 수 없습니다. 연속된 범위를 선택해주세요."});case 45:if(!t.targetCell){e.n=46;break}B=o.getRange(t.targetCell),e.n=52;break;case 46:if("row"!==t.averageType){e.n=47;break}T=a.columnIndex+a.columnCount,B=o.getCell(a.rowIndex,T),e.n=52;break;case 47:A=a.columnIndex,_=a.rowIndex+a.rowCount,O=_,N=!1,L=0;case 48:if(!(L<10)){e.n=51;break}return(j=o.getCell(_+L,A)).load("values"),e.n=49,n.sync();case 49:if(null!=(D=j.values[0][0])&&""!==D){e.n=50;break}return O=_+L,N=!0,e.a(3,51);case 50:L++,e.n=48;break;case 51:N||(O=_),B=o.getCell(O,A);case 52:return B.formulas=[[c]],B.numberFormat=[["#,##0.00"]],e.n=53,n.sync();case 53:return B.load(["values","address"]),e.n=54,n.sync();case 54:return e.a(2,{success:!0,message:"".concat(s,"의 평균을 ").concat(B.address,"에 계산했습니다: ").concat(G(B.values[0][0])),value:B.values[0][0]});case 55:return e.p=55,M=e.v,console.error("Error in executeAverage:",M),e.a(2,{success:!1,error:"평균 계산 중 오류 발생: ".concat(M.message)})}},e,null,[[38,44],[30,37],[1,55]])}))).apply(this,arguments)}function R(e,n){return B.apply(this,arguments)}function B(){return(B=s(r().m(function e(n,t){var o,a,s,c,l,u,i,d;return r().w(function(e){for(;;)switch(e.n){case 0:return o=n.workbook.worksheets.getActiveWorksheet(),(a=t.sourceRange?o.getRange(t.sourceRange):n.workbook.getSelectedRange()).load(["address"]),e.n=1,n.sync();case 1:if("countif"===t.countType&&void 0!==t.condition?(c="contains"===t.operator?'"*'.concat(t.condition,'*"'):"equals"===t.operator?"string"==typeof t.condition?'"'.concat(t.condition,'"'):t.condition:t.operator&&[">","<",">=","<=","<>"].includes(t.operator)?'"'.concat(t.operator).concat(t.condition,'"'):"string"==typeof t.condition?'"*'.concat(t.condition,'*"'):t.condition,s="=COUNTIF(".concat(a.address,", ").concat(c,")")):s="counta"===t.countType?"=COUNTA(".concat(a.address,")"):"=COUNT(".concat(a.address,")"),!t.targetCell){e.n=2;break}l=o.getRange(t.targetCell),e.n=4;break;case 2:return u=o.getUsedRange(),e.n=3,n.sync();case 3:i=u?u.rowCount:1,d=u?u.columnCount:1,l=o.getCell(i,d);case 4:return l.formulas=[[s]],e.n=5,n.sync();case 5:return l.load("values"),e.n=6,n.sync();case 6:return e.a(2,{success:!0,message:"countif"===t.countType?'"'.concat(t.condition,'"을(를) 포함하는 셀의 개수: ').concat(G(l.values[0][0]),"개"):"개수를 계산했습니다: ".concat(G(l.values[0][0]),"개"),value:l.values[0][0]})}},e)}))).apply(this,arguments)}function T(e,n){return A.apply(this,arguments)}function A(){return(A=s(r().m(function e(n,t){var o,a,s,c,l,u,i,d,g,m,f;return r().w(function(e){for(;;)switch(e.p=e.n){case 0:if(console.log("executeFormat called with params:",t),o=n.workbook.worksheets.getActiveWorksheet(),a=[],!t.range){e.n=1;break}a.push(o.getRange(t.range)),e.n=4;break;case 1:return e.p=1,(s=n.workbook.getSelectedRanges()).load(["areas","areaCount"]),e.n=2,n.sync();case 2:if(s.areaCount>1)for(c=0;c<s.areas.items.length;c++)a.push(s.areas.items[c]);else a.push(n.workbook.getSelectedRange());e.n=4;break;case 3:return e.p=3,f=e.v,console.log("Error getting selected ranges for format:",f),e.a(2,{success:!1,error:"선택한 범위를 처리할 수 없습니다. 연속된 범위를 선택해주세요."});case 4:for(l=0,u=a;l<u.length;l++)u[l].load("format");return e.n=5,n.sync();case 5:for(i=0,d=a;i<d.length;i++)g=d[i],void 0!==t.bold&&(g.format.font.bold=t.bold),void 0!==t.italic&&(g.format.font.italic=t.italic),t.fontSize&&(g.format.font.size=t.fontSize),t.fontColor&&(g.format.font.color=t.fontColor),t.backgroundColor&&(g.format.fill.color=t.backgroundColor),t.horizontalAlignment&&(g.format.horizontalAlignment="left"===t.horizontalAlignment?"Left":"center"===t.horizontalAlignment?"Center":"right"===t.horizontalAlignment?"Right":"General"),t.numberFormat&&("number"===(m=t.numberFormat)||"숫자"===m?m="#,##0":"currency"===m||"원화"===m||"won"===m||"통화"===m?m="₩#,##0":"currency_decimal"===m||"원화_소수"===m?m="₩#,##0.00":"percentage"===m||"퍼센트"===m||"백분율"===m?m="0%":"percentage_decimal"===m||"퍼센트_소수"===m?m="0.00%":"date"===m||"날짜"===m?m="yyyy-mm-dd":"time"===m||"시간"===m?m="hh:mm:ss":"text"===m||"텍스트"===m?m="@":"general"!==m&&"일반"!==m||(m="General"),g.numberFormat=m);return e.n=6,n.sync();case 6:return e.a(2,{success:!0,message:"서식이 적용되었습니다."})}},e,null,[[1,3]])}))).apply(this,arguments)}function _(e,n){return O.apply(this,arguments)}function O(){return(O=s(r().m(function e(n,t){var o,a,s,c,l;return r().w(function(e){for(;;)switch(e.n){case 0:return o=n.workbook.worksheets.getActiveWorksheet(),a=t.range?o.getRange(t.range):o.getUsedRange(),s=t.column||1,c=void 0===t.ascending||t.ascending,a.sort.apply([{key:s-1,ascending:c}]),e.n=1,n.sync();case 1:return l=P(s-1),e.a(2,{success:!0,message:"".concat(l,"열 기준으로 ").concat(c?"오름차순":"내림차순"," 정렬되었습니다.")})}},e)}))).apply(this,arguments)}function N(e,n){return L.apply(this,arguments)}function L(){return(L=s(r().m(function e(t,o){var a,s,c,l,u,i,d,g,m,f,h,p,y,b,v,k,w,C,x,I,E,S,R,B,T,A,_,O,N,L;return r().w(function(e){for(;;)switch(e.p=e.n){case 0:if(a=t.workbook.worksheets.getActiveWorksheet(),c="",console.log("Creating chart with params:",o),!o.range){e.n=2;break}return(s=a.getRange(o.range)).load(["address","values"]),e.n=1,t.sync();case 1:c=s.address,e.n=21;break;case 2:return e.p=2,(l=t.workbook.getSelectedRanges()).load(["areas","areaCount"]),e.n=3,t.sync();case 3:if(!(l.areaCount>1)){e.n=17;break}for(console.log("Multiple ranges selected for chart, need to consolidate data"),u=[],i=0;i<l.areas.items.length;i++)(d=l.areas.items[i]).load(["address","values","rowIndex","columnIndex"]),u.push(d);return e.n=4,t.sync();case 4:return(g=a.getUsedRangeOrNullObject()).load(["isNullObject","rowCount","columnCount"]),e.n=5,t.sync();case 5:for(m=g.isNullObject?1:g.rowCount+2,f=0,h=[],p=1,y=0,b=u;y<b.length;y++)if((v=b[y]).values&&v.values.length>0){k=n(v.values);try{for(k.s();!(w=k.n()).done;)C=w.value,h.push(C),p=Math.max(p,C.length)}catch(e){k.e(e)}finally{k.f()}}if(!(h.length>0)){e.n=15;break}if(console.log("Consolidated data:",h),console.log("Number of ranges:",u.length),e.p=6,!h.every(function(e){return 1===e.length})){e.n=9;break}for(x=[],I=0;I<h.length;I++)null!=(E=h[I][0])&&""!==E&&x.push(["Item ".concat(I+1),E]);if(0!==x.length){e.n=7;break}return e.a(2,{success:!1,error:"선택한 셀에 유효한 데이터가 없습니다."});case 7:return console.log("Reorganized data for chart:",x),(S=a.getRangeByIndexes(m,f,x.length,2)).values=x,e.n=8,t.sync();case 8:s=S,e.n=11;break;case 9:return(R=a.getRangeByIndexes(m,f,h.length,p)).values=h,e.n=10,t.sync();case 10:s=R;case 11:return s.load(["address","values","rowCount","columnCount"]),e.n=12,t.sync();case 12:console.log("Temp range created:",{address:s.address,rowCount:s.rowCount,columnCount:s.columnCount,firstValue:s.values[0]}),c=s.address,e.n=14;break;case 13:return e.p=13,_=e.v,console.error("Error creating temporary range:",_),e.a(2,{success:!1,error:"임시 데이터 범위 생성 중 오류가 발생했습니다."});case 14:e.n=16;break;case 15:return e.a(2,{success:!1,error:"선택한 셀에 데이터가 없습니다."});case 16:e.n=19;break;case 17:return(s=t.workbook.getSelectedRange()).load(["address","values"]),e.n=18,t.sync();case 18:c=s.address;case 19:e.n=21;break;case 20:return e.p=20,O=e.v,console.log("Error getting selected ranges for chart:",O),e.a(2,{success:!1,error:"선택한 범위를 처리할 수 없습니다. 연속된 범위를 선택해주세요."});case 21:if(console.log("Chart data range:",c),B="bar"===o.chartType||"막대"===o.chartType?Excel.ChartType.columnClustered:"line"===o.chartType||"선"===o.chartType?Excel.ChartType.line:"pie"===o.chartType||"원"===o.chartType?Excel.ChartType.pie:"scatter"===o.chartType||"분산형"===o.chartType?Excel.ChartType.xyscatter:Excel.ChartType.columnClustered,e.p=22,s){e.n=23;break}return e.a(2,{success:!1,error:"차트 데이터가 없습니다."});case 23:return console.log("Creating chart with type:",B),console.log("Source data address:",c),(T=a.charts.add(B,s,Excel.ChartSeriesBy.auto)).title.text=o.title||"차트",T.height=300,T.width=400,T.left=o.offsetX||100,T.top=o.offsetY||100,T.legend.position=Excel.ChartLegendPosition.bottom,T.legend.visible=!0,e.n=24,t.sync();case 24:console.log("Chart created successfully"),e.n=30;break;case 25:if(e.p=25,N=e.v,console.error("Error creating chart:",N),console.error("Chart error details:",{message:N.message,stack:N.stack,chartType:B,dataAddress:c}),B===Excel.ChartType.columnClustered){e.n=29;break}return console.log("Trying fallback to column chart..."),e.p=26,(A=a.charts.add(Excel.ChartType.columnClustered,s,Excel.ChartSeriesBy.auto)).title.text=o.title||"차트",A.height=300,A.width=400,A.left=o.offsetX||100,A.top=o.offsetY||100,e.n=27,t.sync();case 27:return e.a(2,{success:!0,message:"".concat(c," 범위로 막대 차트가 생성되었습니다. (원래 요청한 차트 타입이 지원되지 않아 막대 차트로 대체되었습니다.)")});case 28:return e.p=28,L=e.v,console.error("Fallback chart also failed:",L),e.a(2,{success:!1,error:"차트 생성에 실패했습니다. 데이터 형식을 확인해주세요."});case 29:return e.a(2,{success:!1,error:"차트 생성 중 오류: ".concat(N.message)});case 30:return e.a(2,{success:!0,message:"".concat(c," 범위로 ").concat(o.chartType||"막대"," 차트가 생성되었습니다.")})}},e,null,[[26,28],[22,25],[6,13],[2,20]])}))).apply(this,arguments)}function j(e,n){return D.apply(this,arguments)}function D(){return(D=s(r().m(function e(n,t){var o,a,s,c,l,u,i,d,g;return r().w(function(e){for(;;)switch(e.p=e.n){case 0:if(o=n.workbook.worksheets.getActiveWorksheet(),a=[],console.log("Applying conditional format with params:",t),!t.range){e.n=1;break}a.push(o.getRange(t.range)),e.n=3;break;case 1:return console.log("No range specified for conditional format, using entire sheet"),(s=o.getUsedRangeOrNullObject()).load("isNullObject"),e.n=2,n.sync();case 2:s.isNullObject?(c=o.getRange("A1:XFD1048576"),a.push(c)):a.push(s);case 3:e.p=3,l=0,u=a;case 4:if(!(l<u.length)){e.n=7;break}return(i=u[l]).load("address"),e.n=5,n.sync();case 5:console.log("Applying conditional format to range:",i.address),d=i.conditionalFormats.add(Excel.ConditionalFormatType.cellValue),"greater_than"===t.condition&&void 0!==t.value?d.cellValue.rule={formula1:t.value.toString(),operator:Excel.ConditionalCellValueOperator.greaterThan}:"less_than"===t.condition&&void 0!==t.value?d.cellValue.rule={formula1:t.value.toString(),operator:Excel.ConditionalCellValueOperator.lessThan}:"equal_to"===t.condition&&void 0!==t.value?d.cellValue.rule={formula1:t.value.toString(),operator:Excel.ConditionalCellValueOperator.equalTo}:"text_contains"===t.condition&&void 0!==t.value?d.cellValue.rule={formula1:t.value.toString(),operator:Excel.ConditionalCellValueOperator.containsText}:d.cellValue.rule={formula1:(t.value||0).toString(),operator:Excel.ConditionalCellValueOperator.greaterThan},d.cellValue.format.fill.color=t.backgroundColor||"#00FF00",t.fontColor&&(d.cellValue.format.font.color=t.fontColor),t.bold&&(d.cellValue.format.font.bold=!0);case 6:l++,e.n=4;break;case 7:e.n=9;break;case 8:return e.p=8,g=e.v,console.error("Error applying conditional format:",g),e.a(2,{success:!1,error:"조건부 서식 적용 중 오류: ".concat(g.message)});case 9:return e.n=10,n.sync();case 10:return e.a(2,{success:!0,message:"조건부 서식이 적용되었습니다. (".concat(t.condition," ").concat(t.value||"",")")})}},e,null,[[3,8]])}))).apply(this,arguments)}function U(e,n){return V.apply(this,arguments)}function V(){return(V=s(r().m(function t(o,a){var s,c,l,u,i,d,g,m,f,h,p,y,b,v,k,w,C,x,I,E,S,R,B,T,A,_,O,N,L,j,D,U,V,F,P,G,z,K,$,H;return r().w(function(t){for(;;)switch(t.n){case 0:if(console.log("executeTranslate called with params:",a),s=o.workbook.worksheets.getActiveWorksheet(),a.targetLanguage){t.n=1;break}return t.a(2,{success:!1,error:"대상 언어를 지정해주세요."});case 1:if(!a.sourceRange){t.n=8;break}if(!a.sourceRange.match(/^[A-Z]+:[A-Z]+$/)){t.n=6;break}if(console.log("Handling column range:",a.sourceRange),u=s.getUsedRange()){t.n=2;break}return t.a(2,{success:!1,error:"번역할 데이터가 없습니다."});case 2:return u.load(["rowCount","columnCount"]),t.n=3,o.sync();case 3:if(console.log("Used range:",{rowCount:u.rowCount,columnCount:u.columnCount}),i=a.sourceRange.split(":")[0],d=i.charCodeAt(0)-65,!(u.rowCount>1)){t.n=4;break}c=s.getRangeByIndexes(1,d,u.rowCount-1,1),t.n=5;break;case 4:return t.a(2,{success:!1,error:"번역할 데이터가 없습니다."});case 5:a.targetRange&&a.targetRange.match(/^[A-Z]+:[A-Z]+$/)?(g=a.targetRange.split(":")[0],l=g.charCodeAt(0)-65,console.log("Target column calculation:",{targetRange:a.targetRange,targetColumnLetter:g,targetColumnIndex:l})):(l=d+1,console.log("Using next column as target:",{sourceColumnIndex:d,targetColumnIndex:l})),t.n=7;break;case 6:c=s.getRange(a.sourceRange),a.targetRange&&a.targetRange.match(/^[A-Z]+:[A-Z]+$/)&&(m=a.targetRange.split(":")[0],l=m.charCodeAt(0)-65,console.log("Target column parsed from targetRange:",{targetRange:a.targetRange,targetColumnLetter:m,targetColumnIndex:l}));case 7:t.n=13;break;case 8:if(!a.sourceColumn){t.n=12;break}return f=a.sourceColumn.charCodeAt(0)-65,(h=s.getUsedRange()).load(["rowCount"]),t.n=9,o.sync();case 9:if(!(h.rowCount>1)){t.n=10;break}c=s.getRangeByIndexes(1,f,h.rowCount-1,1),t.n=11;break;case 10:return t.a(2,{success:!1,error:"번역할 데이터가 없습니다."});case 11:l="next"===a.targetColumn?f+1:a.targetColumn?a.targetColumn.charCodeAt(0)-65:f+1,t.n=13;break;case 12:return t.a(2,{success:!1,error:"번역할 열을 지정해주세요."});case 13:return c.load(["values","rowIndex","columnIndex","rowCount"]),t.n=14,o.sync();case 14:if(console.log("Source range loaded:",{rowIndex:c.rowIndex,columnIndex:c.columnIndex,rowCount:c.rowCount,values:c.values?"".concat(c.values.length," rows"):"null"}),(p=c.values)&&0!==p.length){t.n=15;break}return t.a(2,{success:!1,error:"번역할 데이터가 없습니다."});case 15:y=[],b=20,v=0;case 16:if(!(v<p.length)){t.n=21;break}if(k=p.slice(v,Math.min(v+b,p.length)),!((w=k.map(function(e){return e[0]}).filter(function(e){return e})).length>0)){t.n=18;break}return t.n=17,M(w,a.targetLanguage,a.sourceLanguage);case 17:if((C=t.v)&&Array.isArray(C))for(console.log("Processing translation batch:",{batchLength:k.length,translatedBatchLength:C.length,sampleTranslations:C.slice(0,3),firstTranslation:C[0],translationType:e(C[0]),rawData:JSON.stringify(C.slice(0,3))}),I=0,E=0;E<k.length;E++)k[E][0]?((S=C[I]||"")&&""!==S.trim()?y.push([{text:S,isError:!1}]):y.push([{text:"번역 실패",isError:!0}]),E<3&&console.log("Translation ".concat(E,': "').concat(k[E][0],'" -> "').concat(S,'"')),I++):y.push([{text:"",isError:!1}]);else for(console.error("Invalid translation batch received:",C),x=0;x<k.length;x++)k[x][0]?y.push([{text:"번역 실패",isError:!0}]):y.push([{text:"",isError:!1}]);t.n=19;break;case 18:for(R=0;R<k.length;R++)y.push([{text:"",isError:!1}]);case 19:v%100==0&&v>0&&W("번역 중... ".concat(Math.round(v/p.length*100),"%"),"info");case 20:v+=b,t.n=16;break;case 21:for(console.log("Writing translations to target column:",{rowIndex:c.rowIndex,targetColumnIndex:l||c.columnIndex+1,translationsCount:y.length,sampleTranslations:y.slice(0,3).map(function(e){return e[0]})}),console.log("First 5 translations raw:",JSON.stringify(y.slice(0,5))),console.log("Translation content check:",{first:y[0]?y[0][0]:"null",second:y[1]?y[1][0]:"null",third:y[2]?y[2][0]:"null",isEmpty:y[0]&&""===y[0][0]}),console.log("DEBUG: Comparing source and translations:"),B=0;B<Math.min(5,y.length);B++)console.log("  [".concat(B,'] Source: "').concat(p[B][0],'" -> Translation: "').concat(y[B][0],'"'));return void 0===l&&(l=c.columnIndex+1,console.log("No target column specified, using next column:",l)),(T=s.getRangeByIndexes(c.rowIndex,l,y.length,1)).load(["address","values"]),t.n=22,o.sync();case 22:return console.log("Target range address:",T.address),console.log("Existing target values (first 3):",T.values.slice(0,3)),T.clear(Excel.ClearApplyTo.contents),t.n=23,o.sync();case 23:for(console.log("Target range cleared"),console.log("Setting target range values:",{translationsLength:y.length,firstTranslation:y[0],isArray:Array.isArray(y),is2DArray:Array.isArray(y[0])}),A=[],_=[],O=0;O<y.length;O++)(N=y[O][0])&&"object"===e(N)?(A.push([N.text]),N.isError&&_.push(O)):A.push([String(N||"")]);return console.log("String translations (first 3):",A.slice(0,3)),console.log("Error rows:",_.length,"rows marked as errors"),T.values=A,t.n=24,o.sync();case 24:if(!(_.length>0)){t.n=25;break}L=n(_);try{for(L.s();!(j=L.n()).done;)D=j.value,(U=T.getCell(D,0)).format.fill.color="#FFE6E6",U.format.font.color="#CC0000",U.format.font.bold=!0}catch(e){L.e(e)}finally{L.f()}return t.n=25,o.sync();case 25:return console.log("Translations written to Excel with error styling applied"),T.load(["values","text","valueTypes"]),t.n=26,o.sync();case 26:if(console.log("Verification - Target range:",{address:T.address,values:T.values.slice(0,3),text:T.text.slice(0,3),valueTypes:T.valueTypes.slice(0,3),actualFirstValue:T.values[0]?T.values[0][0]:"null",firstThreeValues:[T.values[0]?T.values[0][0]:"empty",T.values[1]?T.values[1][0]:"empty",T.values[2]?T.values[2][0]:"empty"]}),!(y.length>0)){t.n=31;break}if(V=!T.values[0]||!T.values[0][0]||""===T.values[0][0],console.log("Checking if values are empty:",{isEmpty:V,firstValue:T.values[0]?T.values[0][0]:"null",firstValueLength:T.values[0]&&T.values[0][0]?T.values[0][0].length:0}),!V){t.n=31;break}console.log("Values not visible, trying individual cell approach..."),F=0;case 27:if(!(F<Math.min(3,y.length))){t.n=31;break}return P=c.rowIndex+F,G=l||c.columnIndex+1,z=s.getCell(P,G),K=A[F][0],console.log("Setting cell (".concat(P,",").concat(G,') to: "').concat(K,'"')),z.values=[[K]],t.n=28,o.sync();case 28:return z.load("values"),t.n=29,o.sync();case 29:console.log("Cell ".concat(F," after setting:"),z.values[0][0]);case 30:F++,t.n=27;break;case 31:return $=s.getCell(0,l||c.columnIndex+1),(H=s.getCell(0,c.columnIndex)).load("values"),t.n=32,o.sync();case 32:return $.values=[["".concat(H.values[0][0]," (").concat(a.targetLanguage,")")]],t.n=33,o.sync();case 33:return t.a(2,{success:!0,message:"번역이 완료되었습니다. (".concat(p.length,"개 항목)")})}},t)}))).apply(this,arguments)}function M(e,n,t){return F.apply(this,arguments)}function F(){return(F=s(r().m(function e(n,t,o){var a,s,c,l,i,d,g;return r().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,console.log("translateBatch called with",n.length,"texts"),a=localStorage.getItem("excel_addon_selected_model")||"gpt-4.1-nano-2025-04-14",s=localStorage.getItem("excel_addon_auth_key"),c=localStorage.getItem("excel_addon_auth_email"),l={command:"Translate these items to ".concat(t,": ").concat(n.join(", ")),sheetContext:{operation:"translate_batch",texts:n,targetLanguage:t,sourceLanguage:o},model:a},"gpt-4.1-2025-04-14"===a&&(l.authKey=s,l.authEmail=c),e.n=1,fetch(u,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)});case 1:if(i=e.v,console.log("Translation response status:",i.status),i.ok){e.n=2;break}throw new Error("HTTP error! status: ".concat(i.status));case 2:return e.n=3,i.json();case 3:if(d=e.v,console.log("Translation result:",d),!(d.success&&d.data&&d.data.translations)){e.n=4;break}return console.log("Translations received:",d.data.translations.length),console.log("First 3 translations from API:",d.data.translations.slice(0,3)),console.log("Raw translations data:",JSON.stringify(d.data.translations.slice(0,5))),e.a(2,d.data.translations);case 4:if(!d.error){e.n=5;break}throw console.error("Translation API error:",d.error),new Error(d.error);case 5:throw console.error("Invalid translation response structure:",d),new Error("번역 응답을 받을 수 없습니다.");case 6:e.n=8;break;case 7:return e.p=7,g=e.v,console.error("Translation error:",g),e.a(2,n.map(function(){return""}));case 8:return e.a(2)}},e,null,[[0,7]])}))).apply(this,arguments)}function P(e){for(var n="",t=e;t>=0;)n=String.fromCharCode(t%26+65)+n,t=Math.floor(t/26)-1;return n}function G(e){return"number"==typeof e?Number.isInteger(e)?e.toLocaleString("ko-KR"):e.toLocaleString("ko-KR",{minimumFractionDigits:0,maximumFractionDigits:2}):e}function W(e,n){var t=document.getElementById("status");t.textContent=e,t.className="status-message "+n,t.style.display="block",window.statusTimeout&&clearTimeout(window.statusTimeout),"success"===n&&(window.statusTimeout=setTimeout(function(){t.style.display="none"},5e3))}function z(){document.getElementById("commandInput").value="",document.getElementById("status").style.display="none"}function K(){var e=localStorage.getItem("excel_addon_auth_key"),n=localStorage.getItem("excel_addon_auth_email"),t=document.getElementById("authButton");e&&n?(t.textContent="인증 해제",t.classList.add("authenticated")):(t.textContent="인증",t.classList.remove("authenticated"))}function $(){var e=localStorage.getItem("excel_addon_auth_key"),n=localStorage.getItem("excel_addon_auth_email");e&&n?document.getElementById("deauthModal").style.display="block":J()}function H(){document.getElementById("deauthModal").style.display="none"}function Z(){try{console.log("confirmDeauth called"),localStorage.removeItem("excel_addon_auth_key"),localStorage.removeItem("excel_addon_auth_email"),document.getElementById("modelSelect").value="gpt-4.1-nano-2025-04-14",K(),H(),W("인증이 해제되었습니다. 무료 모델로 전환됩니다.","success")}catch(e){console.error("Error in confirmDeauth:",e),W("인증 해제 중 오류가 발생했습니다.","error")}}function J(){document.getElementById("authModal").style.display="block"}function q(){document.getElementById("authModal").style.display="none",document.getElementById("authEmailInput").value="",document.getElementById("authKeyInput").value="",document.getElementById("authStatus").style.display="none"}function X(){return Y.apply(this,arguments)}function Y(){return(Y=s(r().m(function e(){var n,t,o,a,s;return r().w(function(e){for(;;)switch(e.p=e.n){case 0:if(n=document.getElementById("authKeyInput").value.trim(),t=document.getElementById("authEmailInput").value.trim()){e.n=1;break}return Q("이메일 주소를 입력해주세요.","error"),e.a(2);case 1:if(/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t)){e.n=2;break}return Q("올바른 이메일 형식이 아닙니다.","error"),e.a(2);case 2:if(n){e.n=3;break}return Q("인증키를 입력해주세요.","error"),e.a(2);case 3:if(!(n.length<8)){e.n=4;break}return Q("인증키는 최소 8자 이상이어야 합니다.","error"),e.a(2);case 4:return Q("인증을 확인하고 있습니다...","info"),localStorage.setItem("excel_addon_auth_key",n),localStorage.setItem("excel_addon_auth_email",t),e.p=5,e.n=6,fetch(u,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({command:"테스트",sheetContext:{activeRange:{address:"A1"},lastRow:1,lastColumn:1,headers:[]},model:"gpt-4.1-2025-04-14",authKey:n,authEmail:t})});case 6:if(403!==(o=e.v).status){e.n=7;break}return Q("유효하지 않은 인증키입니다.","error"),localStorage.removeItem("excel_addon_auth_key"),localStorage.removeItem("excel_addon_auth_email"),e.a(2);case 7:return e.n=8,o.json();case 8:a=e.v,console.log("Auth validation response:",{status:o.status,data:a}),!a.success||a.error||a.debug?(Q(a.error||(a.debug?"유효하지 않은 인증키입니다.":"인증 오류가 발생했습니다."),"error"),localStorage.removeItem("excel_addon_auth_key"),localStorage.removeItem("excel_addon_auth_email")):(Q("인증이 완료되었습니다.","success"),K(),document.getElementById("modelSelect").value="gpt-4.1-2025-04-14",ne(),setTimeout(function(){q()},2e3)),e.n=10;break;case 9:e.p=9,s=e.v,console.error("Auth validation error:",s),Q("인증 확인 중 오류가 발생했습니다.","error"),localStorage.removeItem("excel_addon_auth_key"),localStorage.removeItem("excel_addon_auth_email");case 10:return e.a(2)}},e,null,[[5,9]])}))).apply(this,arguments)}function Q(e,n){var t=document.getElementById("authStatus");t.textContent=e,t.className="auth-status ".concat(n),t.style.display="block"}function ee(){W("문의/요청: support@wrks.ai","info");var e=document.getElementById("status");e&&e.scrollIntoView({behavior:"smooth",block:"center"})}function ne(){var e=document.getElementById("modelSelect"),n=e.value;if("gpt-4.1-2025-04-14"===n&&!localStorage.getItem("excel_addon_auth_key"))return W("GPT-4.1 모델을 사용하려면 인증이 필요합니다.","warning"),e.value="gpt-4.1-nano-2025-04-14",void J();localStorage.setItem("excel_addon_selected_model",n),W("모델이 ".concat(n.includes("mini")?"GPT-4.1-mini":"GPT-4.1","로 변경되었습니다."),"success")}function te(){return(te=s(r().m(function e(){var n,t,o;return r().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,console.log("Testing backend connection..."),e.n=1,fetch("https://excel-addon-backend.vercel.app/api/test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({test:!0})});case 1:return n=e.v,console.log("Test response status:",n.status),console.log("Test response headers:",n.headers),e.n=2,n.json();case 2:t=e.v,console.log("Test response data:",t),W("백엔드 연결 테스트 성공","success"),e.n=4;break;case 3:e.p=3,o=e.v,console.error("Backend test error:",o),W("백엔드 연결 테스트 실패: "+o.message,"error");case 4:return e.a(2)}},e,null,[[0,3]])}))).apply(this,arguments)}function re(e,n){return oe.apply(this,arguments)}function oe(){return(oe=s(r().m(function e(n,t){var o,a,s,c,l,u,i,d,g,m,f,h,p,y,b,v,k,w,C,x,I,E,S,R,B;return r().w(function(e){for(;;)switch(e.p=e.n){case 0:if(console.log("executeBorderFormat called with params:",t),o=n.workbook.worksheets.getActiveWorksheet(),e.p=1,a=[],t.range){e.n=6;break}return e.p=2,(s=n.workbook.getSelectedRanges()).load(["areas","areaCount"]),e.n=3,n.sync();case 3:if(s.areaCount>1)for(c=0;c<s.areas.items.length;c++)a.push(s.areas.items[c]);else a.push(n.workbook.getSelectedRange());e.n=5;break;case 4:return e.p=4,R=e.v,console.log("Error getting selected ranges for border format/removal:",R),e.a(2,{success:!1,error:"선택한 범위를 처리할 수 없습니다. 연속된 범위를 선택해주세요."});case 5:e.n=11;break;case 6:if("all"!==t.range&&"전체"!==t.range){e.n=10;break}return(l=o.getUsedRangeOrNullObject()).load("isNullObject"),e.n=7,n.sync();case 7:if(!l.isNullObject){e.n=8;break}return e.a(2,{success:!1,error:"시트에 데이터가 없습니다."});case 8:a.push(l);case 9:e.n=11;break;case 10:a.push(o.getRange(t.range));case 11:for(u=0,i=a;u<i.length;u++)i[u].load(["address","rowCount","columnCount"]);return e.n=12,n.sync();case 12:for(console.log("Target ranges for border format:",a.length),d=0;d<a.length;d++)console.log("Range ".concat(d+1,":"),{address:a[d].address,rowCount:a[d].rowCount,columnCount:a[d].columnCount});for(g=t.borderType||"all",m=t.color||"#000000",f=t.style||"Continuous",h={continuous:"Continuous",dash:"Dash",dashdot:"DashDot",double:"Double",dot:"Dot",dashdotdot:"DashDotDot",slantdashdot:"SlantDashDot"}[f.toLowerCase()]||"Continuous",p=0,y=a;p<y.length;p++)if(b=y[p],"all"===g)for(v=0,k=["EdgeTop","EdgeBottom","EdgeLeft","EdgeRight","InsideVertical","InsideHorizontal"];v<k.length;v++){w=k[v];try{(C=b.format.borders.getItem(w)).style=h,C.color=m,C.weight="Thin"}catch(e){console.log("Skipping ".concat(w,":"),e.message)}}else if("inside"===g){try{(x=b.format.borders.getItem("InsideVertical")).style=h,x.color=m,x.weight="Thin"}catch(e){console.log("No inside vertical borders")}try{(I=b.format.borders.getItem("InsideHorizontal")).style=h,I.color=m,I.weight="Thin"}catch(e){console.log("No inside horizontal borders")}}else(E={top:"EdgeTop",bottom:"EdgeBottom",left:"EdgeLeft",right:"EdgeRight"}[g.toLowerCase()])&&((S=b.format.borders.getItem(E)).style=h,S.color=m,S.weight="Thin");return e.n=13,n.sync();case 13:return e.a(2,{success:!0,message:"테두리 서식이 적용되었습니다."});case 14:return e.p=14,B=e.v,console.error("Error in executeBorderFormat:",B),e.a(2,{success:!1,error:"테두리 서식 적용 중 오류 발생: ".concat(B.message)})}},e,null,[[2,4],[1,14]])}))).apply(this,arguments)}function ae(e,n){return se.apply(this,arguments)}function se(){return(se=s(r().m(function e(t,o){var a,s,c,l,u,i,d,g,m,f,h,p,y,b;return r().w(function(e){for(;;)switch(e.p=e.n){case 0:if(console.log("executeCompress called with params:",o),a=t.workbook.worksheets.getActiveWorksheet(),e.p=1,o.range){e.n=2;break}return e.a(2,{success:!1,error:"범위를 지정해주세요."});case 2:return(s=a.getRange(o.range)).load(["rowIndex","rowCount","columnIndex","values","address"]),e.n=3,t.sync();case 3:for(console.log("Compress range:",{address:s.address,rowIndex:s.rowIndex,rowCount:s.rowCount,columnIndex:s.columnIndex}),c=[],l=s.values,u=0;u<l.length;u++)(null==(i=l[u][0])||""===i||"string"==typeof i&&""===i.trim())&&c.push(s.rowIndex+u);if(console.log("Found empty rows:",c.length,"rows at indices:",c),0!==c.length){e.n=4;break}return e.a(2,{success:!0,message:"제거할 빈 행이 없습니다."});case 4:d=s.rowIndex,g=s.rowIndex+s.rowCount-1,m=c.filter(function(e){return e>=d&&e<=g}),console.log("Rows to delete (filtered):",m),m.sort(function(e,n){return n-e}),f=n(m),e.p=5,f.s();case 6:if((h=f.n()).done){e.n=8;break}return p=h.value,console.log("Deleting row:",p+1),a.getRangeByIndexes(p,0,1,1e3).delete(Excel.DeleteShiftDirection.up),e.n=7,t.sync();case 7:e.n=6;break;case 8:e.n=10;break;case 9:e.p=9,y=e.v,f.e(y);case 10:return e.p=10,f.f(),e.f(10);case 11:return e.a(2,{success:!0,message:"".concat(m.length,"개의 빈 행이 제거되었습니다.")});case 12:return e.p=12,b=e.v,console.error("Error in executeCompress:",b),e.a(2,{success:!1,error:"빈 행 제거 중 오류 발생: ".concat(b.message)})}},e,null,[[5,9,10,11],[1,12]])}))).apply(this,arguments)}function ce(e,n){return le.apply(this,arguments)}function le(){return(le=s(r().m(function e(n,t){var o,a;return r().w(function(e){for(;;)switch(e.n){case 0:return o=n.workbook.worksheets.getActiveWorksheet(),(a=t.range?o.getRange(t.range):o.getUsedRange()).worksheet.autoFilter.apply(a),e.n=1,n.sync();case 1:return e.a(2,{success:!0,message:"필터가 적용되었습니다."})}},e)}))).apply(this,arguments)}function ue(e,n){return ie.apply(this,arguments)}function ie(){return(ie=s(r().m(function e(n,t){var o,a,s,c;return r().w(function(e){for(;;)switch(e.n){case 0:return o=n.workbook.worksheets.getActiveWorksheet(),a=t.type||"row",s=t.position||1,c=t.count||1,"row"===a?o.getRangeByIndexes(s-1,0,c,1).insert(Excel.InsertShiftDirection.down):o.getRangeByIndexes(0,s-1,1,c).insert(Excel.InsertShiftDirection.right),e.n=1,n.sync();case 1:return e.a(2,{success:!0,message:"".concat(c,"개의 ").concat("row"===a?"행":"열","이 삽입되었습니다.")})}},e)}))).apply(this,arguments)}function de(e,n){return ge.apply(this,arguments)}function ge(){return(ge=s(r().m(function e(n,t){var o,a,s,c,l,u,i,d,g,m,f,h,p;return r().w(function(e){for(;;)switch(e.n){case 0:if(o=n.workbook.worksheets.getActiveWorksheet(),!t.deleteType){e.n=14;break}p=t.deleteType,e.n="column"===p?1:"row"===p?4:"columns"===p?7:"rows"===p?10:13;break;case 1:if(t.column){e.n=2;break}return e.a(2,{success:!1,error:"삭제할 열을 지정해주세요."});case 2:for(a=0,s=0;s<t.column.length;s++)a=26*a+(t.column.charCodeAt(s)-64);return a--,o.getRangeByIndexes(0,a,1048576,1).delete(Excel.DeleteShiftDirection.left),e.n=3,n.sync();case 3:return e.a(2,{success:!0,message:"".concat(t.column,"열이 삭제되었습니다.")});case 4:if(t.row){e.n=5;break}return e.a(2,{success:!1,error:"삭제할 행을 지정해주세요."});case 5:return o.getRangeByIndexes(t.row-1,0,1,16384).delete(Excel.DeleteShiftDirection.up),e.n=6,n.sync();case 6:return e.a(2,{success:!0,message:"".concat(t.row,"행이 삭제되었습니다.")});case 7:if(t.startColumn&&t.endColumn){e.n=8;break}return e.a(2,{success:!1,error:"삭제할 열 범위를 지정해주세요."});case 8:for(c=0,l=0,u=0;u<t.startColumn.length;u++)c=26*c+(t.startColumn.charCodeAt(u)-64);for(i=0;i<t.endColumn.length;i++)l=26*l+(t.endColumn.charCodeAt(i)-64);return c--,l--,d=l-c+1,o.getRangeByIndexes(0,c,1048576,d).delete(Excel.DeleteShiftDirection.left),e.n=9,n.sync();case 9:return e.a(2,{success:!0,message:"".concat(t.startColumn,"-").concat(t.endColumn,"열이 삭제되었습니다.")});case 10:if(t.startRow&&t.endRow){e.n=11;break}return e.a(2,{success:!1,error:"삭제할 행 범위를 지정해주세요."});case 11:return g=t.endRow-t.startRow+1,o.getRangeByIndexes(t.startRow-1,0,g,16384).delete(Excel.DeleteShiftDirection.up),e.n=12,n.sync();case 12:return e.a(2,{success:!0,message:"".concat(t.startRow,"-").concat(t.endRow,"행이 삭제되었습니다.")});case 13:return e.a(2,{success:!1,error:"알 수 없는 삭제 유형입니다."});case 14:return m=t.type||"row",f=t.position||1,h=t.count||1,"row"===m?o.getRangeByIndexes(f-1,0,h,1).delete(Excel.DeleteShiftDirection.up):o.getRangeByIndexes(0,f-1,1,h).delete(Excel.DeleteShiftDirection.left),e.n=15,n.sync();case 15:return e.a(2,{success:!0,message:"".concat(h,"개의 ").concat("row"===m?"행":"열","이 삭제되었습니다.")})}},e)}))).apply(this,arguments)}function me(e,n){return fe.apply(this,arguments)}function fe(){return(fe=s(r().m(function e(n,t){var o,a;return r().w(function(e){for(;;)switch(e.n){case 0:if(o=n.workbook.worksheets.getActiveWorksheet(),a=t.range?o.getRange(t.range):n.workbook.getSelectedRange(),t.formula){e.n=1;break}return e.a(2,{success:!1,error:"수식을 지정해주세요."});case 1:return a.formulas=[[t.formula]],e.n=2,n.sync();case 2:return e.a(2,{success:!0,message:"수식이 적용되었습니다."})}},e)}))).apply(this,arguments)}function he(e,n){return pe.apply(this,arguments)}function pe(){return(pe=s(r().m(function e(n,t){return r().w(function(e){for(;;)if(0===e.n)return e.a(2,{success:!1,error:"이 기능은 현재 구현 중입니다."})},e)}))).apply(this,arguments)}function ye(e,n){return be.apply(this,arguments)}function be(){return(be=s(r().m(function e(n,t){var o,a,s,c,l,u,i,d,g,m,f,h,p,y,b,v,k,w,C,x;return r().w(function(e){for(;;)switch(e.p=e.n){case 0:if(console.log("executeRemoveBorder called with params:",t),o=n.workbook.worksheets.getActiveWorksheet(),e.p=1,a=[],!t.range){e.n=11;break}if("all"!==t.range&&"전체"!==t.range){e.n=6;break}return console.log("Removing borders from entire sheet"),(s=o.getUsedRangeOrNullObject()).load("isNullObject"),e.n=2,n.sync();case 2:if(!s.isNullObject){e.n=3;break}return console.log("No used range in the sheet, nothing to remove borders from"),e.a(2,{success:!0,message:"시트에 데이터가 없어 테두리를 제거할 필요가 없습니다."});case 3:return s.load(["rowCount","columnCount","rowIndex","columnIndex"]),e.n=4,n.sync();case 4:c=Math.min(s.rowCount+100,1048576),l=Math.min(s.columnCount+20,16384),a.push(o.getRangeByIndexes(0,0,c,l));case 5:e.n=10;break;case 6:if(!t.range.match(/^[A-Z]+:[A-Z]+$/)){e.n=9;break}if(console.log("Handling column range:",t.range),u=o.getUsedRange()){e.n=7;break}return e.a(2,{success:!1,error:"데이터가 없습니다."});case 7:return u.load(["rowCount","columnCount"]),e.n=8,n.sync();case 8:i=t.range.split(":")[0],d=i.charCodeAt(0)-65,a.push(o.getRangeByIndexes(0,d,u.rowCount,1)),e.n=10;break;case 9:a.push(o.getRange(t.range));case 10:e.n=14;break;case 11:return e.p=11,(g=n.workbook.getSelectedRanges()).load(["areas","areaCount"]),e.n=12,n.sync();case 12:if(g.areaCount>1)for(m=0;m<g.areas.items.length;m++)a.push(g.areas.items[m]);else a.push(n.workbook.getSelectedRange());e.n=14;break;case 13:return e.p=13,w=e.v,console.log("Error getting selected ranges for border format/removal:",w),e.a(2,{success:!1,error:"선택한 범위를 처리할 수 없습니다. 연속된 범위를 선택해주세요."});case 14:for(f=0,h=a;f<h.length;f++)h[f].load(["address","rowCount","columnCount"]);return e.n=15,n.sync();case 15:for(console.log("Target ranges for border removal:",a.length),p=0;p<a.length;p++)console.log("Range ".concat(p+1,":"),{address:a[p].address,rowCount:a[p].rowCount,columnCount:a[p].columnCount});y=t.borderType||"all",b=0,v=a;case 16:if(!(b<v.length)){e.n=24;break}if(k=v[b],"all"!==y){e.n=17;break}k.format.borders.getItem(Excel.BorderIndex.edgeLeft).style=Excel.BorderLineStyle.none,k.format.borders.getItem(Excel.BorderIndex.edgeRight).style=Excel.BorderLineStyle.none,k.format.borders.getItem(Excel.BorderIndex.edgeTop).style=Excel.BorderLineStyle.none,k.format.borders.getItem(Excel.BorderIndex.edgeBottom).style=Excel.BorderLineStyle.none,k.format.borders.getItem(Excel.BorderIndex.insideHorizontal).style=Excel.BorderLineStyle.none,k.format.borders.getItem(Excel.BorderIndex.insideVertical).style=Excel.BorderLineStyle.none,e.n=23;break;case 17:C=y,e.n="right"===C?18:"left"===C?19:"top"===C?20:"bottom"===C?21:22;break;case 18:return k.format.borders.getItem(Excel.BorderIndex.edgeRight).style=Excel.BorderLineStyle.none,e.a(3,23);case 19:return k.format.borders.getItem(Excel.BorderIndex.edgeLeft).style=Excel.BorderLineStyle.none,e.a(3,23);case 20:return k.format.borders.getItem(Excel.BorderIndex.edgeTop).style=Excel.BorderLineStyle.none,e.a(3,23);case 21:return k.format.borders.getItem(Excel.BorderIndex.edgeBottom).style=Excel.BorderLineStyle.none,e.a(3,23);case 22:return e.a(2,{success:!1,error:"알 수 없는 테두리 유형: ".concat(y)});case 23:b++,e.n=16;break;case 24:return e.n=25,n.sync();case 25:return e.a(2,{success:!0,message:"".concat("all"===y?"모든":y," 테두리가 제거되었습니다.")});case 26:return e.p=26,x=e.v,console.error("Error in executeRemoveBorder:",x),e.a(2,{success:!1,error:"테두리 제거 중 오류 발생: ".concat(x.message)})}},e,null,[[11,13],[1,26]])}))).apply(this,arguments)}}()}();
//# sourceMappingURL=taskpane.js.map