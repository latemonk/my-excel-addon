/*! For license information please see taskpane.js.LICENSE.txt */
!function(){var e={58394:function(e,n,t){"use strict";e.exports=t.p+"e5a3431ffc548452db5a.css"}},n={};function t(r){var a=n[r];if(void 0!==a)return a.exports;var o=n[r]={exports:{}};return e[r](o,o.exports,t),o.exports}t.m=e,t.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},function(){var e;t.g.importScripts&&(e=t.g.location+"");var n=t.g.document;if(!e&&n&&(n.currentScript&&"SCRIPT"===n.currentScript.tagName.toUpperCase()&&(e=n.currentScript.src),!e)){var r=n.getElementsByTagName("script");if(r.length)for(var a=r.length-1;a>-1&&(!e||!/^http(s?):/.test(e));)e=r[a--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),t.p=e}(),t.b=document.baseURI||self.location.href,function(){"use strict";new URL(t(58394),t.b)}(),function(){function e(n){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(n)}function n(e,n){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,n){if(e){if("string"==typeof e)return t(e,n);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?t(e,n):void 0}}(e))||n&&e&&"number"==typeof e.length){r&&(e=r);var a=0,o=function(){};return{s:o,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,c=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return c=e.done,e},e:function(e){u=!0,s=e},f:function(){try{c||null==r.return||r.return()}finally{if(u)throw s}}}}function t(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=Array(n);t<n;t++)r[t]=e[t];return r}function r(){var e,n,t="function"==typeof Symbol?Symbol:{},o=t.iterator||"@@iterator",s=t.toStringTag||"@@toStringTag";function c(t,r,o,s){var c=r&&r.prototype instanceof l?r:l,i=Object.create(c.prototype);return a(i,"_invoke",function(t,r,a){var o,s,c,l=0,i=a||[],d=!1,m={p:0,n:0,v:e,a:g,f:g.bind(e,4),d:function(n,t){return o=n,s=0,c=e,m.n=t,u}};function g(t,r){for(s=t,c=r,n=0;!d&&l&&!a&&n<i.length;n++){var a,o=i[n],g=m.p,f=o[2];t>3?(a=f===r)&&(c=o[(s=o[4])?5:(s=3,3)],o[4]=o[5]=e):o[0]<=g&&((a=t<2&&g<o[1])?(s=0,m.v=r,m.n=o[1]):g<f&&(a=t<3||o[0]>r||r>f)&&(o[4]=t,o[5]=r,m.n=f,s=0))}if(a||t>1)return u;throw d=!0,r}return function(a,i,f){if(l>1)throw TypeError("Generator is already running");for(d&&1===i&&g(i,f),s=i,c=f;(n=s<2?e:c)||!d;){o||(s?s<3?(s>1&&(m.n=-1),g(s,c)):m.n=c:m.v=c);try{if(l=2,o){if(s||(a="next"),n=o[a]){if(!(n=n.call(o,c)))throw TypeError("iterator result is not an object");if(!n.done)return n;c=n.value,s<2&&(s=0)}else 1===s&&(n=o.return)&&n.call(o),s<2&&(c=TypeError("The iterator does not provide a '"+a+"' method"),s=1);o=e}else if((n=(d=m.n<0)?c:t.call(r,m))!==u)break}catch(n){o=e,s=1,c=n}finally{l=1}}return{value:n,done:d}}}(t,o,s),!0),i}var u={};function l(){}function i(){}function d(){}n=Object.getPrototypeOf;var m=[][o]?n(n([][o]())):(a(n={},o,function(){return this}),n),g=d.prototype=l.prototype=Object.create(m);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,a(e,s,"GeneratorFunction")),e.prototype=Object.create(g),e}return i.prototype=d,a(g,"constructor",d),a(d,"constructor",i),i.displayName="GeneratorFunction",a(d,s,"GeneratorFunction"),a(g),a(g,s,"Generator"),a(g,o,function(){return this}),a(g,"toString",function(){return"[object Generator]"}),(r=function(){return{w:c,m:f}})()}function a(e,n,t,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}a=function(e,n,t,r){function s(n,t){a(e,n,function(e){return this._invoke(n,t,e)})}n?o?o(e,n,{value:t,enumerable:!r,configurable:!r,writable:!r}):e[n]=t:(s("next",0),s("throw",1),s("return",2))},a(e,n,t,r)}function o(e,n,t,r,a,o,s){try{var c=e[o](s),u=c.value}catch(e){return void t(e)}c.done?n(u):Promise.resolve(u).then(r,a)}function s(e){return function(){var n=this,t=arguments;return new Promise(function(r,a){var s=e.apply(n,t);function c(e){o(s,r,a,c,u,"next",e)}function u(e){o(s,r,a,c,u,"throw",e)}c(void 0)})}}var c=null,u=!1,l="https://excel-addon-backend.vercel.app/api/openai-proxy";Office.onReady(function(e){if(e.host===Office.HostType.Excel){!function(){te.apply(this,arguments)}(),document.getElementById("executeButton").onclick=d,document.getElementById("clearButton").onclick=Z,document.getElementById("voiceButton").onclick=function(){return function(){if("https:"===window.location.protocol&&!window.location.hostname.includes("localhost"))return G("Excel Online에서는 보안 정책상 음성 인식을 사용할 수 없습니다. 데스크톱 Excel에서 이용해주세요.","error"),void(document.getElementById("voiceStatus").textContent="웹 버전 미지원");if(c)if(u)c.stop();else try{c.start()}catch(e){e.message&&e.message.includes("not-allowed")?G("마이크 권한이 필요합니다. 브라우저 설정에서 마이크 접근을 허용해주세요.","error"):G("음성 인식을 시작할 수 없습니다.","error")}else G("이 브라우저는 음성 인식을 지원하지 않습니다.","error")}()},document.getElementById("authButton").onclick=z,document.getElementById("contactButton").onclick=ee,$();var n=document.getElementById("modelSelect"),t=localStorage.getItem("excel_addon_selected_model"),r=localStorage.getItem("excel_addon_auth_key");"gpt-5-2025-08-07"!==t||r?t?n.value=t:(n.value="gpt-5-nano-2025-08-07",localStorage.setItem("excel_addon_selected_model","gpt-5-nano-2025-08-07")):(localStorage.setItem("excel_addon_selected_model","gpt-5-nano-2025-08-07"),n.value="gpt-5-nano-2025-08-07");var a=document.getElementById("authModal");a.querySelector(".close").onclick=function(){return J()};var o=document.getElementById("deauthModal");window.onclick=function(e){e.target==a?J():e.target==o&&K()},document.getElementById("submitAuthKey").onclick=X,document.getElementById("confirmDeauth").onclick=H,document.getElementById("cancelDeauth").onclick=K,document.getElementById("modelSelect").onchange=ne,document.querySelectorAll(".example-item").forEach(function(e){e.onclick=function(){var e;e=this.getAttribute("data-command"),document.getElementById("commandInput").value=e,document.getElementById("commandInput").focus()}}),document.getElementById("commandInput").addEventListener("keydown",function(e){"Enter"!==e.key||e.shiftKey||(e.preventDefault(),d())}),function(){if("https:"===window.location.protocol&&!window.location.hostname.includes("localhost")){var e=document.getElementById("voiceButton"),n=document.getElementById("voiceStatus");return e.disabled=!0,e.style.opacity="0.5",e.style.cursor="not-allowed",n.textContent="웹 환경에서는 음성 인식 미지원",n.style.color="#666",e.title="Excel Online에서는 보안상 음성 인식을 사용할 수 없습니다. 데스크톱 Excel을 사용해주세요.",null}var t=window.SpeechRecognition||window.webkitSpeechRecognition;if(!t)return G("음성 인식이 지원되지 않는 브라우저입니다.","error"),document.getElementById("voiceButton").disabled=!0,document.getElementById("voiceStatus").textContent="음성 인식 미지원",null;(c=new t).lang="ko-KR",c.continuous=!1,c.interimResults=!0,c.maxAlternatives=1,c.onstart=function(){u=!0,document.getElementById("voiceButton").classList.add("listening"),document.getElementById("voiceStatus").textContent="듣고 있습니다... 말씀해주세요",document.getElementById("voiceStatus").classList.add("listening")},c.onresult=function(e){var n=e.results[0][0].transcript;document.getElementById("commandInput").value=n,e.results[0].isFinal?document.getElementById("voiceStatus").textContent="음성 인식 완료":document.getElementById("voiceStatus").textContent="인식중: "+n},c.onerror=function(e){u=!1,document.getElementById("voiceButton").classList.remove("listening"),document.getElementById("voiceStatus").classList.remove("listening");var n="음성 인식 오류",t="https:"===window.location.protocol&&!window.location.hostname.includes("localhost");switch(e.error){case"no-speech":n="음성이 감지되지 않았습니다.";break;case"audio-capture":n="마이크를 찾을 수 없습니다.";break;case"not-allowed":t?(n="Excel Online에서는 보안 정책상 음성 인식을 사용할 수 없습니다. 데스크톱 Excel에서 이용해주세요.",document.getElementById("voiceStatus").textContent="웹 버전 미지원"):n="마이크 권한이 거부되었습니다. 브라우저 설정을 확인해주세요.";break;case"network":n="네트워크 오류가 발생했습니다.";break;default:t&&e.error&&(n="Excel Online에서는 보안 정책상 음성 인식을 사용할 수 없습니다. 데스크톱 Excel에서 이용해주세요.",document.getElementById("voiceStatus").textContent="웹 버전 미지원")}t&&"not-allowed"===e.error?document.getElementById("voiceStatus").textContent="웹 버전 미지원":document.getElementById("voiceStatus").textContent=n,G(n,"error")},c.onend=function(){u=!1,document.getElementById("voiceButton").classList.remove("listening"),document.getElementById("voiceStatus").classList.remove("listening"),document.getElementById("commandInput").value.trim()?(document.getElementById("voiceStatus").textContent="음성 인식 완료. 실행 버튼을 눌러주세요.",document.getElementById("executeButton").focus()):document.getElementById("voiceStatus").textContent="음성 인식 준비"}}()}});var i=!1;function d(){return m.apply(this,arguments)}function m(){return m=s(r().m(function e(){var n,t,a,o;return r().w(function(e){for(;;)switch(e.p=e.n){case 0:if(!i){e.n=1;break}return e.a(2);case 1:if(n=document.getElementById("commandInput").value.trim()){e.n=2;break}return G("명령어를 입력해주세요.","error"),e.a(2);case 2:return i=!0,t=document.getElementById("executeButton"),a='<span class="ms-Button-label">실행</span>',t.disabled=!0,t.innerHTML='<span class="loading"></span><span>처리중...</span>',G("명령을 처리하고 있습니다...","info"),e.p=3,e.n=4,Excel.run(function(){var e=s(r().m(function e(o){var s,c,u,l,i,d,m,f,h,y,b,k,v,w,C;return r().w(function(e){for(;;)switch(e.p=e.n){case 0:return s=o.workbook.worksheets.getActiveWorksheet(),c=null,e.p=1,(u=o.workbook.getSelectedRanges()).load(["areas","areaCount"]),e.n=2,o.sync();case 2:if(!(u.areaCount>1)){e.n=5;break}return(l=u.areas.items[0]).load(["address","rowIndex","columnIndex","rowCount","columnCount"]),e.n=3,o.sync();case 3:for(i=[],d=0;d<u.areas.items.length;d++)u.areas.items[d].load("address");return e.n=4,o.sync();case 4:for(m=0;m<u.areas.items.length;m++)i.push(u.areas.items[m].address);c={address:i.join(","),row:l.rowIndex+1,column:l.columnIndex+1,numRows:l.rowCount,numColumns:l.columnCount,isMultipleRanges:!0},e.n=7;break;case 5:return(f=u.areas.items[0]).load(["address","rowIndex","columnIndex","rowCount","columnCount"]),e.n=6,o.sync();case 6:c={address:f.address,row:f.rowIndex+1,column:f.columnIndex+1,numRows:f.rowCount,numColumns:f.columnCount,isMultipleRanges:!1};case 7:e.n=9;break;case 8:e.p=8,e.v,c={address:"A1",row:1,column:1,numRows:1,numColumns:1,isMultipleRanges:!1};case 9:return s.load("name"),(h=s.getUsedRange()).load(["rowCount","columnCount","values"]),e.n=10,o.sync();case 10:if(y={sheetName:s.name,activeRange:c,lastRow:h?h.rowCount:0,lastColumn:h?h.columnCount:0,headers:[],dataRange:h?h.values:[],isLargeSheet:h&&h.rowCount>1e3},h&&h.rowCount>0)for(b=h.values[0],k=0;k<b.length;k++)y.headers.push({column:k+1,columnLetter:F(k),label:b[k]?b[k].toString():""});return e.n=11,g(n,y);case 11:if(v=e.v,console.log("API Response:",v),v.success){e.n=12;break}throw new Error(v.error);case 12:if(v.data){e.n=13;break}throw new Error("API 응답에 데이터가 없습니다.");case 13:if((w=v.data).operation||w.operations){e.n=20;break}if(!(w.sumType||w.sourceRange||w.addNewRow)){e.n=14;break}w={operation:"sum",parameters:v.data},e.n=19;break;case 14:if(!(w.averageType||w.column&&!w.deleteType)){e.n=15;break}w={operation:"average",parameters:v.data},e.n=19;break;case 15:if(!(void 0!==w.bold||w.fontColor||w.backgroundColor||w.numberFormat)){e.n=16;break}w={operation:"format",parameters:v.data},e.n=19;break;case 16:if(!w.deleteType){e.n=17;break}w={operation:"delete",parameters:v.data},e.n=19;break;case 17:if(!w.columnName||w.sumType){e.n=18;break}w={operation:"sum",parameters:v.data},e.n=19;break;case 18:throw console.error("Cannot determine operation from response:",v.data),new Error("API 응답 형식을 해석할 수 없습니다.");case 19:console.log("Converted Excel format to standard format:",w);case 20:return e.n=21,p(o,w);case 21:C=e.v,t.disabled=!1,t.innerHTML=a,C.success?(G(C.message||"명령이 성공적으로 실행되었습니다.","success"),setTimeout(function(){document.getElementById("commandInput").value=""},1e3)):G(C.error||"명령 실행에 실패했습니다.","error");case 22:return e.a(2)}},e,null,[[1,8]])}));return function(n){return e.apply(this,arguments)}}());case 4:e.n=6;break;case 5:e.p=5,o=e.v,t.disabled=!1,t.innerHTML=a,G("오류가 발생했습니다: "+o.message,"error");case 6:return e.p=6,i=!1,e.f(6);case 7:return e.a(2)}},e,null,[[3,5,6,7]])})),m.apply(this,arguments)}function g(e,n){return f.apply(this,arguments)}function f(){return(f=s(r().m(function e(n,t){var a,o,s,c,u,i,d,m,g,f;return r().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,a=localStorage.getItem("excel_addon_selected_model")||"gpt-5-nano-2025-08-07",o=localStorage.getItem("excel_addon_auth_key"),s=localStorage.getItem("excel_addon_auth_email"),c={command:n,sheetContext:t,model:a,clientType:"excel"},"gpt-5-2025-08-07"===a&&(c.authKey=o,c.authEmail=s),e.n=1,fetch(l,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)});case 1:if((u=e.v).ok){e.n=9;break}return i="서버 오류 (".concat(u.status,")"),e.p=2,e.n=3,u.json();case 3:d=e.v,i=d.error||i,e.n=8;break;case 4:return e.p=4,e.v,e.p=5,e.n=6,u.text();case 6:m=e.v,i=m.substring(0,100)+"...",e.n=8;break;case 7:e.p=7,e.v,i="서버 오류: ".concat(u.status," ").concat(u.statusText);case 8:return e.a(2,{success:!1,error:i});case 9:return e.n=10,u.json();case 10:return g=e.v,e.a(2,g);case 11:return e.p=11,f=e.v,e.a(2,{success:!1,error:"API 요청 오류: ".concat(f.toString())})}},e,null,[[5,7],[2,4],[0,11]])}))).apply(this,arguments)}function p(e,n){return h.apply(this,arguments)}function h(){return(h=s(r().m(function e(t,a){var o,s,c,u,l,i,d;return r().w(function(e){for(;;)switch(e.p=e.n){case 0:if(!a.operations||!Array.isArray(a.operations)){e.n=9;break}o=[],s=0,c=n(a.operations),e.p=1,c.s();case 2:if((u=c.n()).done){e.n=5;break}return l=u.value,e.n=3,y(t,l.operation,l.parameters||{});case 3:i=e.v,o.push(i),i.success&&s++;case 4:e.n=2;break;case 5:e.n=7;break;case 6:e.p=6,d=e.v,c.e(d);case 7:return e.p=7,c.f(),e.f(7);case 8:return e.a(2,{success:s===a.operations.length,message:"".concat(s,"/").concat(a.operations.length," 작업이 완료되었습니다."),results:o});case 9:return e.n=10,y(t,a.operation,a.parameters||{});case 10:return e.a(2,e.v)}},e,null,[[1,6,7,8]])}))).apply(this,arguments)}function y(e,n,t){return b.apply(this,arguments)}function b(){return(b=s(r().m(function e(n,t,a){var o,s;return r().w(function(e){for(;;)switch(e.p=e.n){case 0:e.p=0,o=t,e.n="merge"===o?1:"sum"===o?3:"average"===o?5:"count"===o?7:"format"===o?9:"sort"===o?11:"filter"===o?13:"insert"===o?15:"delete"===o?17:"formula"===o?19:"chart"===o?21:"conditional_format"===o?23:"translate"===o?25:"compress"===o?27:"retry_translation"===o?29:"remove_border"===o?31:"border_format"===o?33:"standard_deviation"===o?35:"max_value"===o?37:"remove_duplicates"===o?39:41;break;case 1:return e.n=2,k(n,a);case 2:case 4:case 6:case 8:case 10:case 12:case 14:case 16:case 18:case 20:case 22:case 24:case 26:case 28:case 30:case 32:case 34:case 36:case 38:case 40:return e.a(2,e.v);case 3:return e.n=4,w(n,a);case 5:return e.n=6,E(n,a);case 7:return e.n=8,R(n,a);case 9:return e.n=10,_(n,a);case 11:return e.n=12,T(n,a);case 13:return e.n=14,ce(n,a);case 15:return e.n=16,le(n,a);case 17:return e.n=18,de(n,a);case 19:return e.n=20,ge(n,a);case 21:return e.n=22,L(n,a);case 23:return e.n=24,j(n,a);case 25:return e.n=26,D(n,a);case 27:return e.n=28,oe(n,a);case 29:return e.n=30,pe(n,a);case 31:return e.n=32,ye(n,a);case 33:return e.n=34,re(n,a);case 35:return e.n=36,ke(a);case 37:return e.n=38,we(a);case 39:return e.n=40,xe(a);case 41:return e.a(2,{success:!1,error:"알 수 없는 작업: ".concat(t)});case 42:e.n=44;break;case 43:return e.p=43,s=e.v,e.a(2,{success:!1,error:"작업 실행 중 오류: ".concat(s.message||s.toString())});case 44:return e.a(2)}},e,null,[[0,43]])}))).apply(this,arguments)}function k(e,n){return v.apply(this,arguments)}function v(){return(v=s(r().m(function e(n,t){var a,o,s;return r().w(function(e){for(;;)switch(e.n){case 0:return a=n.workbook.worksheets.getActiveWorksheet(),(o=t.range?a.getRange(t.range):n.workbook.getSelectedRange()).load("address"),e.n=1,n.sync();case 1:return s=o.address,o.merge(),e.n=2,n.sync();case 2:return e.a(2,{success:!0,message:"".concat(s," 범위가 병합되었습니다.")})}},e)}))).apply(this,arguments)}function w(e,n){return C.apply(this,arguments)}function C(){return(C=s(r().m(function e(n,t){var a,o,s,c,u,l,i,d,m,g,f,p,h,y,b,k,v,w,C,x,I,E,S,R,B,_,A,T,O,L,N,j,U,D,M,V,P,G,Z,$,z,K,H,q,J,X,Y,Q,ee,ne,te,re,ae,oe,se,ce,ue,le,ie;return r().w(function(e){for(;;)switch(e.p=e.n){case 0:if(a=n.workbook.worksheets.getActiveWorksheet(),"row"!==t.sumType||!t.row){e.n=10;break}if(o=a.getUsedRange()){e.n=1;break}return e.a(2,{success:!1,error:"시트에 데이터가 없습니다."});case 1:return o.load(["columnCount"]),e.n=2,n.sync();case 2:return(s=a.getRangeByIndexes(t.row-1,0,1,o.columnCount)).load(["values"]),e.n=3,n.sync();case 3:c=s.values[0],u=-1,l=c.length-1;case 4:if(!(l>=0)){e.n=6;break}if(null===c[l]||""===c[l]||void 0===c[l]){e.n=5;break}return u=l,e.a(3,6);case 5:l--,e.n=4;break;case 6:if(-1!==u){e.n=7;break}return e.a(2,{success:!1,error:"".concat(t.row,"행에 데이터가 없습니다.")});case 7:return i=u+1,d=a.getCell(t.row-1,i),m=F(u),g="=SUM(".concat("A").concat(t.row,":").concat(m).concat(t.row,")"),d.formulas=[[g]],e.n=8,n.sync();case 8:return d.load(["values","address"]),e.n=9,n.sync();case 9:return e.a(2,{success:!0,message:"".concat(t.row,"행의 합계를 ").concat(d.address,"에 계산했습니다: ").concat(W(d.values[0][0])),value:d.values[0][0]});case 10:if(!t.columnName&&"column"!==t.sumType){e.n=24;break}return(f=a.getUsedRange()).load(["values","rowCount","columnCount"]),e.n=11,n.sync();case 11:if(f&&0!==f.rowCount){e.n=12;break}return e.a(2,{success:!1,error:"시트에 데이터가 없습니다."});case 12:if(p=-1,h="",!t.columnName||!t.columnName.match(/^[A-Z]+$/)){e.n=13;break}for(h=t.columnName,p=0,y=0;y<h.length;y++)p=26*p+(h.charCodeAt(y)-64);p--,e.n=16;break;case 13:b=f.values[0],k=0;case 14:if(!(k<b.length)){e.n=16;break}if(!b[k]||b[k].toString().toLowerCase()!==(t.columnName||"").toLowerCase()){e.n=15;break}return p=k,h=F(k),e.a(3,16);case 15:k++,e.n=14;break;case 16:if(-1!==p){e.n=17;break}return e.a(2,{success:!1,error:'"'.concat(t.columnName,'" 열을 찾을 수 없습니다.')});case 17:for(v=1,w=1;w<f.rowCount;w++)null!==f.values[w][p]&&void 0!==f.values[w][p]&&""!==f.values[w][p]&&(v=w+1);C="".concat(h,"2:").concat(h).concat(v),x=v,I=!1,E=0;case 18:if(!(E<10)){e.n=21;break}return(S=a.getCell(v+E,p)).load("values"),e.n=19,n.sync();case 19:if(null!=(R=S.values[0][0])&&""!==R){e.n=20;break}return x=v+E,I=!0,e.a(3,21);case 20:E++,e.n=18;break;case 21:return I||(x=v),(B=a.getCell(x,p)).formulas=[["=SUM(".concat(C,")")]],e.n=22,n.sync();case 22:return B.load(["values","address"]),e.n=23,n.sync();case 23:return e.a(2,{success:!0,message:"".concat(t.columnName," 열의 합계를 ").concat(B.address,"에 계산했습니다: ").concat(W(B.values[0][0])),value:B.values[0][0]});case 24:if(!t.sourceRange){e.n=26;break}return(_=a.getRange(t.sourceRange)).load(["columnIndex","rowIndex","rowCount","address"]),e.n=25,n.sync();case 25:A="=SUM(".concat(_.address,")"),e.n=41;break;case 26:return e.p=26,(T=n.workbook.getSelectedRanges()).load(["areas","areaCount"]),e.n=27,n.sync();case 27:if(!(T.areaCount>1)){e.n=30;break}for(O=[],L=0;L<T.areas.items.length;L++)T.areas.items[L].load("address");return e.n=28,n.sync();case 28:for(N=0;N<T.areas.items.length;N++)O.push(T.areas.items[N].address);return A="=SUM(".concat(O.join(","),")"),(_=T.areas.items[0]).load(["columnIndex","rowIndex","rowCount"]),e.n=29,n.sync();case 29:e.n=32;break;case 30:return(_=n.workbook.getSelectedRange()).load(["columnIndex","rowIndex","rowCount","address"]),e.n=31,n.sync();case 31:A="=SUM(".concat(_.address,")");case 32:e.n=41;break;case 33:return e.p=33,e.v,e.p=34,(j=n.workbook.getSelectedRanges()).load(["areas","areaCount"]),e.n=35,n.sync();case 35:if(!(j.areas.items.length>0)){e.n=38;break}for(U=[],D=0;D<j.areas.items.length;D++)j.areas.items[D].load("address");return e.n=36,n.sync();case 36:for(M=0;M<j.areas.items.length;M++)U.push(j.areas.items[M].address);return A="=SUM(".concat(U.join(","),")"),(_=j.areas.items[0]).load(["columnIndex","rowIndex","rowCount"]),e.n=37,n.sync();case 37:e.n=39;break;case 38:throw new Error("No ranges selected");case 39:e.n=41;break;case 40:return e.p=40,e.v,e.a(2,{success:!1,error:"선택한 범위를 처리할 수 없습니다. 연속된 범위를 선택해주세요."});case 41:if(!0!==t.addNewRow){e.n=45;break}return _.load(["columnIndex","rowIndex","rowCount"]),e.n=42,n.sync();case 42:return V=_.columnIndex,P=_.rowIndex+_.rowCount,(G=a.getCell(P,V)).formulas=[[A]],e.n=43,n.sync();case 43:return G.load(["values","address"]),e.n=44,n.sync();case 44:return e.a(2,{success:!0,message:"".concat(G.address,"에 합계를 계산했습니다: ").concat(W(G.values[0][0])),value:G.values[0][0]});case 45:if(!t.targetCell){e.n=48;break}return(Z=a.getRange(t.targetCell)).formulas=[[A]],e.n=46,n.sync();case 46:return Z.load(["values","address"]),e.n=47,n.sync();case 47:return e.a(2,{success:!0,message:"".concat(Z.address,"에 합계를 계산했습니다: ").concat(W(Z.values[0][0])),value:Z.values[0][0]});case 48:return($=a.getUsedRange()).load(["rowCount","columnCount"]),e.n=49,n.sync();case 49:if(!A.includes(",")){e.n=58;break}K=$?$.rowCount:1,H=$?$.columnCount:1,q=!1,J=H;case 50:if(!(J<H+5)){e.n=53;break}return(X=a.getCell(_.rowIndex,J)).load("values"),e.n=51,n.sync();case 51:if(X.values[0][0]){e.n=52;break}return z=X,q=!0,e.a(3,53);case 52:J++,e.n=50;break;case 53:if(q){e.n=57;break}Y=K;case 54:if(!(Y<K+5)){e.n=57;break}return(Q=a.getCell(Y,0)).load("values"),e.n=55,n.sync();case 55:if(Q.values[0][0]){e.n=56;break}return z=Q,q=!0,e.a(3,57);case 56:Y++,e.n=54;break;case 57:q||(z=a.getCell(K+2,0)),e.n=69;break;case 58:return _.load(["columnIndex","rowIndex","rowCount","values"]),e.n=59,n.sync();case 59:ee=_.columnIndex,ne=_.values,te=_.rowIndex,re=ne.length-1;case 60:if(!(re>=0)){e.n=62;break}if(null===ne[re][0]||void 0===ne[re][0]||""===ne[re][0]){e.n=61;break}return te=_.rowIndex+re,e.a(3,62);case 61:re--,e.n=60;break;case 62:return oe=ae=te+1,se=!1,(ce=a.getCell(ae,ee)).load("values"),e.n=63,n.sync();case 63:if(null!==ce.values[0][0]&&void 0!==ce.values[0][0]&&""!==ce.values[0][0]){e.n=64;break}oe=ae,se=!0,e.n=68;break;case 64:ue=1;case 65:if(!(ue<10)){e.n=68;break}return(le=a.getCell(ae+ue,ee)).load("values"),e.n=66,n.sync();case 66:if(null!=(ie=le.values[0][0])&&""!==ie){e.n=67;break}return oe=ae+ue,se=!0,e.a(3,68);case 67:ue++,e.n=65;break;case 68:se||(oe=ae+10),z=a.getCell(oe,ee);case 69:return z.formulas=[[A]],e.n=70,n.sync();case 70:return z.load(["values","address"]),e.n=71,n.sync();case 71:return e.a(2,{success:!0,message:"".concat(z.address,"에 합계를 계산했습니다: ").concat(W(z.values[0][0])),value:z.values[0][0]});case 72:return e.a(2)}},e,null,[[34,40],[26,33]])}))).apply(this,arguments)}function x(e){return I.apply(this,arguments)}function I(){return(I=s(r().m(function e(n){var t,a,o,s,c;return r().w(function(e){for(;;)switch(e.n){case 0:if(t=n.workbook.worksheets.getActiveWorksheet(),a=t.getUsedRange()){e.n=1;break}return e.a(2,[]);case 1:return a.load(["values","columnCount"]),e.n=2,n.sync();case 2:if(o=[],s=a.values[0])for(c=0;c<s.length;c++)o.push({column:c+1,columnLetter:F(c),label:s[c]?s[c].toString():""});return e.a(2,o)}},e)}))).apply(this,arguments)}function E(e,n){return S.apply(this,arguments)}function S(){return(S=s(r().m(function e(n,t){var a,o,s,c,u,l,i,d,m,g,f,p,h,y,b,k,v,w,C,I,E,S,R,B,_,A,T,O,L,N,j,U,D,M,V,P,F;return r().w(function(e){for(;;)switch(e.p=e.n){case 0:if(a=n.workbook.worksheets.getActiveWorksheet(),s="",c="",e.p=1,"column"!==t.averageType){e.n=23;break}if(!t.column){e.n=8;break}if(u=a.getUsedRange()){e.n=2;break}return e.a(2,{success:!1,error:"데이터가 없습니다."});case 2:return u.load(["rowCount","columnCount"]),e.n=3,n.sync();case 3:if(!((l=t.column.charCodeAt(0)-65)<0||l>=u.columnCount)){e.n=4;break}return e.a(2,{success:!1,error:"유효하지 않은 열입니다."});case 4:if(!(u.rowCount>1)){e.n=5;break}o=a.getRangeByIndexes(1,l,u.rowCount-1,1),s="".concat(t.column,"열"),e.n=6;break;case 5:return e.a(2,{success:!1,error:"평균을 계산할 데이터가 없습니다."});case 6:return o.load(["address"]),e.n=7,n.sync();case 7:c="=AVERAGE(".concat(o.address,")"),e.n=22;break;case 8:if(!t.columnName){e.n=22;break}if(!t.columnName.match(/^[A-Z]+$/)){e.n=15;break}for(i=t.columnName,d=0,m=0;m<i.length;m++)d=26*d+(i.charCodeAt(m)-64);if(d--,g=a.getUsedRange()){e.n=9;break}return e.a(2,{success:!1,error:"데이터가 없습니다."});case 9:return g.load(["rowCount","columnCount"]),e.n=10,n.sync();case 10:if(!(d<0||d>=g.columnCount)){e.n=11;break}return e.a(2,{success:!1,error:"유효하지 않은 열입니다."});case 11:if(!(g.rowCount>1)){e.n=12;break}o=a.getRangeByIndexes(1,d,g.rowCount-1,1),s="".concat(t.columnName,"열"),e.n=13;break;case 12:return e.a(2,{success:!1,error:"평균을 계산할 데이터가 없습니다."});case 13:return o.load(["address"]),e.n=14,n.sync();case 14:c="=AVERAGE(".concat(o.address,")"),e.n=22;break;case 15:return e.n=16,x(n);case 16:if(f=e.v,p=f.find(function(e){return e.label===t.columnName})){e.n=17;break}return e.a(2,{success:!1,error:'"'.concat(t.columnName,'" 열을 찾을 수 없습니다.')});case 17:return(h=a.getUsedRange()).load(["rowCount"]),e.n=18,n.sync();case 18:if(!(h.rowCount>1)){e.n=19;break}o=a.getRangeByIndexes(1,p.column-1,h.rowCount-1,1),s='"'.concat(t.columnName,'" 열'),e.n=20;break;case 19:return e.a(2,{success:!1,error:"평균을 계산할 데이터가 없습니다."});case 20:return o.load(["address"]),e.n=21,n.sync();case 21:c="=AVERAGE(".concat(o.address,")");case 22:e.n=45;break;case 23:if("row"!==t.averageType){e.n=28;break}if(y=a.getUsedRange()){e.n=24;break}return e.a(2,{success:!1,error:"데이터가 없습니다."});case 24:return y.load(["rowCount","columnCount"]),e.n=25,n.sync();case 25:if(!((b=t.row-1)<0||b>=y.rowCount)){e.n=26;break}return e.a(2,{success:!1,error:"유효하지 않은 행입니다."});case 26:return o=a.getRangeByIndexes(b,0,1,y.columnCount),s="".concat(t.row,"행"),o.load(["address","rowIndex","columnIndex","columnCount"]),e.n=27,n.sync();case 27:c="=AVERAGE(".concat(o.address,")"),e.n=45;break;case 28:if(!t.sourceRange){e.n=30;break}return o=a.getRange(t.sourceRange),s=t.sourceRange,o.load(["address"]),e.n=29,n.sync();case 29:c="=AVERAGE(".concat(o.address,")"),e.n=45;break;case 30:return e.p=30,(k=n.workbook.getSelectedRanges()).load(["areas","areaCount"]),e.n=31,n.sync();case 31:if(!(k.areaCount>1)){e.n=34;break}for(v=[],w=0;w<k.areas.items.length;w++)k.areas.items[w].load("address");return e.n=32,n.sync();case 32:for(C=0;C<k.areas.items.length;C++)v.push(k.areas.items[C].address);return c="=AVERAGE(".concat(v.join(","),")"),s="선택한 셀",(o=k.areas.items[0]).load(["columnIndex","rowIndex","rowCount","columnCount"]),e.n=33,n.sync();case 33:e.n=36;break;case 34:return o=n.workbook.getSelectedRange(),s="선택한 범위",o.load(["columnIndex","rowIndex","rowCount","columnCount","address"]),e.n=35,n.sync();case 35:c="=AVERAGE(".concat(o.address,")");case 36:e.n=45;break;case 37:return e.p=37,e.v,e.p=38,(I=n.workbook.getSelectedRanges()).load(["areas","areaCount"]),e.n=39,n.sync();case 39:if(!(I.areas.items.length>0)){e.n=42;break}for(E=[],S=0;S<I.areas.items.length;S++)I.areas.items[S].load("address");return e.n=40,n.sync();case 40:for(R=0;R<I.areas.items.length;R++)E.push(I.areas.items[R].address);return c="=AVERAGE(".concat(E.join(","),")"),s="선택한 셀",(o=I.areas.items[0]).load(["columnIndex","rowIndex","rowCount","columnCount"]),e.n=41,n.sync();case 41:e.n=43;break;case 42:throw new Error("No ranges selected");case 43:e.n=45;break;case 44:return e.p=44,e.v,e.a(2,{success:!1,error:"선택한 범위를 처리할 수 없습니다. 연속된 범위를 선택해주세요."});case 45:return o.load(["columnIndex","rowIndex","rowCount","columnCount"]),e.n=46,n.sync();case 46:if(!t.targetCell){e.n=47;break}B=a.getRange(t.targetCell),e.n=59;break;case 47:if("row"!==t.averageType){e.n=48;break}_=o.columnIndex+o.columnCount,B=a.getCell(o.rowIndex,_),e.n=59;break;case 48:return o.load(["values"]),e.n=49,n.sync();case 49:A=o.columnIndex,T=o.values,O=o.rowIndex,L=T.length-1;case 50:if(!(L>=0)){e.n=52;break}if(null===T[L][0]||void 0===T[L][0]||""===T[L][0]){e.n=51;break}return O=o.rowIndex+L,e.a(3,52);case 51:L--,e.n=50;break;case 52:return j=N=O+1,U=!1,(D=a.getCell(N,A)).load("values"),e.n=53,n.sync();case 53:if(null!==D.values[0][0]&&void 0!==D.values[0][0]&&""!==D.values[0][0]){e.n=54;break}j=N,U=!0,e.n=58;break;case 54:M=1;case 55:if(!(M<10)){e.n=58;break}return(V=a.getCell(N+M,A)).load("values"),e.n=56,n.sync();case 56:if(null!=(P=V.values[0][0])&&""!==P){e.n=57;break}return j=N+M,U=!0,e.a(3,58);case 57:M++,e.n=55;break;case 58:U||(j=N+10),B=a.getCell(j,A);case 59:return B.formulas=[[c]],B.numberFormat=[["#,##0.00"]],e.n=60,n.sync();case 60:return B.load(["values","address"]),e.n=61,n.sync();case 61:return e.a(2,{success:!0,message:"".concat(s,"의 평균을 ").concat(B.address,"에 계산했습니다: ").concat(W(B.values[0][0])),value:B.values[0][0]});case 62:return e.p=62,F=e.v,e.a(2,{success:!1,error:"평균 계산 중 오류 발생: ".concat(F.message)})}},e,null,[[38,44],[30,37],[1,62]])}))).apply(this,arguments)}function R(e,n){return B.apply(this,arguments)}function B(){return(B=s(r().m(function e(n,t){var a,o,s,c,u,l,i,d;return r().w(function(e){for(;;)switch(e.n){case 0:return a=n.workbook.worksheets.getActiveWorksheet(),(o=t.sourceRange?a.getRange(t.sourceRange):n.workbook.getSelectedRange()).load(["address"]),e.n=1,n.sync();case 1:if("countif"===t.countType&&void 0!==t.condition?(c="contains"===t.operator?'"*'.concat(t.condition,'*"'):"equals"===t.operator?"string"==typeof t.condition?'"'.concat(t.condition,'"'):t.condition:t.operator&&[">","<",">=","<=","<>"].includes(t.operator)?'"'.concat(t.operator).concat(t.condition,'"'):"string"==typeof t.condition?'"*'.concat(t.condition,'*"'):t.condition,s="=COUNTIF(".concat(o.address,", ").concat(c,")")):s="counta"===t.countType?"=COUNTA(".concat(o.address,")"):"=COUNT(".concat(o.address,")"),!t.targetCell){e.n=2;break}u=a.getRange(t.targetCell),e.n=4;break;case 2:return l=a.getUsedRange(),e.n=3,n.sync();case 3:i=l?l.rowCount:1,d=l?l.columnCount:1,u=a.getCell(i,d);case 4:return u.formulas=[[s]],e.n=5,n.sync();case 5:return u.load("values"),e.n=6,n.sync();case 6:return e.a(2,{success:!0,message:"countif"===t.countType?'"'.concat(t.condition,'"을(를) 포함하는 셀의 개수: ').concat(W(u.values[0][0]),"개"):"개수를 계산했습니다: ".concat(W(u.values[0][0]),"개"),value:u.values[0][0]})}},e)}))).apply(this,arguments)}function _(e,n){return A.apply(this,arguments)}function A(){return(A=s(r().m(function e(n,t){var a,o,s,c,u,l,i,d,m,g;return r().w(function(e){for(;;)switch(e.p=e.n){case 0:if(a=n.workbook.worksheets.getActiveWorksheet(),o=[],!t.range){e.n=1;break}o.push(a.getRange(t.range)),e.n=4;break;case 1:return e.p=1,(s=n.workbook.getSelectedRanges()).load(["areas","areaCount"]),e.n=2,n.sync();case 2:if(s.areaCount>1)for(c=0;c<s.areas.items.length;c++)o.push(s.areas.items[c]);else o.push(n.workbook.getSelectedRange());e.n=4;break;case 3:return e.p=3,e.v,e.a(2,{success:!1,error:"선택한 범위를 처리할 수 없습니다. 연속된 범위를 선택해주세요."});case 4:for(u=0,l=o;u<l.length;u++)l[u].load("format");return e.n=5,n.sync();case 5:for(i=0,d=o;i<d.length;i++)m=d[i],void 0!==t.bold&&(m.format.font.bold=t.bold),void 0!==t.italic&&(m.format.font.italic=t.italic),t.fontSize&&(m.format.font.size=t.fontSize),t.fontColor&&(m.format.font.color=t.fontColor),t.backgroundColor&&(m.format.fill.color=t.backgroundColor),t.horizontalAlignment&&(m.format.horizontalAlignment="left"===t.horizontalAlignment?"Left":"center"===t.horizontalAlignment?"Center":"right"===t.horizontalAlignment?"Right":"General"),t.numberFormat&&("number"===(g=t.numberFormat)||"숫자"===g?g="#,##0":"currency"===g||"원화"===g||"won"===g||"통화"===g?g="₩#,##0":"currency_decimal"===g||"원화_소수"===g?g="₩#,##0.00":"percentage"===g||"퍼센트"===g||"백분율"===g?g="0%":"percentage_decimal"===g||"퍼센트_소수"===g?g="0.00%":"date"===g||"날짜"===g?g="yyyy-mm-dd":"time"===g||"시간"===g?g="hh:mm:ss":"text"===g||"텍스트"===g?g="@":"general"!==g&&"일반"!==g||(g="General"),m.numberFormat=g);return e.n=6,n.sync();case 6:return e.a(2,{success:!0,message:"서식이 적용되었습니다."})}},e,null,[[1,3]])}))).apply(this,arguments)}function T(e,n){return O.apply(this,arguments)}function O(){return(O=s(r().m(function e(n,t){var a,o,s,c,u;return r().w(function(e){for(;;)switch(e.n){case 0:return a=n.workbook.worksheets.getActiveWorksheet(),o=t.range?a.getRange(t.range):a.getUsedRange(),s=t.column||1,c=void 0===t.ascending||t.ascending,o.sort.apply([{key:s-1,ascending:c}]),e.n=1,n.sync();case 1:return u=F(s-1),e.a(2,{success:!0,message:"".concat(u,"열 기준으로 ").concat(c?"오름차순":"내림차순"," 정렬되었습니다.")})}},e)}))).apply(this,arguments)}function L(e,n){return N.apply(this,arguments)}function N(){return(N=s(r().m(function e(t,a){var o,s,c,u,l,i,d,m,g,f,p,h,y,b,k,v,w,C,x,I,E,S,R,B,_,A,T;return r().w(function(e){for(;;)switch(e.p=e.n){case 0:if(o=t.workbook.worksheets.getActiveWorksheet(),c="",!a.range){e.n=2;break}return(s=o.getRange(a.range)).load(["address","values"]),e.n=1,t.sync();case 1:c=s.address,e.n=21;break;case 2:return e.p=2,(u=t.workbook.getSelectedRanges()).load(["areas","areaCount"]),e.n=3,t.sync();case 3:if(!(u.areaCount>1)){e.n=17;break}for(l=[],i=0;i<u.areas.items.length;i++)(d=u.areas.items[i]).load(["address","values","rowIndex","columnIndex"]),l.push(d);return e.n=4,t.sync();case 4:return(m=o.getUsedRangeOrNullObject()).load(["isNullObject","rowCount","columnCount"]),e.n=5,t.sync();case 5:for(g=m.isNullObject?1:m.rowCount+2,f=0,p=[],h=1,y=0,b=l;y<b.length;y++)if((k=b[y]).values&&k.values.length>0){v=n(k.values);try{for(v.s();!(w=v.n()).done;)C=w.value,p.push(C),h=Math.max(h,C.length)}catch(e){v.e(e)}finally{v.f()}}if(!(p.length>0)){e.n=15;break}if(e.p=6,!p.every(function(e){return 1===e.length})){e.n=9;break}for(x=[],I=0;I<p.length;I++)null!=(E=p[I][0])&&""!==E&&x.push(["Item ".concat(I+1),E]);if(0!==x.length){e.n=7;break}return e.a(2,{success:!1,error:"선택한 셀에 유효한 데이터가 없습니다."});case 7:return(S=o.getRangeByIndexes(g,f,x.length,2)).values=x,e.n=8,t.sync();case 8:s=S,e.n=11;break;case 9:return(R=o.getRangeByIndexes(g,f,p.length,h)).values=p,e.n=10,t.sync();case 10:s=R;case 11:return s.load(["address","values","rowCount","columnCount"]),e.n=12,t.sync();case 12:c=s.address,e.n=14;break;case 13:return e.p=13,e.v,e.a(2,{success:!1,error:"임시 데이터 범위 생성 중 오류가 발생했습니다."});case 14:e.n=16;break;case 15:return e.a(2,{success:!1,error:"선택한 셀에 데이터가 없습니다."});case 16:e.n=19;break;case 17:return(s=t.workbook.getSelectedRange()).load(["address","values"]),e.n=18,t.sync();case 18:c=s.address;case 19:e.n=21;break;case 20:return e.p=20,e.v,e.a(2,{success:!1,error:"선택한 범위를 처리할 수 없습니다. 연속된 범위를 선택해주세요."});case 21:if(B="bar"===a.chartType||"막대"===a.chartType?Excel.ChartType.columnClustered:"line"===a.chartType||"선"===a.chartType?Excel.ChartType.line:"pie"===a.chartType||"원"===a.chartType?Excel.ChartType.pie:"scatter"===a.chartType||"분산형"===a.chartType?Excel.ChartType.xyscatter:Excel.ChartType.columnClustered,e.p=22,s){e.n=23;break}return e.a(2,{success:!1,error:"차트 데이터가 없습니다."});case 23:return(_=o.charts.add(B,s,Excel.ChartSeriesBy.auto)).title.text=a.title||"차트",_.height=300,_.width=400,_.left=a.offsetX||100,_.top=a.offsetY||100,_.legend.position=Excel.ChartLegendPosition.bottom,_.legend.visible=!0,e.n=24,t.sync();case 24:e.n=30;break;case 25:if(e.p=25,T=e.v,B===Excel.ChartType.columnClustered){e.n=29;break}return e.p=26,(A=o.charts.add(Excel.ChartType.columnClustered,s,Excel.ChartSeriesBy.auto)).title.text=a.title||"차트",A.height=300,A.width=400,A.left=a.offsetX||100,A.top=a.offsetY||100,e.n=27,t.sync();case 27:return e.a(2,{success:!0,message:"".concat(c," 범위로 막대 차트가 생성되었습니다. (원래 요청한 차트 타입이 지원되지 않아 막대 차트로 대체되었습니다.)")});case 28:return e.p=28,e.v,e.a(2,{success:!1,error:"차트 생성에 실패했습니다. 데이터 형식을 확인해주세요."});case 29:return e.a(2,{success:!1,error:"차트 생성 중 오류: ".concat(T.message)});case 30:return e.a(2,{success:!0,message:"".concat(c," 범위로 ").concat(a.chartType||"막대"," 차트가 생성되었습니다.")})}},e,null,[[26,28],[22,25],[6,13],[2,20]])}))).apply(this,arguments)}function j(e,n){return U.apply(this,arguments)}function U(){return(U=s(r().m(function e(n,t){var a,o,s,c,u,l,i,d,m;return r().w(function(e){for(;;)switch(e.p=e.n){case 0:if(a=n.workbook.worksheets.getActiveWorksheet(),o=[],!t.range){e.n=1;break}o.push(a.getRange(t.range)),e.n=3;break;case 1:return(s=a.getUsedRangeOrNullObject()).load("isNullObject"),e.n=2,n.sync();case 2:s.isNullObject?(c=a.getRange("A1:XFD1048576"),o.push(c)):o.push(s);case 3:e.p=3,u=0,l=o;case 4:if(!(u<l.length)){e.n=7;break}return(i=l[u]).load("address"),e.n=5,n.sync();case 5:d=i.conditionalFormats.add(Excel.ConditionalFormatType.cellValue),"greater_than"===t.condition&&void 0!==t.value?d.cellValue.rule={formula1:t.value.toString(),operator:Excel.ConditionalCellValueOperator.greaterThan}:"less_than"===t.condition&&void 0!==t.value?d.cellValue.rule={formula1:t.value.toString(),operator:Excel.ConditionalCellValueOperator.lessThan}:"equal_to"===t.condition&&void 0!==t.value?d.cellValue.rule={formula1:t.value.toString(),operator:Excel.ConditionalCellValueOperator.equalTo}:"text_contains"===t.condition&&void 0!==t.value?d.cellValue.rule={formula1:t.value.toString(),operator:Excel.ConditionalCellValueOperator.containsText}:d.cellValue.rule={formula1:(t.value||0).toString(),operator:Excel.ConditionalCellValueOperator.greaterThan},d.cellValue.format.fill.color=t.backgroundColor||"#00FF00",t.fontColor&&(d.cellValue.format.font.color=t.fontColor),t.bold&&(d.cellValue.format.font.bold=!0);case 6:u++,e.n=4;break;case 7:e.n=9;break;case 8:return e.p=8,m=e.v,e.a(2,{success:!1,error:"조건부 서식 적용 중 오류: ".concat(m.message)});case 9:return e.n=10,n.sync();case 10:return e.a(2,{success:!0,message:"조건부 서식이 적용되었습니다. (".concat(t.condition," ").concat(t.value||"",")")})}},e,null,[[3,8]])}))).apply(this,arguments)}function D(e,n){return M.apply(this,arguments)}function M(){return(M=s(r().m(function t(a,o){var s,c,u,l,i,d,m,g,f,p,h,y,b,k,v,w,C,x,I,E,S,R,B,_,A,T,O,L,N,j,U,D,M,P,F,W,Z,$,z;return r().w(function(t){for(;;)switch(t.n){case 0:if(s=a.workbook.worksheets.getActiveWorksheet(),o.targetLanguage){t.n=1;break}return t.a(2,{success:!1,error:"대상 언어를 지정해주세요."});case 1:if(!o.sourceRange){t.n=8;break}if(!o.sourceRange.match(/^[A-Z]+:[A-Z]+$/)){t.n=6;break}if(l=s.getUsedRange()){t.n=2;break}return t.a(2,{success:!1,error:"번역할 데이터가 없습니다."});case 2:return l.load(["rowCount","columnCount"]),t.n=3,a.sync();case 3:if(i=o.sourceRange.split(":")[0],d=i.charCodeAt(0)-65,!(l.rowCount>1)){t.n=4;break}c=s.getRangeByIndexes(1,d,l.rowCount-1,1),t.n=5;break;case 4:return t.a(2,{success:!1,error:"번역할 데이터가 없습니다."});case 5:o.targetRange&&o.targetRange.match(/^[A-Z]+:[A-Z]+$/)?(m=o.targetRange.split(":")[0],u=m.charCodeAt(0)-65):u=d+1,t.n=7;break;case 6:c=s.getRange(o.sourceRange),o.targetRange&&o.targetRange.match(/^[A-Z]+:[A-Z]+$/)&&(g=o.targetRange.split(":")[0],u=g.charCodeAt(0)-65);case 7:t.n=13;break;case 8:if(!o.sourceColumn){t.n=12;break}return f=o.sourceColumn.charCodeAt(0)-65,(p=s.getUsedRange()).load(["rowCount"]),t.n=9,a.sync();case 9:if(!(p.rowCount>1)){t.n=10;break}c=s.getRangeByIndexes(1,f,p.rowCount-1,1),t.n=11;break;case 10:return t.a(2,{success:!1,error:"번역할 데이터가 없습니다."});case 11:u="next"===o.targetColumn?f+1:o.targetColumn?o.targetColumn.charCodeAt(0)-65:f+1,t.n=13;break;case 12:return t.a(2,{success:!1,error:"번역할 열을 지정해주세요."});case 13:return c.load(["values","rowIndex","columnIndex","rowCount"]),t.n=14,a.sync();case 14:if((h=c.values)&&0!==h.length){t.n=15;break}return t.a(2,{success:!1,error:"번역할 데이터가 없습니다."});case 15:y=[],b=20,k=0;case 16:if(!(k<h.length)){t.n=21;break}if(v=h.slice(k,Math.min(k+b,h.length)),!((w=v.map(function(e){return e[0]}).filter(function(e){return e})).length>0)){t.n=18;break}return t.n=17,V(w,o.targetLanguage,o.sourceLanguage);case 17:if((C=t.v)&&Array.isArray(C))for(I=0,E=0;E<v.length;E++)v[E][0]?((S=C[I]||"")&&""!==S.trim()?y.push([{text:S,isError:!1}]):y.push([{text:"번역 실패",isError:!0}]),I++):y.push([{text:"",isError:!1}]);else for(x=0;x<v.length;x++)v[x][0]?y.push([{text:"번역 실패",isError:!0}]):y.push([{text:"",isError:!1}]);t.n=19;break;case 18:for(R=0;R<v.length;R++)y.push([{text:"",isError:!1}]);case 19:k%100==0&&k>0&&G("번역 중... ".concat(Math.round(k/h.length*100),"% (").concat(k,"/").concat(h.length,")"),"info");case 20:k+=b,t.n=16;break;case 21:for(B=0;B<Math.min(5,y.length);B++);return void 0===u&&(u=c.columnIndex+1),(_=s.getRangeByIndexes(c.rowIndex,u,y.length,1)).load(["address","values"]),t.n=22,a.sync();case 22:return _.clear(Excel.ClearApplyTo.contents),t.n=23,a.sync();case 23:for(A=[],T=[],O=0;O<y.length;O++)(L=y[O][0])&&"object"===e(L)?(A.push([L.text]),L.isError&&T.push(O)):A.push([String(L||"")]);return _.values=A,t.n=24,a.sync();case 24:if(!(T.length>0)){t.n=25;break}N=n(T);try{for(N.s();!(j=N.n()).done;)U=j.value,(D=_.getCell(U,0)).format.fill.color="#FFE6E6",D.format.font.color="#CC0000",D.format.font.bold=!0}catch(e){N.e(e)}finally{N.f()}return t.n=25,a.sync();case 25:return _.load(["values","text","valueTypes"]),t.n=26,a.sync();case 26:if(!(y.length>0)){t.n=30;break}if(_.values[0]&&_.values[0][0]&&""!==_.values[0][0]){t.n=30;break}M=0;case 27:if(!(M<Math.min(3,y.length))){t.n=30;break}return P=c.rowIndex+M,F=u||c.columnIndex+1,W=s.getCell(P,F),Z=A[M][0],W.values=[[Z]],t.n=28,a.sync();case 28:return W.load("values"),t.n=29,a.sync();case 29:M++,t.n=27;break;case 30:return $=s.getCell(0,u||c.columnIndex+1),(z=s.getCell(0,c.columnIndex)).load("values"),t.n=31,a.sync();case 31:return $.values=[["".concat(z.values[0][0]," (").concat(o.targetLanguage,")")]],t.n=32,a.sync();case 32:return t.a(2,{success:!0,message:"번역이 완료되었습니다. (".concat(h.length,"개 항목)")})}},t)}))).apply(this,arguments)}function V(e,n,t){return P.apply(this,arguments)}function P(){return(P=s(r().m(function e(n,t,a){var o,s,c,u,i,d;return r().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,o=localStorage.getItem("excel_addon_selected_model")||"gpt-5-nano-2025-08-07",s=localStorage.getItem("excel_addon_auth_key"),c=localStorage.getItem("excel_addon_auth_email"),u={command:"Translate these items to ".concat(t,": ").concat(n.join(", ")),sheetContext:{operation:"translate_batch",texts:n,targetLanguage:t,sourceLanguage:a},model:o,clientType:"excel"},"gpt-5-2025-08-07"===o&&(u.authKey=s,u.authEmail=c),e.n=1,fetch(l,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(u)});case 1:if((i=e.v).ok){e.n=2;break}throw new Error("HTTP error! status: ".concat(i.status));case 2:return e.n=3,i.json();case 3:if(!((d=e.v).success&&d.data&&d.data.translations)){e.n=4;break}return e.a(2,d.data.translations);case 4:if(!d.error){e.n=5;break}throw new Error(d.error);case 5:throw new Error("번역 응답을 받을 수 없습니다.");case 6:e.n=8;break;case 7:return e.p=7,e.v,e.a(2,n.map(function(){return""}));case 8:return e.a(2)}},e,null,[[0,7]])}))).apply(this,arguments)}function F(e){for(var n="",t=e;t>=0;)n=String.fromCharCode(t%26+65)+n,t=Math.floor(t/26)-1;return n}function W(e){return"number"==typeof e?Number.isInteger(e)?e.toLocaleString("ko-KR"):e.toLocaleString("ko-KR",{minimumFractionDigits:0,maximumFractionDigits:2}):e}function G(e,n){var t=document.getElementById("status");t.textContent=e,t.className="status-message "+n,t.style.display="block",window.statusTimeout&&clearTimeout(window.statusTimeout),"success"===n&&(window.statusTimeout=setTimeout(function(){t.style.display="none"},5e3))}function Z(){document.getElementById("commandInput").value="",document.getElementById("status").style.display="none"}function $(){var e=localStorage.getItem("excel_addon_auth_key"),n=localStorage.getItem("excel_addon_auth_email"),t=document.getElementById("authButton");e&&n?(t.textContent="인증 해제",t.classList.add("authenticated")):(t.textContent="인증",t.classList.remove("authenticated"))}function z(){var e=localStorage.getItem("excel_addon_auth_key"),n=localStorage.getItem("excel_addon_auth_email");e&&n?document.getElementById("deauthModal").style.display="block":q()}function K(){document.getElementById("deauthModal").style.display="none"}function H(){try{localStorage.removeItem("excel_addon_auth_key"),localStorage.removeItem("excel_addon_auth_email"),document.getElementById("modelSelect").value="gpt-5-nano-2025-08-07",$(),K(),G("인증이 해제되었습니다. 무료 모델로 전환됩니다.","success")}catch(e){G("인증 해제 중 오류가 발생했습니다.","error")}}function q(){document.getElementById("authModal").style.display="block"}function J(){document.getElementById("authModal").style.display="none",document.getElementById("authEmailInput").value="",document.getElementById("authKeyInput").value="",document.getElementById("authStatus").style.display="none"}function X(){return Y.apply(this,arguments)}function Y(){return(Y=s(r().m(function e(){var n,t,a,o;return r().w(function(e){for(;;)switch(e.p=e.n){case 0:if(n=document.getElementById("authKeyInput").value.trim(),t=document.getElementById("authEmailInput").value.trim()){e.n=1;break}return Q("이메일 주소를 입력해주세요.","error"),e.a(2);case 1:if(/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t)){e.n=2;break}return Q("올바른 이메일 형식이 아닙니다.","error"),e.a(2);case 2:if(n){e.n=3;break}return Q("인증키를 입력해주세요.","error"),e.a(2);case 3:if(!(n.length<8)){e.n=4;break}return Q("인증키는 최소 8자 이상이어야 합니다.","error"),e.a(2);case 4:return Q("인증을 확인하고 있습니다...","info"),localStorage.setItem("excel_addon_auth_key",n),localStorage.setItem("excel_addon_auth_email",t),e.p=5,e.n=6,fetch(l,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({command:"테스트",sheetContext:{activeRange:{address:"A1"},lastRow:1,lastColumn:1,headers:[]},model:"gpt-5-2025-08-07",authKey:n,authEmail:t})});case 6:if(403!==(a=e.v).status){e.n=7;break}return Q("유효하지 않은 인증키입니다.","error"),localStorage.removeItem("excel_addon_auth_key"),localStorage.removeItem("excel_addon_auth_email"),e.a(2);case 7:return e.n=8,a.json();case 8:!(o=e.v).success||o.error||o.debug?(Q(o.error||(o.debug?"유효하지 않은 인증키입니다.":"인증 오류가 발생했습니다."),"error"),localStorage.removeItem("excel_addon_auth_key"),localStorage.removeItem("excel_addon_auth_email")):(Q("인증이 완료되었습니다.","success"),$(),document.getElementById("modelSelect").value="gpt-5-2025-08-07",ne(),setTimeout(function(){J()},2e3)),e.n=10;break;case 9:e.p=9,e.v,Q("인증 확인 중 오류가 발생했습니다.","error"),localStorage.removeItem("excel_addon_auth_key"),localStorage.removeItem("excel_addon_auth_email");case 10:return e.a(2)}},e,null,[[5,9]])}))).apply(this,arguments)}function Q(e,n){var t=document.getElementById("authStatus");t.textContent=e,t.className="auth-status ".concat(n),t.style.display="block"}function ee(){window.open("https://bit.ly/cellyform","_blank")}function ne(){var e,n=document.getElementById("modelSelect"),t=n.value;if("gpt-5-2025-08-07"===t&&!localStorage.getItem("excel_addon_auth_key"))return G("GPT-5 모델을 사용하려면 인증이 필요합니다.","warning"),n.value="gpt-5-nano-2025-08-07",void q();localStorage.setItem("excel_addon_selected_model",t),e=t.includes("nano")?"GPT-5 nano":t.includes("mini")?"GPT-5 mini":"GPT-5",G("모델이 ".concat(e,"로 변경되었습니다."),"success")}function te(){return(te=s(r().m(function e(){var n;return r().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,fetch("https://excel-addon-backend.vercel.app/api/test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({test:!0})});case 1:return n=e.v,e.n=2,n.json();case 2:e.v,G("백엔드 연결 테스트 성공","success"),e.n=4;break;case 3:e.p=3,G("백엔드 연결 테스트 실패: "+e.v.message,"error");case 4:return e.a(2)}},e,null,[[0,3]])}))).apply(this,arguments)}function re(e,n){return ae.apply(this,arguments)}function ae(){return(ae=s(r().m(function e(n,t){var a,o,s,c,u,l,i,d,m,g,f,p,h,y,b,k,v,w,C,x,I,E,S,R;return r().w(function(e){for(;;)switch(e.p=e.n){case 0:if(a=n.workbook.worksheets.getActiveWorksheet(),e.p=1,o=[],t.range){e.n=6;break}return e.p=2,(s=n.workbook.getSelectedRanges()).load(["areas","areaCount"]),e.n=3,n.sync();case 3:if(s.areaCount>1)for(c=0;c<s.areas.items.length;c++)o.push(s.areas.items[c]);else o.push(n.workbook.getSelectedRange());e.n=5;break;case 4:return e.p=4,e.v,e.a(2,{success:!1,error:"선택한 범위를 처리할 수 없습니다. 연속된 범위를 선택해주세요."});case 5:e.n=11;break;case 6:if("all"!==t.range&&"전체"!==t.range){e.n=10;break}return(u=a.getUsedRangeOrNullObject()).load("isNullObject"),e.n=7,n.sync();case 7:if(!u.isNullObject){e.n=8;break}return e.a(2,{success:!1,error:"시트에 데이터가 없습니다."});case 8:o.push(u);case 9:e.n=11;break;case 10:o.push(a.getRange(t.range));case 11:for(l=0,i=o;l<i.length;l++)i[l].load(["address","rowCount","columnCount"]);return e.n=12,n.sync();case 12:for(d=0;d<o.length;d++);for(m=t.borderType||"all",g=t.color||"#000000",f=t.style||"Continuous",p={continuous:"Continuous",dash:"Dash",dashdot:"DashDot",double:"Double",dot:"Dot",dashdotdot:"DashDotDot",slantdashdot:"SlantDashDot"}[f.toLowerCase()]||"Continuous",h=0,y=o;h<y.length;h++)if(b=y[h],"all"===m)for(k=0,v=["EdgeTop","EdgeBottom","EdgeLeft","EdgeRight","InsideVertical","InsideHorizontal"];k<v.length;k++){w=v[k];try{(C=b.format.borders.getItem(w)).style=p,C.color=g,C.weight="Thin"}catch(e){}}else if("inside"===m){try{(x=b.format.borders.getItem("InsideVertical")).style=p,x.color=g,x.weight="Thin"}catch(e){}try{(I=b.format.borders.getItem("InsideHorizontal")).style=p,I.color=g,I.weight="Thin"}catch(e){}}else(E={top:"EdgeTop",bottom:"EdgeBottom",left:"EdgeLeft",right:"EdgeRight"}[m.toLowerCase()])&&((S=b.format.borders.getItem(E)).style=p,S.color=g,S.weight="Thin");return e.n=13,n.sync();case 13:return e.a(2,{success:!0,message:"테두리 서식이 적용되었습니다."});case 14:return e.p=14,R=e.v,e.a(2,{success:!1,error:"테두리 서식 적용 중 오류 발생: ".concat(R.message)})}},e,null,[[2,4],[1,14]])}))).apply(this,arguments)}function oe(e,n){return se.apply(this,arguments)}function se(){return(se=s(r().m(function e(n,t){var a,o,s,c,u,l,i,d,m,g,f,p,h,y,b,k,v,w;return r().w(function(e){for(;;)switch(e.p=e.n){case 0:if(a=n.workbook.worksheets.getActiveWorksheet(),e.p=1,t.range){e.n=2;break}return e.a(2,{success:!1,error:"범위를 지정해주세요."});case 2:if(o=t.range,!/^[A-Z]+$/.test(o)&&!/^[A-Z]+:[A-Z]+$/.test(o)){e.n=5;break}if(s=a.getUsedRange()){e.n=3;break}return e.a(2,{success:!1,error:"워크시트에 데이터가 없습니다."});case 3:return s.load(["rowCount"]),e.n=4,n.sync();case 4:c=o.split(":")[0],o="".concat(c,"1:").concat(c).concat(s.rowCount);case 5:return(u=a.getRange(o)).load(["rowIndex","rowCount","columnIndex","values","address"]),e.n=6,n.sync();case 6:if(u.values){e.n=7;break}return e.a(2,{success:!1,error:"지정된 범위를 읽을 수 없습니다."});case 7:l=[],i=u.values,d=-1,m=i.length-1;case 8:if(!(m>=0)){e.n=10;break}if(null==(g=i[m][0])||""===g||"string"==typeof g&&""===g.trim()){e.n=9;break}return d=m,e.a(3,10);case 9:m--,e.n=8;break;case 10:if(-1!==d){e.n=11;break}return e.a(2,{success:!0,message:"모든 행이 비어있습니다."});case 11:for(f=0;f<=d;f++)(null==(p=i[f][0])||""===p||"string"==typeof p&&""===p.trim())&&l.push(u.rowIndex+f);if(0!==l.length){e.n=12;break}return e.a(2,{success:!0,message:"제거할 빈 행이 없습니다."});case 12:return l.sort(function(e,n){return n-e}),(h=a.getUsedRange()).load(["columnCount"]),e.n=13,n.sync();case 13:y=h.columnCount||100,b=0,k=l;case 14:if(!(b<k.length)){e.n=16;break}return v=k[b],a.getRangeByIndexes(v,0,1,y).delete(Excel.DeleteShiftDirection.up),e.n=15,n.sync();case 15:b++,e.n=14;break;case 16:return e.a(2,{success:!0,message:"".concat(l.length,"개의 빈 행이 제거되었습니다.")});case 17:return e.p=17,w=e.v,e.a(2,{success:!1,error:"빈 행 제거 중 오류 발생: ".concat(w.message)})}},e,null,[[1,17]])}))).apply(this,arguments)}function ce(e,n){return ue.apply(this,arguments)}function ue(){return(ue=s(r().m(function e(n,t){var a,o;return r().w(function(e){for(;;)switch(e.n){case 0:return a=n.workbook.worksheets.getActiveWorksheet(),(o=t.range?a.getRange(t.range):a.getUsedRange()).worksheet.autoFilter.apply(o),e.n=1,n.sync();case 1:return e.a(2,{success:!0,message:"필터가 적용되었습니다."})}},e)}))).apply(this,arguments)}function le(e,n){return ie.apply(this,arguments)}function ie(){return(ie=s(r().m(function e(n,t){var a,o,s,c;return r().w(function(e){for(;;)switch(e.n){case 0:return a=n.workbook.worksheets.getActiveWorksheet(),o=t.type||"row",s=t.position||1,c=t.count||1,"row"===o?a.getRangeByIndexes(s-1,0,c,1).insert(Excel.InsertShiftDirection.down):a.getRangeByIndexes(0,s-1,1,c).insert(Excel.InsertShiftDirection.right),e.n=1,n.sync();case 1:return e.a(2,{success:!0,message:"".concat(c,"개의 ").concat("row"===o?"행":"열","이 삽입되었습니다.")})}},e)}))).apply(this,arguments)}function de(e,n){return me.apply(this,arguments)}function me(){return(me=s(r().m(function e(n,t){var a,o,s,c,u,l,i,d,m,g,f,p,h;return r().w(function(e){for(;;)switch(e.n){case 0:if(a=n.workbook.worksheets.getActiveWorksheet(),!t.deleteType){e.n=14;break}h=t.deleteType,e.n="column"===h?1:"row"===h?4:"columns"===h?7:"rows"===h?10:13;break;case 1:if(t.column){e.n=2;break}return e.a(2,{success:!1,error:"삭제할 열을 지정해주세요."});case 2:for(o=0,s=0;s<t.column.length;s++)o=26*o+(t.column.charCodeAt(s)-64);return o--,a.getRangeByIndexes(0,o,1048576,1).delete(Excel.DeleteShiftDirection.left),e.n=3,n.sync();case 3:return e.a(2,{success:!0,message:"".concat(t.column,"열이 삭제되었습니다.")});case 4:if(t.row){e.n=5;break}return e.a(2,{success:!1,error:"삭제할 행을 지정해주세요."});case 5:return a.getRangeByIndexes(t.row-1,0,1,16384).delete(Excel.DeleteShiftDirection.up),e.n=6,n.sync();case 6:return e.a(2,{success:!0,message:"".concat(t.row,"행이 삭제되었습니다.")});case 7:if(t.startColumn&&t.endColumn){e.n=8;break}return e.a(2,{success:!1,error:"삭제할 열 범위를 지정해주세요."});case 8:for(c=0,u=0,l=0;l<t.startColumn.length;l++)c=26*c+(t.startColumn.charCodeAt(l)-64);for(i=0;i<t.endColumn.length;i++)u=26*u+(t.endColumn.charCodeAt(i)-64);return c--,u--,d=u-c+1,a.getRangeByIndexes(0,c,1048576,d).delete(Excel.DeleteShiftDirection.left),e.n=9,n.sync();case 9:return e.a(2,{success:!0,message:"".concat(t.startColumn,"-").concat(t.endColumn,"열이 삭제되었습니다.")});case 10:if(t.startRow&&t.endRow){e.n=11;break}return e.a(2,{success:!1,error:"삭제할 행 범위를 지정해주세요."});case 11:return m=t.endRow-t.startRow+1,a.getRangeByIndexes(t.startRow-1,0,m,16384).delete(Excel.DeleteShiftDirection.up),e.n=12,n.sync();case 12:return e.a(2,{success:!0,message:"".concat(t.startRow,"-").concat(t.endRow,"행이 삭제되었습니다.")});case 13:return e.a(2,{success:!1,error:"알 수 없는 삭제 유형입니다."});case 14:return g=t.type||"row",f=t.position||1,p=t.count||1,"row"===g?a.getRangeByIndexes(f-1,0,p,1).delete(Excel.DeleteShiftDirection.up):a.getRangeByIndexes(0,f-1,1,p).delete(Excel.DeleteShiftDirection.left),e.n=15,n.sync();case 15:return e.a(2,{success:!0,message:"".concat(p,"개의 ").concat("row"===g?"행":"열","이 삭제되었습니다.")})}},e)}))).apply(this,arguments)}function ge(e,n){return fe.apply(this,arguments)}function fe(){return(fe=s(r().m(function e(n,t){var a,o;return r().w(function(e){for(;;)switch(e.n){case 0:if(a=n.workbook.worksheets.getActiveWorksheet(),o=t.range?a.getRange(t.range):n.workbook.getSelectedRange(),t.formula){e.n=1;break}return e.a(2,{success:!1,error:"수식을 지정해주세요."});case 1:return o.formulas=[[t.formula]],e.n=2,n.sync();case 2:return e.a(2,{success:!0,message:"수식이 적용되었습니다."})}},e)}))).apply(this,arguments)}function pe(e,n){return he.apply(this,arguments)}function he(){return(he=s(r().m(function e(n,t){return r().w(function(e){for(;;)if(0===e.n)return e.a(2,{success:!1,error:"이 기능은 현재 구현 중입니다."})},e)}))).apply(this,arguments)}function ye(e,n){return be.apply(this,arguments)}function be(){return(be=s(r().m(function e(n,t){var a,o,s,c,u,l,i,d,m,g,f,p,h,y,b,k,v,w,C;return r().w(function(e){for(;;)switch(e.p=e.n){case 0:if(a=n.workbook.worksheets.getActiveWorksheet(),e.p=1,o=[],!t.range){e.n=11;break}if("all"!==t.range&&"전체"!==t.range){e.n=6;break}return(s=a.getUsedRangeOrNullObject()).load("isNullObject"),e.n=2,n.sync();case 2:if(!s.isNullObject){e.n=3;break}return e.a(2,{success:!0,message:"시트에 데이터가 없어 테두리를 제거할 필요가 없습니다."});case 3:return s.load(["rowCount","columnCount","rowIndex","columnIndex"]),e.n=4,n.sync();case 4:c=Math.min(s.rowCount+100,1048576),u=Math.min(s.columnCount+20,16384),o.push(a.getRangeByIndexes(0,0,c,u));case 5:e.n=10;break;case 6:if(!t.range.match(/^[A-Z]+:[A-Z]+$/)){e.n=9;break}if(l=a.getUsedRange()){e.n=7;break}return e.a(2,{success:!1,error:"데이터가 없습니다."});case 7:return l.load(["rowCount","columnCount"]),e.n=8,n.sync();case 8:i=t.range.split(":")[0],d=i.charCodeAt(0)-65,o.push(a.getRangeByIndexes(0,d,l.rowCount,1)),e.n=10;break;case 9:o.push(a.getRange(t.range));case 10:e.n=14;break;case 11:return e.p=11,(m=n.workbook.getSelectedRanges()).load(["areas","areaCount"]),e.n=12,n.sync();case 12:if(m.areaCount>1)for(g=0;g<m.areas.items.length;g++)o.push(m.areas.items[g]);else o.push(n.workbook.getSelectedRange());e.n=14;break;case 13:return e.p=13,e.v,e.a(2,{success:!1,error:"선택한 범위를 처리할 수 없습니다. 연속된 범위를 선택해주세요."});case 14:for(f=0,p=o;f<p.length;f++)p[f].load(["address","rowCount","columnCount"]);return e.n=15,n.sync();case 15:for(h=0;h<o.length;h++);y=t.borderType||"all",b=0,k=o;case 16:if(!(b<k.length)){e.n=24;break}if(v=k[b],"all"!==y){e.n=17;break}v.format.borders.getItem(Excel.BorderIndex.edgeLeft).style=Excel.BorderLineStyle.none,v.format.borders.getItem(Excel.BorderIndex.edgeRight).style=Excel.BorderLineStyle.none,v.format.borders.getItem(Excel.BorderIndex.edgeTop).style=Excel.BorderLineStyle.none,v.format.borders.getItem(Excel.BorderIndex.edgeBottom).style=Excel.BorderLineStyle.none,v.format.borders.getItem(Excel.BorderIndex.insideHorizontal).style=Excel.BorderLineStyle.none,v.format.borders.getItem(Excel.BorderIndex.insideVertical).style=Excel.BorderLineStyle.none,e.n=23;break;case 17:w=y,e.n="right"===w?18:"left"===w?19:"top"===w?20:"bottom"===w?21:22;break;case 18:return v.format.borders.getItem(Excel.BorderIndex.edgeRight).style=Excel.BorderLineStyle.none,e.a(3,23);case 19:return v.format.borders.getItem(Excel.BorderIndex.edgeLeft).style=Excel.BorderLineStyle.none,e.a(3,23);case 20:return v.format.borders.getItem(Excel.BorderIndex.edgeTop).style=Excel.BorderLineStyle.none,e.a(3,23);case 21:return v.format.borders.getItem(Excel.BorderIndex.edgeBottom).style=Excel.BorderLineStyle.none,e.a(3,23);case 22:return e.a(2,{success:!1,error:"알 수 없는 테두리 유형: ".concat(y)});case 23:b++,e.n=16;break;case 24:return e.n=25,n.sync();case 25:return e.a(2,{success:!0,message:"".concat("all"===y?"모든":y," 테두리가 제거되었습니다.")});case 26:return e.p=26,C=e.v,e.a(2,{success:!1,error:"테두리 제거 중 오류 발생: ".concat(C.message)})}},e,null,[[11,13],[1,26]])}))).apply(this,arguments)}function ke(e){return ve.apply(this,arguments)}function ve(){return ve=s(r().m(function e(n){var t;return r().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,Excel.run(function(){var e=s(r().m(function e(t){var a,o,s,c,u,l,i,d,m,g,f,p;return r().w(function(e){for(;;)switch(e.n){case 0:if(a=t.workbook.worksheets.getActiveWorksheet(),o=a.getUsedRange()){e.n=1;break}return e.a(2,{success:!1,error:"계산할 데이터가 없습니다."});case 1:return o.load(["values","rowCount","columnCount"]),e.n=2,t.sync();case 2:if(o.values&&!(o.rowCount<2)){e.n=3;break}return e.a(2,{success:!1,error:"계산할 데이터가 없습니다."});case 3:if(s=n.sourceColumn,c=-1,!/^[A-Z]+$/i.test(s)){e.n=4;break}c=s.toUpperCase().charCodeAt(0)-65,e.n=5;break;case 4:if(u=o.values[0],-1!==(c=u.findIndex(function(e){return e&&e.toString().toLowerCase()===s.toLowerCase()}))){e.n=5;break}return e.a(2,{success:!1,error:'열 "'.concat(s,'"을 찾을 수 없습니다.')});case 5:if(!(c>=o.columnCount)){e.n=6;break}return e.a(2,{success:!1,error:"열 인덱스가 범위를 벗어났습니다."});case 6:for(l=String.fromCharCode(65+c),i=1,d=1;d<o.rowCount;d++)null==(m=o.values[d][c])||""===m||isNaN(m)||(i=d+1);if(!(i<=1)){e.n=7;break}return e.a(2,{success:!1,error:"계산할 숫자 데이터가 없습니다."});case 7:return g="=STDEV.S(".concat(l,"2:").concat(l).concat(i,")"),f=i+1,p="".concat(l).concat(f),a.getRange(p).formulas=[[g]],e.n=8,t.sync();case 8:return e.a(2,{success:!0,message:"".concat(l,"열의 표준편차가 ").concat(p,"에 계산되었습니다.")})}},e)}));return function(n){return e.apply(this,arguments)}}());case 1:return e.a(2,e.v);case 2:return e.p=2,t=e.v,e.a(2,{success:!1,error:"표준편차 계산 중 오류: ".concat(t.message||t.toString())})}},e,null,[[0,2]])})),ve.apply(this,arguments)}function we(e){return Ce.apply(this,arguments)}function Ce(){return Ce=s(r().m(function e(n){var t;return r().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,Excel.run(function(){var e=s(r().m(function e(t){var a,o,s,c,u,l,i,d,m,g,f,p;return r().w(function(e){for(;;)switch(e.n){case 0:if(a=t.workbook.worksheets.getActiveWorksheet(),o=a.getUsedRange()){e.n=1;break}return e.a(2,{success:!1,error:"검색할 데이터가 없습니다."});case 1:return o.load(["values","rowCount","columnCount"]),e.n=2,t.sync();case 2:if(o.values&&!(o.rowCount<2)){e.n=3;break}return e.a(2,{success:!1,error:"검색할 데이터가 없습니다."});case 3:if(s=n.sourceColumn,c=-1,!/^[A-Z]+$/i.test(s)){e.n=4;break}c=s.toUpperCase().charCodeAt(0)-65,e.n=5;break;case 4:if(u=o.values[0],-1!==(c=u.findIndex(function(e){return e&&e.toString().toLowerCase()===s.toLowerCase()}))){e.n=5;break}return e.a(2,{success:!1,error:'열 "'.concat(s,'"을 찾을 수 없습니다.')});case 5:for(l=String.fromCharCode(65+c),i=1,d=1;d<o.rowCount;d++)null==(m=o.values[d][c])||""===m||isNaN(m)||(i=d+1);if(!(i<=1)){e.n=6;break}return e.a(2,{success:!1,error:"검색할 숫자 데이터가 없습니다."});case 6:return g="=MAX(".concat(l,"2:").concat(l).concat(i,")"),f=i+1,p="".concat(l).concat(f),a.getRange(p).formulas=[[g]],e.n=7,t.sync();case 7:return e.a(2,{success:!0,message:"".concat(l,"열의 최댓값이 ").concat(p,"에 표시되었습니다.")})}},e)}));return function(n){return e.apply(this,arguments)}}());case 1:return e.a(2,e.v);case 2:return e.p=2,t=e.v,e.a(2,{success:!1,error:"최댓값 계산 중 오류: ".concat(t.message||t.toString())})}},e,null,[[0,2]])})),Ce.apply(this,arguments)}function xe(e){return Ie.apply(this,arguments)}function Ie(){return Ie=s(r().m(function e(n){var t;return r().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,Excel.run(function(){var e=s(r().m(function e(t){var a,o,s,c,u,l,i,d,m,g,f,p,h;return r().w(function(e){for(;;)switch(e.n){case 0:if(a=t.workbook.worksheets.getActiveWorksheet(),o=a.getUsedRange()){e.n=1;break}return e.a(2,{success:!1,error:"처리할 데이터가 없습니다."});case 1:return o.load(["values","rowCount","columnCount"]),e.n=2,t.sync();case 2:if(o.values&&!(o.rowCount<2)){e.n=3;break}return e.a(2,{success:!1,error:"처리할 데이터가 없습니다."});case 3:if(s=n.sourceColumn,c=-1,!/^[A-Z]+$/i.test(s)){e.n=4;break}c=s.toUpperCase().charCodeAt(0)-65,e.n=5;break;case 4:if(u=o.values[0],-1!==(c=u.findIndex(function(e){return e&&e.toString().toLowerCase()===s.toLowerCase()}))){e.n=5;break}return e.a(2,{success:!1,error:'열 "'.concat(s,'"을 찾을 수 없습니다.')});case 5:for(l=String.fromCharCode(65+c),i=[],d=0;d<o.rowCount;d++)i.push(o.values[d][c]);for(m=new Set,(g=[]).push([i[0]]),f=0,p=1;p<i.length;p++)null!=(h=i[p])&&""!==h?m.has(h)?f++:(m.add(h),g.push([h])):g.push([""]);return a.getRange("".concat(l,":").concat(l)).clear(Excel.ClearApplyTo.contents),a.getRange("".concat(l,"1:").concat(l).concat(g.length)).values=g,e.n=6,t.sync();case 6:return e.a(2,{success:!0,message:"".concat(l,"열에서 ").concat(f,"개의 중복값이 제거되었습니다.")})}},e)}));return function(n){return e.apply(this,arguments)}}());case 1:return e.a(2,e.v);case 2:return e.p=2,t=e.v,e.a(2,{success:!1,error:"중복값 제거 중 오류: ".concat(t.message||t.toString())})}},e,null,[[0,2]])})),Ie.apply(this,arguments)}}()}();
//# sourceMappingURL=taskpane.js.map