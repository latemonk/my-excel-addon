/*! For license information please see taskpane.js.LICENSE.txt */
!function(){var e={58394:function(e,n,t){"use strict";e.exports=t.p+"cedaf607fc3782e05ca5.css"}},n={};function t(r){var o=n[r];if(void 0!==o)return o.exports;var a=n[r]={exports:{}};return e[r](a,a.exports,t),a.exports}t.m=e,t.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},function(){var e;t.g.importScripts&&(e=t.g.location+"");var n=t.g.document;if(!e&&n&&(n.currentScript&&"SCRIPT"===n.currentScript.tagName.toUpperCase()&&(e=n.currentScript.src),!e)){var r=n.getElementsByTagName("script");if(r.length)for(var o=r.length-1;o>-1&&(!e||!/^http(s?):/.test(e));)e=r[o--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),t.p=e}(),t.b=document.baseURI||self.location.href,function(){"use strict";new URL(t(58394),t.b)}(),function(){function e(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return n(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var o=0,a=function(){};return{s:a,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,s=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){u=!0,c=e},f:function(){try{s||null==r.return||r.return()}finally{if(u)throw c}}}}function n(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=Array(n);t<n;t++)r[t]=e[t];return r}function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(e)}function r(){var e,n,t="function"==typeof Symbol?Symbol:{},a=t.iterator||"@@iterator",c=t.toStringTag||"@@toStringTag";function s(t,r,a,c){var s=r&&r.prototype instanceof l?r:l,i=Object.create(s.prototype);return o(i,"_invoke",function(t,r,o){var a,c,s,l=0,i=o||[],d=!1,g={p:0,n:0,v:e,a:m,f:m.bind(e,4),d:function(n,t){return a=n,c=0,s=e,g.n=t,u}};function m(t,r){for(c=t,s=r,n=0;!d&&l&&!o&&n<i.length;n++){var o,a=i[n],m=g.p,f=a[2];t>3?(o=f===r)&&(s=a[(c=a[4])?5:(c=3,3)],a[4]=a[5]=e):a[0]<=m&&((o=t<2&&m<a[1])?(c=0,g.v=r,g.n=a[1]):m<f&&(o=t<3||a[0]>r||r>f)&&(a[4]=t,a[5]=r,g.n=f,c=0))}if(o||t>1)return u;throw d=!0,r}return function(o,i,f){if(l>1)throw TypeError("Generator is already running");for(d&&1===i&&m(i,f),c=i,s=f;(n=c<2?e:s)||!d;){a||(c?c<3?(c>1&&(g.n=-1),m(c,s)):g.n=s:g.v=s);try{if(l=2,a){if(c||(o="next"),n=a[o]){if(!(n=n.call(a,s)))throw TypeError("iterator result is not an object");if(!n.done)return n;s=n.value,c<2&&(c=0)}else 1===c&&(n=a.return)&&n.call(a),c<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),c=1);a=e}else if((n=(d=g.n<0)?s:t.call(r,g))!==u)break}catch(n){a=e,c=1,s=n}finally{l=1}}return{value:n,done:d}}}(t,a,c),!0),i}var u={};function l(){}function i(){}function d(){}n=Object.getPrototypeOf;var g=[][a]?n(n([][a]())):(o(n={},a,function(){return this}),n),m=d.prototype=l.prototype=Object.create(g);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,o(e,c,"GeneratorFunction")),e.prototype=Object.create(m),e}return i.prototype=d,o(m,"constructor",d),o(d,"constructor",i),i.displayName="GeneratorFunction",o(d,c,"GeneratorFunction"),o(m),o(m,c,"Generator"),o(m,a,function(){return this}),o(m,"toString",function(){return"[object Generator]"}),(r=function(){return{w:s,m:f}})()}function o(e,n,t,r){var a=Object.defineProperty;try{a({},"",{})}catch(e){a=0}o=function(e,n,t,r){function c(n,t){o(e,n,function(e){return this._invoke(n,t,e)})}n?a?a(e,n,{value:t,enumerable:!r,configurable:!r,writable:!r}):e[n]=t:(c("next",0),c("throw",1),c("return",2))},o(e,n,t,r)}function a(e,n,t,r,o,a,c){try{var s=e[a](c),u=s.value}catch(e){return void t(e)}s.done?n(u):Promise.resolve(u).then(r,o)}function c(e){return function(){var n=this,t=arguments;return new Promise(function(r,o){var c=e.apply(n,t);function s(e){a(c,r,o,s,u,"next",e)}function u(e){a(c,r,o,s,u,"throw",e)}s(void 0)})}}var s=null,u=!1,l="https://excel-addon-backend.vercel.app/api/openai-proxy-debug";function i(){var e=window.SpeechRecognition||window.webkitSpeechRecognition;return e?((s=new e).lang="ko-KR",s.continuous=!1,s.interimResults=!0,s.maxAlternatives=1,s.onstart=function(){u=!0,document.getElementById("voiceButton").classList.add("listening"),document.getElementById("voiceStatus").textContent="듣고 있습니다... 말씀해주세요",document.getElementById("voiceStatus").classList.add("listening")},s.onresult=function(e){var n=e.results[0][0].transcript;document.getElementById("commandInput").value=n,e.results[0].isFinal?document.getElementById("voiceStatus").textContent="음성 인식 완료":document.getElementById("voiceStatus").textContent="인식중: "+n},s.onerror=function(e){u=!1,document.getElementById("voiceButton").classList.remove("listening"),document.getElementById("voiceStatus").classList.remove("listening");var n="음성 인식 오류";switch(e.error){case"no-speech":n="음성이 감지되지 않았습니다.";break;case"audio-capture":n="마이크를 찾을 수 없습니다.";break;case"not-allowed":n="마이크 권한이 거부되었습니다.";break;case"network":n="네트워크 오류가 발생했습니다."}document.getElementById("voiceStatus").textContent=n,W(n,"error")},s.onend=function(){u=!1,document.getElementById("voiceButton").classList.remove("listening"),document.getElementById("voiceStatus").classList.remove("listening"),document.getElementById("commandInput").value.trim()?(document.getElementById("voiceStatus").textContent="음성 인식 완료. 실행 버튼을 눌러주세요.",document.getElementById("executeButton").focus()):document.getElementById("voiceStatus").textContent="음성 인식 준비"},s):(W("음성 인식이 지원되지 않는 브라우저입니다.","error"),document.getElementById("voiceButton").disabled=!0,document.getElementById("voiceStatus").textContent="음성 인식 미지원",null)}function d(){(s||(s=i()))&&(u?s.stop():s.start())}Office.onReady(function(e){e.host===Office.HostType.Excel&&(function(){z.apply(this,arguments)}(),document.getElementById("executeButton").onclick=m,document.getElementById("clearButton").onclick=D,document.getElementById("voiceButton").onclick=d,document.getElementById("settingsButton").onclick=G,document.querySelectorAll(".example-item").forEach(function(e){e.onclick=function(){var e;e=this.getAttribute("data-command"),document.getElementById("commandInput").value=e,document.getElementById("commandInput").focus()}}),document.getElementById("commandInput").addEventListener("keydown",function(e){"Enter"!==e.key||e.shiftKey||(e.preventDefault(),m())}),i())});var g=!1;function m(){return f.apply(this,arguments)}function f(){return f=c(r().m(function e(){var n,t,o,a;return r().w(function(e){for(;;)switch(e.p=e.n){case 0:if(!g){e.n=1;break}return console.log("Command already executing, ignoring duplicate call"),e.a(2);case 1:if(n=document.getElementById("commandInput").value.trim()){e.n=2;break}return W("명령어를 입력해주세요.","error"),e.a(2);case 2:return g=!0,t=document.getElementById("executeButton"),o='<span class="ms-Button-label">실행</span>',t.disabled=!0,t.innerHTML='<span class="loading"></span><span>처리중...</span>',W("명령을 처리하고 있습니다...","info"),e.p=3,e.n=4,Excel.run(function(){var e=c(r().m(function e(a){var c,s,u,l,i,d,g,m;return r().w(function(e){for(;;)switch(e.n){case 0:return console.log("Starting Excel.run for command execution"),c=a.workbook.worksheets.getActiveWorksheet(),s=a.workbook.getSelectedRange(),c.load("name"),s.load(["address","rowIndex","columnIndex","rowCount","columnCount"]),(u=c.getUsedRange()).load(["rowCount","columnCount","values"]),e.n=1,a.sync();case 1:if(l={sheetName:c.name,activeRange:{address:s.address,row:s.rowIndex+1,column:s.columnIndex+1,numRows:s.rowCount,numColumns:s.columnCount},lastRow:u?u.rowCount:0,lastColumn:u?u.columnCount:0,headers:[],dataRange:u?u.values:[],isLargeSheet:u&&u.rowCount>1e3},u&&u.rowCount>0)for(i=u.values[0],d=0;d<i.length;d++)l.headers.push({column:d+1,columnLetter:_(d),label:i[d]?i[d].toString():""});return e.n=2,p(n,l);case 2:if((g=e.v).success){e.n=3;break}throw new Error(g.error);case 3:return console.log("Executing interpreted command..."),e.n=4,h(a,g.data);case 4:m=e.v,console.log("Command execution result:",m),t.disabled=!1,t.innerHTML=o,m.success?(console.log("Operation completed successfully:",m),W(m.message||"명령이 성공적으로 실행되었습니다.","success"),setTimeout(function(){document.getElementById("commandInput").value=""},1e3)):(console.error("Operation failed:",m),W(m.error||"명령 실행에 실패했습니다.","error")),console.log("Excel.run completing...");case 5:return e.a(2)}},e)}));return function(n){return e.apply(this,arguments)}}());case 4:console.log("Excel.run completed"),e.n=6;break;case 5:e.p=5,a=e.v,console.error("Error in executeCommand:",a),console.error("Error stack:",a.stack),t.disabled=!1,t.innerHTML=o,W("오류가 발생했습니다: "+a.message,"error");case 6:return e.p=6,g=!1,e.f(6);case 7:return e.a(2)}},e,null,[[3,5,6,7]])})),f.apply(this,arguments)}function p(e,n){return y.apply(this,arguments)}function y(){return(y=c(r().m(function e(n,t){var o,a,c;return r().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,fetch(l,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({command:n,sheetContext:t})});case 1:if((o=e.v).ok){e.n=3;break}return e.n=2,o.json();case 2:return a=e.v,e.a(2,{success:!1,error:a.error||"서버 오류 (".concat(o.status,")")});case 3:return e.n=4,o.json();case 4:return e.a(2,e.v);case 5:return e.p=5,c=e.v,console.error("Proxy API Error:",c),e.a(2,{success:!1,error:"API 요청 오류: ".concat(c.toString())})}},e,null,[[0,5]])}))).apply(this,arguments)}function h(e,n){return v.apply(this,arguments)}function v(){return(v=c(r().m(function e(n,t){var o,a,c,s;return r().w(function(e){for(;;)switch(e.p=e.n){case 0:o=t.operation,a=t.parameters||{},console.log("[".concat((new Date).toISOString(),"] Executing operation: ").concat(o," with params:"),a),e.p=1,c=o,e.n="merge"===c?2:"sum"===c?4:"average"===c?6:"count"===c?8:"format"===c?10:"sort"===c?12:"filter"===c?14:"insert"===c?16:"delete"===c?18:"formula"===c?20:"chart"===c?22:"conditional_format"===c?24:"translate"===c?26:"compress"===c?28:"retry_translation"===c?30:"remove_border"===c?32:34;break;case 2:return e.n=3,w(n,a);case 3:case 5:case 7:case 9:case 11:case 13:case 15:case 17:case 19:case 21:case 23:case 25:case 27:case 29:case 31:case 33:return e.a(2,e.v);case 4:return e.n=5,k(n,a);case 6:return e.n=7,C(n,a);case 8:return e.n=9,E(n,a);case 10:return e.n=11,T(n,a);case 12:return e.n=13,B(n,a);case 14:return e.n=15,J(n,a);case 16:return e.n=17,q(n,a);case 18:return e.n=19,X(n,a);case 20:return e.n=21,Q(n,a);case 22:return e.n=23,L(n,a);case 24:return e.n=25,U(n,a);case 26:return e.n=27,j(n,a);case 28:return e.n=29,H(n,a);case 30:return e.n=31,ne(n,a);case 32:return e.n=33,re(n,a);case 34:return e.a(2,{success:!1,error:"알 수 없는 작업: ".concat(o)});case 35:e.n=37;break;case 36:return e.p=36,s=e.v,console.error("Error in executeInterpretedCommand:",s),e.a(2,{success:!1,error:"작업 실행 중 오류: ".concat(s.message||s.toString())});case 37:return e.a(2)}},e,null,[[1,36]])}))).apply(this,arguments)}function w(e,n){return b.apply(this,arguments)}function b(){return(b=c(r().m(function e(n,t){var o,a,c;return r().w(function(e){for(;;)switch(e.n){case 0:return console.log("executeMerge started with params:",t),o=n.workbook.worksheets.getActiveWorksheet(),a=t.range?o.getRange(t.range):n.workbook.getSelectedRange(),console.log("Loading range address..."),a.load("address"),e.n=1,n.sync();case 1:return console.log("Range address loaded:",a.address),c=a.address,console.log("Merging range..."),a.merge(),e.n=2,n.sync();case 2:return console.log("Merge completed successfully"),e.a(2,{success:!0,message:"".concat(c," 범위가 병합되었습니다.")})}},e)}))).apply(this,arguments)}function k(e,n){return x.apply(this,arguments)}function x(){return(x=c(r().m(function e(n,t){var o,a,c,s,u,l,i,d,g,m,f,p,y,h,v,w,b,k;return r().w(function(e){for(;;)switch(e.n){case 0:if(o=n.workbook.worksheets.getActiveWorksheet(),!t.columnName&&"column"!==t.sumType){e.n=9;break}return console.log("Sum by column name:",t.columnName),(a=o.getUsedRange()).load(["values","rowCount","columnCount"]),e.n=1,n.sync();case 1:if(a&&0!==a.rowCount){e.n=2;break}return e.a(2,{success:!1,error:"시트에 데이터가 없습니다."});case 2:c=a.values[0],s=-1,u="",l=0;case 3:if(!(l<c.length)){e.n=5;break}if(!c[l]||c[l].toString().toLowerCase()!==(t.columnName||"").toLowerCase()){e.n=4;break}return s=l,u=_(l),e.a(3,5);case 4:l++,e.n=3;break;case 5:if(-1!==s){e.n=6;break}return e.a(2,{success:!1,error:'"'.concat(t.columnName,'" 열을 찾을 수 없습니다.')});case 6:for(i=1,d=1;d<a.rowCount;d++)null!==a.values[d][s]&&void 0!==a.values[d][s]&&""!==a.values[d][s]&&(i=d+1);return g="".concat(u,"2:").concat(u).concat(i),m=o.getCell(i,s),console.log("Summing range: ".concat(g,", placing result in row ").concat(i+1)),m.formulas=[["=SUM(".concat(g,")")]],e.n=7,n.sync();case 7:return m.load(["values","address"]),e.n=8,n.sync();case 8:return e.a(2,{success:!0,message:"".concat(t.columnName," 열의 합계를 ").concat(m.address,"에 계산했습니다: ").concat(M(m.values[0][0])),value:m.values[0][0]});case 9:return(f=t.sourceRange?o.getRange(t.sourceRange):n.workbook.getSelectedRange()).load(["columnIndex","rowIndex","rowCount","address"]),e.n=10,n.sync();case 10:if(!0!==t.addNewRow){e.n=13;break}return p=f.columnIndex,y=f.rowIndex+f.rowCount,(h=o.getCell(y,p)).formulas=[["=SUM(".concat(f.address,")")]],e.n=11,n.sync();case 11:return h.load(["values","address"]),e.n=12,n.sync();case 12:return e.a(2,{success:!0,message:"".concat(h.address,"에 합계를 계산했습니다: ").concat(M(h.values[0][0])),value:h.values[0][0]});case 13:if(!t.targetCell){e.n=16;break}return(v=o.getRange(t.targetCell)).formulas=[["=SUM(".concat(f.address,")")]],e.n=14,n.sync();case 14:return v.load(["values","address"]),e.n=15,n.sync();case 15:return e.a(2,{success:!0,message:"".concat(v.address,"에 합계를 계산했습니다: ").concat(M(v.values[0][0])),value:v.values[0][0]});case 16:return w=f.columnIndex,b=f.rowIndex+f.rowCount,(k=o.getCell(b,w)).formulas=[["=SUM(".concat(f.address,")")]],e.n=17,n.sync();case 17:return k.load(["values","address"]),e.n=18,n.sync();case 18:return e.a(2,{success:!0,message:"".concat(k.address,"에 합계를 계산했습니다: ").concat(M(k.values[0][0])),value:k.values[0][0]});case 19:return e.a(2)}},e)}))).apply(this,arguments)}function C(e,n){return I.apply(this,arguments)}function I(){return(I=c(r().m(function e(n,t){var o,a,c,s,u,l,i,d,g,m,f,p,y,h;return r().w(function(e){for(;;)switch(e.p=e.n){case 0:if(o=n.workbook.worksheets.getActiveWorksheet(),c="",e.p=1,"column"!==t.averageType){e.n=13;break}if(!t.column){e.n=7;break}if(s=o.getUsedRange()){e.n=2;break}return e.a(2,{success:!1,error:"데이터가 없습니다."});case 2:return s.load(["rowCount","columnCount"]),e.n=3,n.sync();case 3:if(!((u=t.column.charCodeAt(0)-65)<0||u>=s.columnCount)){e.n=4;break}return e.a(2,{success:!1,error:"유효하지 않은 열입니다."});case 4:if(!(s.rowCount>1)){e.n=5;break}a=o.getRangeByIndexes(1,u,s.rowCount-1,1),c="".concat(t.column,"열"),e.n=6;break;case 5:return e.a(2,{success:!1,error:"평균을 계산할 데이터가 없습니다."});case 6:e.n=12;break;case 7:if(!t.columnName){e.n=12;break}return e.n=8,getHeaders(n);case 8:if(l=e.v,i=l.find(function(e){return e.label===t.columnName})){e.n=9;break}return e.a(2,{success:!1,error:'"'.concat(t.columnName,'" 열을 찾을 수 없습니다.')});case 9:return(d=o.getUsedRange()).load(["rowCount"]),e.n=10,n.sync();case 10:if(!(d.rowCount>1)){e.n=11;break}a=o.getRangeByIndexes(1,i.column-1,d.rowCount-1,1),c='"'.concat(t.columnName,'" 열'),e.n=12;break;case 11:return e.a(2,{success:!1,error:"평균을 계산할 데이터가 없습니다."});case 12:e.n=18;break;case 13:if("row"!==t.averageType){e.n=17;break}if(g=o.getUsedRange()){e.n=14;break}return e.a(2,{success:!1,error:"데이터가 없습니다."});case 14:return g.load(["rowCount","columnCount"]),e.n=15,n.sync();case 15:if(!((m=t.row-1)<0||m>=g.rowCount)){e.n=16;break}return e.a(2,{success:!1,error:"유효하지 않은 행입니다."});case 16:a=o.getRangeByIndexes(m,0,1,g.columnCount),c="".concat(t.row,"행"),e.n=18;break;case 17:t.sourceRange?(a=o.getRange(t.sourceRange),c=t.sourceRange):(a=n.workbook.getSelectedRange(),c="선택한 범위");case 18:return a.load(["columnIndex","rowIndex","rowCount","columnCount","address"]),e.n=19,n.sync();case 19:return t.targetCell?f=o.getRange(t.targetCell):"row"===t.averageType?(p=a.columnIndex+a.columnCount,f=o.getCell(a.rowIndex,p)):(y=a.rowIndex+a.rowCount,f=o.getCell(y,a.columnIndex)),f.formulas=[["=AVERAGE(".concat(a.address,")")]],f.numberFormat=[["#,##0.00"]],e.n=20,n.sync();case 20:return f.load(["values","address"]),e.n=21,n.sync();case 21:return e.a(2,{success:!0,message:"".concat(c,"의 평균을 ").concat(f.address,"에 계산했습니다: ").concat(M(f.values[0][0])),value:f.values[0][0]});case 22:return e.p=22,h=e.v,console.error("Error in executeAverage:",h),e.a(2,{success:!1,error:"평균 계산 중 오류 발생: ".concat(h.message)})}},e,null,[[1,22]])}))).apply(this,arguments)}function E(e,n){return S.apply(this,arguments)}function S(){return(S=c(r().m(function e(n,t){var o,a,c,s,u,l,i,d;return r().w(function(e){for(;;)switch(e.n){case 0:return o=n.workbook.worksheets.getActiveWorksheet(),(a=t.sourceRange?o.getRange(t.sourceRange):n.workbook.getSelectedRange()).load(["address"]),e.n=1,n.sync();case 1:if("countif"===t.countType&&void 0!==t.condition?(s="contains"===t.operator?'"*'.concat(t.condition,'*"'):"equals"===t.operator?"string"==typeof t.condition?'"'.concat(t.condition,'"'):t.condition:t.operator&&[">","<",">=","<=","<>"].includes(t.operator)?'"'.concat(t.operator).concat(t.condition,'"'):"string"==typeof t.condition?'"*'.concat(t.condition,'*"'):t.condition,c="=COUNTIF(".concat(a.address,", ").concat(s,")")):c="counta"===t.countType?"=COUNTA(".concat(a.address,")"):"=COUNT(".concat(a.address,")"),!t.targetCell){e.n=2;break}u=o.getRange(t.targetCell),e.n=4;break;case 2:return l=o.getUsedRange(),e.n=3,n.sync();case 3:i=l?l.rowCount:1,d=l?l.columnCount:1,u=o.getCell(i,d);case 4:return u.formulas=[[c]],e.n=5,n.sync();case 5:return u.load("values"),e.n=6,n.sync();case 6:return e.a(2,{success:!0,message:"countif"===t.countType?'"'.concat(t.condition,'"을(를) 포함하는 셀의 개수: ').concat(M(u.values[0][0]),"개"):"개수를 계산했습니다: ".concat(M(u.values[0][0]),"개"),value:u.values[0][0]})}},e)}))).apply(this,arguments)}function T(e,n){return R.apply(this,arguments)}function R(){return(R=c(r().m(function e(n,t){var o,a,c;return r().w(function(e){for(;;)switch(e.n){case 0:return console.log("executeFormat called with params:",t),o=n.workbook.worksheets.getActiveWorksheet(),(a=t.range?o.getRange(t.range):n.workbook.getSelectedRange()).load("format"),e.n=1,n.sync();case 1:return void 0!==t.bold&&(a.format.font.bold=t.bold),void 0!==t.italic&&(a.format.font.italic=t.italic),t.fontSize&&(a.format.font.size=t.fontSize),t.fontColor&&(a.format.font.color=t.fontColor),t.backgroundColor&&(a.format.fill.color=t.backgroundColor),t.horizontalAlignment&&(a.format.horizontalAlignment="left"===t.horizontalAlignment?"Left":"center"===t.horizontalAlignment?"Center":"right"===t.horizontalAlignment?"Right":"General"),t.numberFormat&&("number"===(c=t.numberFormat)||"숫자"===c?c="#,##0":"currency"===c||"원화"===c||"won"===c||"통화"===c?c="₩#,##0":"currency_decimal"===c||"원화_소수"===c?c="₩#,##0.00":"percentage"===c||"퍼센트"===c||"백분율"===c?c="0%":"percentage_decimal"===c||"퍼센트_소수"===c?c="0.00%":"date"===c||"날짜"===c?c="yyyy-mm-dd":"time"===c||"시간"===c?c="hh:mm:ss":"text"===c||"텍스트"===c?c="@":"general"!==c&&"일반"!==c||(c="General"),a.numberFormat=c),e.n=2,n.sync();case 2:return e.a(2,{success:!0,message:"서식이 적용되었습니다."})}},e)}))).apply(this,arguments)}function B(e,n){return A.apply(this,arguments)}function A(){return(A=c(r().m(function e(n,t){var o,a,c,s,u;return r().w(function(e){for(;;)switch(e.n){case 0:return o=n.workbook.worksheets.getActiveWorksheet(),a=t.range?o.getRange(t.range):o.getUsedRange(),c=t.column||1,s=void 0===t.ascending||t.ascending,a.sort.apply([{key:c-1,ascending:s}]),e.n=1,n.sync();case 1:return u=_(c-1),e.a(2,{success:!0,message:"".concat(u,"열 기준으로 ").concat(s?"오름차순":"내림차순"," 정렬되었습니다.")})}},e)}))).apply(this,arguments)}function L(e,n){return O.apply(this,arguments)}function O(){return(O=c(r().m(function e(n,t){var o,a,c,s;return r().w(function(e){for(;;)switch(e.n){case 0:return o=n.workbook.worksheets.getActiveWorksheet(),a=t.range?o.getRange(t.range):n.workbook.getSelectedRange(),console.log("Creating chart with params:",t),a.load(["address","values"]),e.n=1,n.sync();case 1:return console.log("Chart data range:",a.address),c="bar"===t.chartType||"막대"===t.chartType?Excel.ChartType.columnClustered:"line"===t.chartType||"선"===t.chartType?Excel.ChartType.line:"pie"===t.chartType||"원"===t.chartType?Excel.ChartType.pie:"scatter"===t.chartType||"분산형"===t.chartType?Excel.ChartType.xyscatter:Excel.ChartType.columnClustered,(s=o.charts.add(c,a,Excel.ChartSeriesBy.auto)).title.text=t.title||"차트",s.height=300,s.width=400,s.left=t.offsetX||100,s.top=t.offsetY||100,s.legend.position=Excel.ChartLegendPosition.bottom,s.legend.visible=!0,e.n=2,n.sync();case 2:return e.a(2,{success:!0,message:"".concat(a.address," 범위로 ").concat(t.chartType||"막대"," 차트가 생성되었습니다.")})}},e)}))).apply(this,arguments)}function U(e,n){return N.apply(this,arguments)}function N(){return(N=c(r().m(function e(n,t){var o,a,c;return r().w(function(e){for(;;)switch(e.n){case 0:return o=n.workbook.worksheets.getActiveWorksheet(),a=t.range?o.getRange(t.range):o.getUsedRange(),console.log("Applying conditional format with params:",t),c=a.conditionalFormats.add(Excel.ConditionalFormatType.cellValue),"greater_than"===t.condition&&void 0!==t.value?c.cellValue.rule={formula1:t.value.toString(),operator:Excel.ConditionalCellValueOperator.greaterThan}:"less_than"===t.condition&&void 0!==t.value?c.cellValue.rule={formula1:t.value.toString(),operator:Excel.ConditionalCellValueOperator.lessThan}:"equal_to"===t.condition&&void 0!==t.value?c.cellValue.rule={formula1:t.value.toString(),operator:Excel.ConditionalCellValueOperator.equalTo}:"text_contains"===t.condition&&void 0!==t.value?c.cellValue.rule={formula1:t.value.toString(),operator:Excel.ConditionalCellValueOperator.containsText}:c.cellValue.rule={formula1:(t.value||0).toString(),operator:Excel.ConditionalCellValueOperator.greaterThan},c.cellValue.format.fill.color=t.backgroundColor||"#00FF00",t.fontColor&&(c.cellValue.format.font.color=t.fontColor),t.bold&&(c.cellValue.format.font.bold=!0),e.n=1,n.sync();case 1:return e.a(2,{success:!0,message:"조건부 서식이 적용되었습니다. (".concat(t.condition," ").concat(t.value||"",")")})}},e)}))).apply(this,arguments)}function j(e,n){return F.apply(this,arguments)}function F(){return(F=c(r().m(function n(o,a){var c,s,u,l,i,d,g,m,f,p,y,h,v,w,b,k,x,C,I,E,S,T,R,B,A,L,O,U,N,j,F,P,_,M,D,G,z,H,$;return r().w(function(n){for(;;)switch(n.n){case 0:if(console.log("executeTranslate called with params:",a),c=o.workbook.worksheets.getActiveWorksheet(),a.targetLanguage){n.n=1;break}return n.a(2,{success:!1,error:"대상 언어를 지정해주세요."});case 1:if(!a.sourceRange){n.n=8;break}if(!a.sourceRange.match(/^[A-Z]+:[A-Z]+$/)){n.n=6;break}if(console.log("Handling column range:",a.sourceRange),l=c.getUsedRange()){n.n=2;break}return n.a(2,{success:!1,error:"번역할 데이터가 없습니다."});case 2:return l.load(["rowCount","columnCount"]),n.n=3,o.sync();case 3:if(console.log("Used range:",{rowCount:l.rowCount,columnCount:l.columnCount}),i=a.sourceRange.split(":")[0],d=i.charCodeAt(0)-65,!(l.rowCount>1)){n.n=4;break}s=c.getRangeByIndexes(1,d,l.rowCount-1,1),n.n=5;break;case 4:return n.a(2,{success:!1,error:"번역할 데이터가 없습니다."});case 5:a.targetRange&&a.targetRange.match(/^[A-Z]+:[A-Z]+$/)?(g=a.targetRange.split(":")[0],u=g.charCodeAt(0)-65,console.log("Target column calculation:",{targetRange:a.targetRange,targetColumnLetter:g,targetColumnIndex:u})):(u=d+1,console.log("Using next column as target:",{sourceColumnIndex:d,targetColumnIndex:u})),n.n=7;break;case 6:s=c.getRange(a.sourceRange);case 7:n.n=13;break;case 8:if(!a.sourceColumn){n.n=12;break}return m=a.sourceColumn.charCodeAt(0)-65,(f=c.getUsedRange()).load(["rowCount"]),n.n=9,o.sync();case 9:if(!(f.rowCount>1)){n.n=10;break}s=c.getRangeByIndexes(1,m,f.rowCount-1,1),n.n=11;break;case 10:return n.a(2,{success:!1,error:"번역할 데이터가 없습니다."});case 11:u="next"===a.targetColumn?m+1:a.targetColumn?a.targetColumn.charCodeAt(0)-65:m+1,n.n=13;break;case 12:return n.a(2,{success:!1,error:"번역할 열을 지정해주세요."});case 13:return s.load(["values","rowIndex","columnIndex","rowCount"]),n.n=14,o.sync();case 14:if(console.log("Source range loaded:",{rowIndex:s.rowIndex,columnIndex:s.columnIndex,rowCount:s.rowCount,values:s.values?"".concat(s.values.length," rows"):"null"}),(p=s.values)&&0!==p.length){n.n=15;break}return n.a(2,{success:!1,error:"번역할 데이터가 없습니다."});case 15:y=[],h=20,v=0;case 16:if(!(v<p.length)){n.n=21;break}if(w=p.slice(v,Math.min(v+h,p.length)),!((b=w.map(function(e){return e[0]}).filter(function(e){return e})).length>0)){n.n=18;break}return n.n=17,V(b,a.targetLanguage,a.sourceLanguage);case 17:if((k=n.v)&&Array.isArray(k))for(console.log("Processing translation batch:",{batchLength:w.length,translatedBatchLength:k.length,sampleTranslations:k.slice(0,3),firstTranslation:k[0],translationType:t(k[0]),rawData:JSON.stringify(k.slice(0,3))}),C=0,I=0;I<w.length;I++)w[I][0]?((E=k[C]||"")&&""!==E.trim()?y.push([{text:E,isError:!1}]):y.push([{text:"번역 실패",isError:!0}]),I<3&&console.log("Translation ".concat(I,': "').concat(w[I][0],'" -> "').concat(E,'"')),C++):y.push([{text:"",isError:!1}]);else for(console.error("Invalid translation batch received:",k),x=0;x<w.length;x++)w[x][0]?y.push([{text:"번역 실패",isError:!0}]):y.push([{text:"",isError:!1}]);n.n=19;break;case 18:for(S=0;S<w.length;S++)y.push([{text:"",isError:!1}]);case 19:v%100==0&&v>0&&W("번역 중... ".concat(Math.round(v/p.length*100),"%"),"info");case 20:v+=h,n.n=16;break;case 21:for(console.log("Writing translations to target column:",{rowIndex:s.rowIndex,targetColumnIndex:u||s.columnIndex+1,translationsCount:y.length,sampleTranslations:y.slice(0,3).map(function(e){return e[0]})}),console.log("First 5 translations raw:",JSON.stringify(y.slice(0,5))),console.log("Translation content check:",{first:y[0]?y[0][0]:"null",second:y[1]?y[1][0]:"null",third:y[2]?y[2][0]:"null",isEmpty:y[0]&&""===y[0][0]}),console.log("DEBUG: Comparing source and translations:"),T=0;T<Math.min(5,y.length);T++)console.log("  [".concat(T,'] Source: "').concat(p[T][0],'" -> Translation: "').concat(y[T][0],'"'));return(R=c.getRangeByIndexes(s.rowIndex,u||s.columnIndex+1,y.length,1)).load(["address","values"]),n.n=22,o.sync();case 22:return console.log("Target range address:",R.address),console.log("Existing target values (first 3):",R.values.slice(0,3)),R.clear(Excel.ClearApplyTo.contents),n.n=23,o.sync();case 23:for(console.log("Target range cleared"),console.log("Setting target range values:",{translationsLength:y.length,firstTranslation:y[0],isArray:Array.isArray(y),is2DArray:Array.isArray(y[0])}),B=[],A=[],L=0;L<y.length;L++)(O=y[L][0])&&"object"===t(O)?(B.push([O.text]),O.isError&&A.push(L)):B.push([String(O||"")]);return console.log("String translations (first 3):",B.slice(0,3)),console.log("Error rows:",A.length,"rows marked as errors"),R.values=B,n.n=24,o.sync();case 24:if(!(A.length>0)){n.n=25;break}U=e(A);try{for(U.s();!(N=U.n()).done;)j=N.value,(F=R.getCell(j,0)).format.fill.color="#FFE6E6",F.format.font.color="#CC0000",F.format.font.bold=!0}catch(e){U.e(e)}finally{U.f()}return n.n=25,o.sync();case 25:return console.log("Translations written to Excel with error styling applied"),R.load(["values","text","valueTypes"]),n.n=26,o.sync();case 26:if(console.log("Verification - Target range:",{address:R.address,values:R.values.slice(0,3),text:R.text.slice(0,3),valueTypes:R.valueTypes.slice(0,3),actualFirstValue:R.values[0]?R.values[0][0]:"null",firstThreeValues:[R.values[0]?R.values[0][0]:"empty",R.values[1]?R.values[1][0]:"empty",R.values[2]?R.values[2][0]:"empty"]}),!(y.length>0)){n.n=31;break}if(P=!R.values[0]||!R.values[0][0]||""===R.values[0][0],console.log("Checking if values are empty:",{isEmpty:P,firstValue:R.values[0]?R.values[0][0]:"null",firstValueLength:R.values[0]&&R.values[0][0]?R.values[0][0].length:0}),!P){n.n=31;break}console.log("Values not visible, trying individual cell approach..."),_=0;case 27:if(!(_<Math.min(3,y.length))){n.n=31;break}return M=s.rowIndex+_,D=u||s.columnIndex+1,G=c.getCell(M,D),z=B[_][0],console.log("Setting cell (".concat(M,",").concat(D,') to: "').concat(z,'"')),G.values=[[z]],n.n=28,o.sync();case 28:return G.load("values"),n.n=29,o.sync();case 29:console.log("Cell ".concat(_," after setting:"),G.values[0][0]);case 30:_++,n.n=27;break;case 31:return H=c.getCell(0,u||s.columnIndex+1),($=c.getCell(0,s.columnIndex)).load("values"),n.n=32,o.sync();case 32:return H.values=[["".concat($.values[0][0]," (").concat(a.targetLanguage,")")]],n.n=33,o.sync();case 33:return n.a(2,{success:!0,message:"번역이 완료되었습니다. (".concat(p.length,"개 항목)")})}},n)}))).apply(this,arguments)}function V(e,n,t){return P.apply(this,arguments)}function P(){return(P=c(r().m(function e(n,t,o){var a,c,s;return r().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,console.log("translateBatch called with",n.length,"texts"),e.n=1,fetch(l,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({command:"Translate these items to ".concat(t,": ").concat(n.join(", ")),sheetContext:{operation:"translate_batch",texts:n,targetLanguage:t,sourceLanguage:o}})});case 1:if(a=e.v,console.log("Translation response status:",a.status),a.ok){e.n=2;break}throw new Error("HTTP error! status: ".concat(a.status));case 2:return e.n=3,a.json();case 3:if(c=e.v,console.log("Translation result:",c),!(c.success&&c.data&&c.data.translations)){e.n=4;break}return console.log("Translations received:",c.data.translations.length),console.log("First 3 translations from API:",c.data.translations.slice(0,3)),console.log("Raw translations data:",JSON.stringify(c.data.translations.slice(0,5))),e.a(2,c.data.translations);case 4:if(!c.error){e.n=5;break}throw console.error("Translation API error:",c.error),new Error(c.error);case 5:throw console.error("Invalid translation response structure:",c),new Error("번역 응답을 받을 수 없습니다.");case 6:e.n=8;break;case 7:return e.p=7,s=e.v,console.error("Translation error:",s),e.a(2,n.map(function(){return""}));case 8:return e.a(2)}},e,null,[[0,7]])}))).apply(this,arguments)}function _(e){for(var n="",t=e;t>=0;)n=String.fromCharCode(t%26+65)+n,t=Math.floor(t/26)-1;return n}function M(e){return"number"==typeof e?Number.isInteger(e)?e.toLocaleString("ko-KR"):e.toLocaleString("ko-KR",{minimumFractionDigits:0,maximumFractionDigits:2}):e}function W(e,n){var t=document.getElementById("status");t.textContent=e,t.className="status-message "+n,t.style.display="block",window.statusTimeout&&clearTimeout(window.statusTimeout),"success"===n&&(window.statusTimeout=setTimeout(function(){t.style.display="none"},5e3))}function D(){document.getElementById("commandInput").value="",document.getElementById("status").style.display="none"}function G(){W("이 애드인은 보안 서버를 통해 AI 기능을 제공합니다. 별도의 API 키 설정이 필요하지 않습니다.","info")}function z(){return(z=c(r().m(function e(){var n,t,o;return r().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,console.log("Testing backend connection..."),e.n=1,fetch("https://excel-addon-backend.vercel.app/api/test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({test:!0})});case 1:return n=e.v,console.log("Test response status:",n.status),console.log("Test response headers:",n.headers),e.n=2,n.json();case 2:t=e.v,console.log("Test response data:",t),W("백엔드 연결 테스트 성공","success"),e.n=4;break;case 3:e.p=3,o=e.v,console.error("Backend test error:",o),W("백엔드 연결 테스트 실패: "+o.message,"error");case 4:return e.a(2)}},e,null,[[0,3]])}))).apply(this,arguments)}function H(e,n){return $.apply(this,arguments)}function $(){return($=c(r().m(function e(n,t){return r().w(function(e){for(;;)if(0===e.n)return e.a(2,{success:!1,error:"이 기능은 현재 구현 중입니다."})},e)}))).apply(this,arguments)}function J(e,n){return Z.apply(this,arguments)}function Z(){return(Z=c(r().m(function e(n,t){var o,a;return r().w(function(e){for(;;)switch(e.n){case 0:return o=n.workbook.worksheets.getActiveWorksheet(),(a=t.range?o.getRange(t.range):o.getUsedRange()).worksheet.autoFilter.apply(a),e.n=1,n.sync();case 1:return e.a(2,{success:!0,message:"필터가 적용되었습니다."})}},e)}))).apply(this,arguments)}function q(e,n){return K.apply(this,arguments)}function K(){return(K=c(r().m(function e(n,t){var o,a,c,s;return r().w(function(e){for(;;)switch(e.n){case 0:return o=n.workbook.worksheets.getActiveWorksheet(),a=t.type||"row",c=t.position||1,s=t.count||1,"row"===a?o.getRangeByIndexes(c-1,0,s,1).insert(Excel.InsertShiftDirection.down):o.getRangeByIndexes(0,c-1,1,s).insert(Excel.InsertShiftDirection.right),e.n=1,n.sync();case 1:return e.a(2,{success:!0,message:"".concat(s,"개의 ").concat("row"===a?"행":"열","이 삽입되었습니다.")})}},e)}))).apply(this,arguments)}function X(e,n){return Y.apply(this,arguments)}function Y(){return(Y=c(r().m(function e(n,t){var o,a,c,s;return r().w(function(e){for(;;)switch(e.n){case 0:return o=n.workbook.worksheets.getActiveWorksheet(),a=t.type||"row",c=t.position||1,s=t.count||1,"row"===a?o.getRangeByIndexes(c-1,0,s,1).delete(Excel.DeleteShiftDirection.up):o.getRangeByIndexes(0,c-1,1,s).delete(Excel.DeleteShiftDirection.left),e.n=1,n.sync();case 1:return e.a(2,{success:!0,message:"".concat(s,"개의 ").concat("row"===a?"행":"열","이 삭제되었습니다.")})}},e)}))).apply(this,arguments)}function Q(e,n){return ee.apply(this,arguments)}function ee(){return(ee=c(r().m(function e(n,t){var o,a;return r().w(function(e){for(;;)switch(e.n){case 0:if(o=n.workbook.worksheets.getActiveWorksheet(),a=t.range?o.getRange(t.range):n.workbook.getSelectedRange(),t.formula){e.n=1;break}return e.a(2,{success:!1,error:"수식을 지정해주세요."});case 1:return a.formulas=[[t.formula]],e.n=2,n.sync();case 2:return e.a(2,{success:!0,message:"수식이 적용되었습니다."})}},e)}))).apply(this,arguments)}function ne(e,n){return te.apply(this,arguments)}function te(){return(te=c(r().m(function e(n,t){return r().w(function(e){for(;;)if(0===e.n)return e.a(2,{success:!1,error:"이 기능은 현재 구현 중입니다."})},e)}))).apply(this,arguments)}function re(e,n){return oe.apply(this,arguments)}function oe(){return(oe=c(r().m(function e(n,t){var o,a,c,s,u,l,i,d;return r().w(function(e){for(;;)switch(e.p=e.n){case 0:if(console.log("executeRemoveBorder called with params:",t),o=n.workbook.worksheets.getActiveWorksheet(),e.p=1,!t.range){e.n=6;break}if(!t.range.match(/^[A-Z]+:[A-Z]+$/)){e.n=4;break}if(console.log("Handling column range:",t.range),c=o.getUsedRange()){e.n=2;break}return e.a(2,{success:!1,error:"데이터가 없습니다."});case 2:return c.load(["rowCount","columnCount"]),e.n=3,n.sync();case 3:s=t.range.split(":")[0],u=s.charCodeAt(0)-65,a=o.getRangeByIndexes(0,u,c.rowCount,1),e.n=5;break;case 4:a=o.getRange(t.range);case 5:e.n=7;break;case 6:a=o.getSelectedRange();case 7:return a.load(["address","rowCount","columnCount"]),e.n=8,n.sync();case 8:if(console.log("Target range for border removal:",{address:a.address,rowCount:a.rowCount,columnCount:a.columnCount}),"all"!==(l=t.borderType||"all")){e.n=9;break}a.format.borders.getItem(Excel.BorderIndex.edgeLeft).style=Excel.BorderLineStyle.none,a.format.borders.getItem(Excel.BorderIndex.edgeRight).style=Excel.BorderLineStyle.none,a.format.borders.getItem(Excel.BorderIndex.edgeTop).style=Excel.BorderLineStyle.none,a.format.borders.getItem(Excel.BorderIndex.edgeBottom).style=Excel.BorderLineStyle.none,a.format.borders.getItem(Excel.BorderIndex.insideHorizontal).style=Excel.BorderLineStyle.none,a.format.borders.getItem(Excel.BorderIndex.insideVertical).style=Excel.BorderLineStyle.none,e.n=15;break;case 9:i=l,e.n="right"===i?10:"left"===i?11:"top"===i?12:"bottom"===i?13:14;break;case 10:return a.format.borders.getItem(Excel.BorderIndex.edgeRight).style=Excel.BorderLineStyle.none,e.a(3,15);case 11:return a.format.borders.getItem(Excel.BorderIndex.edgeLeft).style=Excel.BorderLineStyle.none,e.a(3,15);case 12:return a.format.borders.getItem(Excel.BorderIndex.edgeTop).style=Excel.BorderLineStyle.none,e.a(3,15);case 13:return a.format.borders.getItem(Excel.BorderIndex.edgeBottom).style=Excel.BorderLineStyle.none,e.a(3,15);case 14:return e.a(2,{success:!1,error:"알 수 없는 테두리 유형: ".concat(l)});case 15:return e.n=16,n.sync();case 16:return e.a(2,{success:!0,message:"".concat(a.address," 범위의 ").concat("all"===l?"모든":l," 테두리가 제거되었습니다.")});case 17:return e.p=17,d=e.v,console.error("Error in executeRemoveBorder:",d),e.a(2,{success:!1,error:"테두리 제거 중 오류 발생: ".concat(d.message)})}},e,null,[[1,17]])}))).apply(this,arguments)}}()}();
//# sourceMappingURL=taskpane.js.map