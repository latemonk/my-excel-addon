/*! For license information please see taskpane.js.LICENSE.txt */
!function(){var e={58394:function(e,n,t){"use strict";e.exports=t.p+"cedaf607fc3782e05ca5.css"}},n={};function t(r){var o=n[r];if(void 0!==o)return o.exports;var a=n[r]={exports:{}};return e[r](a,a.exports,t),a.exports}t.m=e,t.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},function(){var e;t.g.importScripts&&(e=t.g.location+"");var n=t.g.document;if(!e&&n&&(n.currentScript&&"SCRIPT"===n.currentScript.tagName.toUpperCase()&&(e=n.currentScript.src),!e)){var r=n.getElementsByTagName("script");if(r.length)for(var o=r.length-1;o>-1&&(!e||!/^http(s?):/.test(e));)e=r[o--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),t.p=e}(),t.b=document.baseURI||self.location.href,function(){"use strict";new URL(t(58394),t.b)}(),function(){function e(n){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(n)}function n(){var e,r,o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.toStringTag||"@@toStringTag";function c(n,o,a,s){var c=o&&o.prototype instanceof l?o:l,i=Object.create(c.prototype);return t(i,"_invoke",function(n,t,o){var a,s,c,l=0,i=o||[],d=!1,g={p:0,n:0,v:e,a:m,f:m.bind(e,4),d:function(n,t){return a=n,s=0,c=e,g.n=t,u}};function m(n,t){for(s=n,c=t,r=0;!d&&l&&!o&&r<i.length;r++){var o,a=i[r],m=g.p,f=a[2];n>3?(o=f===t)&&(c=a[(s=a[4])?5:(s=3,3)],a[4]=a[5]=e):a[0]<=m&&((o=n<2&&m<a[1])?(s=0,g.v=t,g.n=a[1]):m<f&&(o=n<3||a[0]>t||t>f)&&(a[4]=n,a[5]=t,g.n=f,s=0))}if(o||n>1)return u;throw d=!0,t}return function(o,i,f){if(l>1)throw TypeError("Generator is already running");for(d&&1===i&&m(i,f),s=i,c=f;(r=s<2?e:c)||!d;){a||(s?s<3?(s>1&&(g.n=-1),m(s,c)):g.n=c:g.v=c);try{if(l=2,a){if(s||(o="next"),r=a[o]){if(!(r=r.call(a,c)))throw TypeError("iterator result is not an object");if(!r.done)return r;c=r.value,s<2&&(s=0)}else 1===s&&(r=a.return)&&r.call(a),s<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),s=1);a=e}else if((r=(d=g.n<0)?c:n.call(t,g))!==u)break}catch(n){a=e,s=1,c=n}finally{l=1}}return{value:r,done:d}}}(n,a,s),!0),i}var u={};function l(){}function i(){}function d(){}r=Object.getPrototypeOf;var g=[][a]?r(r([][a]())):(t(r={},a,function(){return this}),r),m=d.prototype=l.prototype=Object.create(g);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,t(e,s,"GeneratorFunction")),e.prototype=Object.create(m),e}return i.prototype=d,t(m,"constructor",d),t(d,"constructor",i),i.displayName="GeneratorFunction",t(d,s,"GeneratorFunction"),t(m),t(m,s,"Generator"),t(m,a,function(){return this}),t(m,"toString",function(){return"[object Generator]"}),(n=function(){return{w:c,m:f}})()}function t(e,n,r,o){var a=Object.defineProperty;try{a({},"",{})}catch(e){a=0}t=function(e,n,r,o){function s(n,r){t(e,n,function(e){return this._invoke(n,r,e)})}n?a?a(e,n,{value:r,enumerable:!o,configurable:!o,writable:!o}):e[n]=r:(s("next",0),s("throw",1),s("return",2))},t(e,n,r,o)}function r(e,n,t,r,o,a,s){try{var c=e[a](s),u=c.value}catch(e){return void t(e)}c.done?n(u):Promise.resolve(u).then(r,o)}function o(e){return function(){var n=this,t=arguments;return new Promise(function(o,a){var s=e.apply(n,t);function c(e){r(s,o,a,c,u,"next",e)}function u(e){r(s,o,a,c,u,"throw",e)}c(void 0)})}}var a=null,s=!1,c="https://excel-addon-backend.vercel.app/api/openai-proxy-debug";function u(){var e=window.SpeechRecognition||window.webkitSpeechRecognition;return e?((a=new e).lang="ko-KR",a.continuous=!1,a.interimResults=!0,a.maxAlternatives=1,a.onstart=function(){s=!0,document.getElementById("voiceButton").classList.add("listening"),document.getElementById("voiceStatus").textContent="듣고 있습니다... 말씀해주세요",document.getElementById("voiceStatus").classList.add("listening")},a.onresult=function(e){var n=e.results[0][0].transcript;document.getElementById("commandInput").value=n,e.results[0].isFinal?document.getElementById("voiceStatus").textContent="음성 인식 완료":document.getElementById("voiceStatus").textContent="인식중: "+n},a.onerror=function(e){s=!1,document.getElementById("voiceButton").classList.remove("listening"),document.getElementById("voiceStatus").classList.remove("listening");var n="음성 인식 오류";switch(e.error){case"no-speech":n="음성이 감지되지 않았습니다.";break;case"audio-capture":n="마이크를 찾을 수 없습니다.";break;case"not-allowed":n="마이크 권한이 거부되었습니다.";break;case"network":n="네트워크 오류가 발생했습니다."}document.getElementById("voiceStatus").textContent=n,_(n,"error")},a.onend=function(){s=!1,document.getElementById("voiceButton").classList.remove("listening"),document.getElementById("voiceStatus").classList.remove("listening"),document.getElementById("commandInput").value.trim()?(document.getElementById("voiceStatus").textContent="음성 인식 완료. 실행 버튼을 눌러주세요.",document.getElementById("executeButton").focus()):document.getElementById("voiceStatus").textContent="음성 인식 준비"},a):(_("음성 인식이 지원되지 않는 브라우저입니다.","error"),document.getElementById("voiceButton").disabled=!0,document.getElementById("voiceStatus").textContent="음성 인식 미지원",null)}function l(){(a||(a=u()))&&(s?a.stop():a.start())}Office.onReady(function(e){e.host===Office.HostType.Excel&&(function(){D.apply(this,arguments)}(),document.getElementById("executeButton").onclick=d,document.getElementById("clearButton").onclick=W,document.getElementById("voiceButton").onclick=l,document.getElementById("settingsButton").onclick=M,document.querySelectorAll(".example-item").forEach(function(e){e.onclick=function(){var e;e=this.getAttribute("data-command"),document.getElementById("commandInput").value=e,document.getElementById("commandInput").focus()}}),document.getElementById("commandInput").addEventListener("keydown",function(e){"Enter"!==e.key||e.shiftKey||(e.preventDefault(),d())}),u())});var i=!1;function d(){return g.apply(this,arguments)}function g(){return g=o(n().m(function e(){var t,r,a,s;return n().w(function(e){for(;;)switch(e.p=e.n){case 0:if(!i){e.n=1;break}return console.log("Command already executing, ignoring duplicate call"),e.a(2);case 1:if(t=document.getElementById("commandInput").value.trim()){e.n=2;break}return _("명령어를 입력해주세요.","error"),e.a(2);case 2:return i=!0,r=document.getElementById("executeButton"),a='<span class="ms-Button-label">실행</span>',r.disabled=!0,r.innerHTML='<span class="loading"></span><span>처리중...</span>',_("명령을 처리하고 있습니다...","info"),e.p=3,e.n=4,Excel.run(function(){var e=o(n().m(function e(o){var s,c,u,l,i,d,g,f;return n().w(function(e){for(;;)switch(e.n){case 0:return console.log("Starting Excel.run for command execution"),s=o.workbook.worksheets.getActiveWorksheet(),c=o.workbook.getSelectedRange(),s.load("name"),c.load(["address","rowIndex","columnIndex","rowCount","columnCount"]),(u=s.getUsedRange()).load(["rowCount","columnCount","values"]),e.n=1,o.sync();case 1:if(l={sheetName:s.name,activeRange:{address:c.address,row:c.rowIndex+1,column:c.columnIndex+1,numRows:c.rowCount,numColumns:c.columnCount},lastRow:u?u.rowCount:0,lastColumn:u?u.columnCount:0,headers:[],dataRange:u?u.values:[],isLargeSheet:u&&u.rowCount>1e3},u&&u.rowCount>0)for(i=u.values[0],d=0;d<i.length;d++)l.headers.push({column:d+1,columnLetter:U(d),label:i[d]?i[d].toString():""});return e.n=2,m(t,l);case 2:if((g=e.v).success){e.n=3;break}throw new Error(g.error);case 3:return console.log("Executing interpreted command..."),e.n=4,p(o,g.data);case 4:f=e.v,console.log("Command execution result:",f),r.disabled=!1,r.innerHTML=a,f.success?(console.log("Operation completed successfully:",f),_(f.message||"명령이 성공적으로 실행되었습니다.","success"),setTimeout(function(){document.getElementById("commandInput").value=""},1e3)):(console.error("Operation failed:",f),_(f.error||"명령 실행에 실패했습니다.","error")),console.log("Excel.run completing...");case 5:return e.a(2)}},e)}));return function(n){return e.apply(this,arguments)}}());case 4:console.log("Excel.run completed"),e.n=6;break;case 5:e.p=5,s=e.v,console.error("Error in executeCommand:",s),console.error("Error stack:",s.stack),r.disabled=!1,r.innerHTML=a,_("오류가 발생했습니다: "+s.message,"error");case 6:return e.p=6,i=!1,e.f(6);case 7:return e.a(2)}},e,null,[[3,5,6,7]])})),g.apply(this,arguments)}function m(e,n){return f.apply(this,arguments)}function f(){return(f=o(n().m(function e(t,r){var o,a,s;return n().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,fetch(c,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({command:t,sheetContext:r})});case 1:if((o=e.v).ok){e.n=3;break}return e.n=2,o.json();case 2:return a=e.v,e.a(2,{success:!1,error:a.error||"서버 오류 (".concat(o.status,")")});case 3:return e.n=4,o.json();case 4:return e.a(2,e.v);case 5:return e.p=5,s=e.v,console.error("Proxy API Error:",s),e.a(2,{success:!1,error:"API 요청 오류: ".concat(s.toString())})}},e,null,[[0,5]])}))).apply(this,arguments)}function p(e,n){return h.apply(this,arguments)}function h(){return(h=o(n().m(function e(t,r){var o,a,s,c;return n().w(function(e){for(;;)switch(e.p=e.n){case 0:o=r.operation,a=r.parameters||{},console.log("[".concat((new Date).toISOString(),"] Executing operation: ").concat(o," with params:"),a),e.p=1,s=o,e.n="merge"===s?2:"sum"===s?4:"average"===s?6:"count"===s?8:"format"===s?10:"sort"===s?12:"filter"===s?14:"insert"===s?16:"delete"===s?18:"formula"===s?20:"chart"===s?22:"conditional_format"===s?24:"translate"===s?26:"compress"===s?28:"retry_translation"===s?30:32;break;case 2:return e.n=3,y(t,a);case 3:case 5:case 7:case 9:case 11:case 13:case 15:case 17:case 19:case 21:case 23:case 25:case 27:case 29:case 31:return e.a(2,e.v);case 4:return e.n=5,w(t,a);case 6:return e.n=7,b(t,a);case 8:return e.n=9,x(t,a);case 10:return e.n=11,T(t,a);case 12:return e.n=13,S(t,a);case 14:return e.n=15,H(t,a);case 16:return e.n=17,$(t,a);case 18:return e.n=19,K(t,a);case 20:return e.n=21,X(t,a);case 22:return e.n=23,B(t,a);case 24:return e.n=25,O(t,a);case 26:return e.n=27,F(t,a);case 28:return e.n=29,G(t,a);case 30:return e.n=31,Q(t,a);case 32:return e.a(2,{success:!1,error:"알 수 없는 작업: ".concat(o)});case 33:e.n=35;break;case 34:return e.p=34,c=e.v,console.error("Error in executeInterpretedCommand:",c),e.a(2,{success:!1,error:"작업 실행 중 오류: ".concat(c.message||c.toString())});case 35:return e.a(2)}},e,null,[[1,34]])}))).apply(this,arguments)}function y(e,n){return v.apply(this,arguments)}function v(){return(v=o(n().m(function e(t,r){var o,a,s;return n().w(function(e){for(;;)switch(e.n){case 0:return console.log("executeMerge started with params:",r),o=t.workbook.worksheets.getActiveWorksheet(),a=r.range?o.getRange(r.range):t.workbook.getSelectedRange(),console.log("Loading range address..."),a.load("address"),e.n=1,t.sync();case 1:return console.log("Range address loaded:",a.address),s=a.address,console.log("Merging range..."),a.merge(),e.n=2,t.sync();case 2:return console.log("Merge completed successfully"),e.a(2,{success:!0,message:"".concat(s," 범위가 병합되었습니다.")})}},e)}))).apply(this,arguments)}function w(e,n){return k.apply(this,arguments)}function k(){return(k=o(n().m(function e(t,r){var o,a,s,c,u,l,i,d,g,m,f,p,h,y,v,w,k,b;return n().w(function(e){for(;;)switch(e.n){case 0:if(o=t.workbook.worksheets.getActiveWorksheet(),!r.columnName&&"column"!==r.sumType){e.n=9;break}return console.log("Sum by column name:",r.columnName),(a=o.getUsedRange()).load(["values","rowCount","columnCount"]),e.n=1,t.sync();case 1:if(a&&0!==a.rowCount){e.n=2;break}return e.a(2,{success:!1,error:"시트에 데이터가 없습니다."});case 2:s=a.values[0],c=-1,u="",l=0;case 3:if(!(l<s.length)){e.n=5;break}if(!s[l]||s[l].toString().toLowerCase()!==(r.columnName||"").toLowerCase()){e.n=4;break}return c=l,u=U(l),e.a(3,5);case 4:l++,e.n=3;break;case 5:if(-1!==c){e.n=6;break}return e.a(2,{success:!1,error:'"'.concat(r.columnName,'" 열을 찾을 수 없습니다.')});case 6:for(i=1,d=1;d<a.rowCount;d++)null!==a.values[d][c]&&void 0!==a.values[d][c]&&""!==a.values[d][c]&&(i=d+1);return g="".concat(u,"2:").concat(u).concat(i),m=o.getCell(i,c),console.log("Summing range: ".concat(g,", placing result in row ").concat(i+1)),m.formulas=[["=SUM(".concat(g,")")]],e.n=7,t.sync();case 7:return m.load(["values","address"]),e.n=8,t.sync();case 8:return e.a(2,{success:!0,message:"".concat(r.columnName," 열의 합계를 ").concat(m.address,"에 계산했습니다: ").concat(V(m.values[0][0])),value:m.values[0][0]});case 9:return(f=r.sourceRange?o.getRange(r.sourceRange):t.workbook.getSelectedRange()).load(["columnIndex","rowIndex","rowCount","address"]),e.n=10,t.sync();case 10:if(!0!==r.addNewRow){e.n=13;break}return p=f.columnIndex,h=f.rowIndex+f.rowCount,(y=o.getCell(h,p)).formulas=[["=SUM(".concat(f.address,")")]],e.n=11,t.sync();case 11:return y.load(["values","address"]),e.n=12,t.sync();case 12:return e.a(2,{success:!0,message:"".concat(y.address,"에 합계를 계산했습니다: ").concat(V(y.values[0][0])),value:y.values[0][0]});case 13:if(!r.targetCell){e.n=16;break}return(v=o.getRange(r.targetCell)).formulas=[["=SUM(".concat(f.address,")")]],e.n=14,t.sync();case 14:return v.load(["values","address"]),e.n=15,t.sync();case 15:return e.a(2,{success:!0,message:"".concat(v.address,"에 합계를 계산했습니다: ").concat(V(v.values[0][0])),value:v.values[0][0]});case 16:return w=f.columnIndex,k=f.rowIndex+f.rowCount,(b=o.getCell(k,w)).formulas=[["=SUM(".concat(f.address,")")]],e.n=17,t.sync();case 17:return b.load(["values","address"]),e.n=18,t.sync();case 18:return e.a(2,{success:!0,message:"".concat(b.address,"에 합계를 계산했습니다: ").concat(V(b.values[0][0])),value:b.values[0][0]});case 19:return e.a(2)}},e)}))).apply(this,arguments)}function b(e,n){return C.apply(this,arguments)}function C(){return(C=o(n().m(function e(t,r){var o,a,s,c,u,l;return n().w(function(e){for(;;)switch(e.n){case 0:return o=t.workbook.worksheets.getActiveWorksheet(),(a=r.sourceRange?o.getRange(r.sourceRange):t.workbook.getSelectedRange()).load(["columnIndex","rowIndex","rowCount","address"]),e.n=1,t.sync();case 1:if(!r.targetCell){e.n=4;break}return(s=o.getRange(r.targetCell)).formulas=[["=AVERAGE(".concat(a.address,")")]],e.n=2,t.sync();case 2:return s.load(["values","address"]),e.n=3,t.sync();case 3:return e.a(2,{success:!0,message:"".concat(s.address,"에 평균을 계산했습니다: ").concat(V(s.values[0][0])),value:s.values[0][0]});case 4:return c=a.columnIndex,u=a.rowIndex+a.rowCount,(l=o.getCell(u,c)).formulas=[["=AVERAGE(".concat(a.address,")")]],e.n=5,t.sync();case 5:return l.load(["values","address"]),e.n=6,t.sync();case 6:return e.a(2,{success:!0,message:"".concat(l.address,"에 평균을 계산했습니다: ").concat(V(l.values[0][0])),value:l.values[0][0]});case 7:return e.a(2)}},e)}))).apply(this,arguments)}function x(e,n){return I.apply(this,arguments)}function I(){return(I=o(n().m(function e(t,r){var o,a,s,c,u,l,i,d;return n().w(function(e){for(;;)switch(e.n){case 0:return o=t.workbook.worksheets.getActiveWorksheet(),(a=r.sourceRange?o.getRange(r.sourceRange):t.workbook.getSelectedRange()).load(["address"]),e.n=1,t.sync();case 1:if("countif"===r.countType&&void 0!==r.condition?(c="contains"===r.operator?'"*'.concat(r.condition,'*"'):"equals"===r.operator?"string"==typeof r.condition?'"'.concat(r.condition,'"'):r.condition:r.operator&&[">","<",">=","<=","<>"].includes(r.operator)?'"'.concat(r.operator).concat(r.condition,'"'):"string"==typeof r.condition?'"*'.concat(r.condition,'*"'):r.condition,s="=COUNTIF(".concat(a.address,", ").concat(c,")")):s="counta"===r.countType?"=COUNTA(".concat(a.address,")"):"=COUNT(".concat(a.address,")"),!r.targetCell){e.n=2;break}u=o.getRange(r.targetCell),e.n=4;break;case 2:return l=o.getUsedRange(),e.n=3,t.sync();case 3:i=l?l.rowCount:1,d=l?l.columnCount:1,u=o.getCell(i,d);case 4:return u.formulas=[[s]],e.n=5,t.sync();case 5:return u.load("values"),e.n=6,t.sync();case 6:return e.a(2,{success:!0,message:"countif"===r.countType?'"'.concat(r.condition,'"을(를) 포함하는 셀의 개수: ').concat(V(u.values[0][0]),"개"):"개수를 계산했습니다: ".concat(V(u.values[0][0]),"개"),value:u.values[0][0]})}},e)}))).apply(this,arguments)}function T(e,n){return E.apply(this,arguments)}function E(){return(E=o(n().m(function e(t,r){var o,a,s;return n().w(function(e){for(;;)switch(e.n){case 0:return console.log("executeFormat called with params:",r),o=t.workbook.worksheets.getActiveWorksheet(),(a=r.range?o.getRange(r.range):t.workbook.getSelectedRange()).load("format"),e.n=1,t.sync();case 1:return void 0!==r.bold&&(a.format.font.bold=r.bold),void 0!==r.italic&&(a.format.font.italic=r.italic),r.fontSize&&(a.format.font.size=r.fontSize),r.fontColor&&(a.format.font.color=r.fontColor),r.backgroundColor&&(a.format.fill.color=r.backgroundColor),r.horizontalAlignment&&(a.format.horizontalAlignment="left"===r.horizontalAlignment?"Left":"center"===r.horizontalAlignment?"Center":"right"===r.horizontalAlignment?"Right":"General"),r.numberFormat&&("number"===(s=r.numberFormat)||"숫자"===s?s="#,##0":"currency"===s||"원화"===s||"won"===s||"통화"===s?s="₩#,##0":"currency_decimal"===s||"원화_소수"===s?s="₩#,##0.00":"percentage"===s||"퍼센트"===s||"백분율"===s?s="0%":"percentage_decimal"===s||"퍼센트_소수"===s?s="0.00%":"date"===s||"날짜"===s?s="yyyy-mm-dd":"time"===s||"시간"===s?s="hh:mm:ss":"text"===s||"텍스트"===s?s="@":"general"!==s&&"일반"!==s||(s="General"),a.numberFormat=s),e.n=2,t.sync();case 2:return e.a(2,{success:!0,message:"서식이 적용되었습니다."})}},e)}))).apply(this,arguments)}function S(e,n){return R.apply(this,arguments)}function R(){return(R=o(n().m(function e(t,r){var o,a,s,c,u;return n().w(function(e){for(;;)switch(e.n){case 0:return o=t.workbook.worksheets.getActiveWorksheet(),a=r.range?o.getRange(r.range):o.getUsedRange(),s=r.column||1,c=void 0===r.ascending||r.ascending,a.sort.apply([{key:s-1,ascending:c}]),e.n=1,t.sync();case 1:return u=U(s-1),e.a(2,{success:!0,message:"".concat(u,"열 기준으로 ").concat(c?"오름차순":"내림차순"," 정렬되었습니다.")})}},e)}))).apply(this,arguments)}function B(e,n){return A.apply(this,arguments)}function A(){return(A=o(n().m(function e(t,r){var o,a,s,c;return n().w(function(e){for(;;)switch(e.n){case 0:return o=t.workbook.worksheets.getActiveWorksheet(),a=r.range?o.getRange(r.range):t.workbook.getSelectedRange(),console.log("Creating chart with params:",r),a.load(["address","values"]),e.n=1,t.sync();case 1:return console.log("Chart data range:",a.address),s="bar"===r.chartType||"막대"===r.chartType?Excel.ChartType.columnClustered:"line"===r.chartType||"선"===r.chartType?Excel.ChartType.line:"pie"===r.chartType||"원"===r.chartType?Excel.ChartType.pie:"scatter"===r.chartType||"분산형"===r.chartType?Excel.ChartType.xyscatter:Excel.ChartType.columnClustered,(c=o.charts.add(s,a,Excel.ChartSeriesBy.auto)).title.text=r.title||"차트",c.height=300,c.width=400,c.left=r.offsetX||100,c.top=r.offsetY||100,c.legend.position=Excel.ChartLegendPosition.bottom,c.legend.visible=!0,e.n=2,t.sync();case 2:return e.a(2,{success:!0,message:"".concat(a.address," 범위로 ").concat(r.chartType||"막대"," 차트가 생성되었습니다.")})}},e)}))).apply(this,arguments)}function O(e,n){return L.apply(this,arguments)}function L(){return(L=o(n().m(function e(t,r){var o,a,s;return n().w(function(e){for(;;)switch(e.n){case 0:return o=t.workbook.worksheets.getActiveWorksheet(),a=r.range?o.getRange(r.range):o.getUsedRange(),console.log("Applying conditional format with params:",r),s=a.conditionalFormats.add(Excel.ConditionalFormatType.cellValue),"greater_than"===r.condition&&void 0!==r.value?s.cellValue.rule={formula1:r.value.toString(),operator:Excel.ConditionalCellValueOperator.greaterThan}:"less_than"===r.condition&&void 0!==r.value?s.cellValue.rule={formula1:r.value.toString(),operator:Excel.ConditionalCellValueOperator.lessThan}:"equal_to"===r.condition&&void 0!==r.value?s.cellValue.rule={formula1:r.value.toString(),operator:Excel.ConditionalCellValueOperator.equalTo}:"text_contains"===r.condition&&void 0!==r.value?s.cellValue.rule={formula1:r.value.toString(),operator:Excel.ConditionalCellValueOperator.containsText}:s.cellValue.rule={formula1:(r.value||0).toString(),operator:Excel.ConditionalCellValueOperator.greaterThan},s.cellValue.format.fill.color=r.backgroundColor||"#00FF00",r.fontColor&&(s.cellValue.format.font.color=r.fontColor),r.bold&&(s.cellValue.format.font.bold=!0),e.n=1,t.sync();case 1:return e.a(2,{success:!0,message:"조건부 서식이 적용되었습니다. (".concat(r.condition," ").concat(r.value||"",")")})}},e)}))).apply(this,arguments)}function F(e,n){return j.apply(this,arguments)}function j(){return(j=o(n().m(function t(r,o){var a,s,c,u,l,i,d,g,m,f,p,h,y,v,w,k,b,C,x,I,T,E,S,R,B;return n().w(function(n){for(;;)switch(n.n){case 0:if(console.log("executeTranslate called with params:",o),a=r.workbook.worksheets.getActiveWorksheet(),o.targetLanguage){n.n=1;break}return n.a(2,{success:!1,error:"대상 언어를 지정해주세요."});case 1:if(!o.sourceRange){n.n=8;break}if(!o.sourceRange.match(/^[A-Z]+:[A-Z]+$/)){n.n=6;break}if(console.log("Handling column range:",o.sourceRange),u=a.getUsedRange()){n.n=2;break}return n.a(2,{success:!1,error:"번역할 데이터가 없습니다."});case 2:return u.load(["rowCount","columnCount"]),n.n=3,r.sync();case 3:if(console.log("Used range:",{rowCount:u.rowCount,columnCount:u.columnCount}),l=o.sourceRange.split(":")[0],i=l.charCodeAt(0)-65,!(u.rowCount>1)){n.n=4;break}s=a.getRangeByIndexes(1,i,u.rowCount-1,1),n.n=5;break;case 4:return n.a(2,{success:!1,error:"번역할 데이터가 없습니다."});case 5:o.targetRange&&o.targetRange.match(/^[A-Z]+:[A-Z]+$/)?(d=o.targetRange.split(":")[0],c=d.charCodeAt(0)-65,console.log("Target column calculation:",{targetRange:o.targetRange,targetColumnLetter:d,targetColumnIndex:c})):(c=i+1,console.log("Using next column as target:",{sourceColumnIndex:i,targetColumnIndex:c})),n.n=7;break;case 6:s=a.getRange(o.sourceRange);case 7:n.n=13;break;case 8:if(!o.sourceColumn){n.n=12;break}return g=o.sourceColumn.charCodeAt(0)-65,(m=a.getUsedRange()).load(["rowCount"]),n.n=9,r.sync();case 9:if(!(m.rowCount>1)){n.n=10;break}s=a.getRangeByIndexes(1,g,m.rowCount-1,1),n.n=11;break;case 10:return n.a(2,{success:!1,error:"번역할 데이터가 없습니다."});case 11:c="next"===o.targetColumn?g+1:o.targetColumn?o.targetColumn.charCodeAt(0)-65:g+1,n.n=13;break;case 12:return n.a(2,{success:!1,error:"번역할 열을 지정해주세요."});case 13:return s.load(["values","rowIndex","columnIndex","rowCount"]),n.n=14,r.sync();case 14:if(console.log("Source range loaded:",{rowIndex:s.rowIndex,columnIndex:s.columnIndex,rowCount:s.rowCount,values:s.values?"".concat(s.values.length," rows"):"null"}),(f=s.values)&&0!==f.length){n.n=15;break}return n.a(2,{success:!1,error:"번역할 데이터가 없습니다."});case 15:p=[],h=20,y=0;case 16:if(!(y<f.length)){n.n=21;break}if(v=f.slice(y,Math.min(y+h,f.length)),!((w=v.map(function(e){return e[0]}).filter(function(e){return e})).length>0)){n.n=18;break}return n.n=17,N(w,o.targetLanguage,o.sourceLanguage);case 17:if((k=n.v)&&Array.isArray(k))for(console.log("Processing translation batch:",{batchLength:v.length,translatedBatchLength:k.length,sampleTranslations:k.slice(0,3),firstTranslation:k[0],translationType:e(k[0]),rawData:JSON.stringify(k.slice(0,3))}),C=0,x=0;x<v.length;x++)v[x][0]?(p.push([k[C]||""]),C++):p.push([""]);else for(console.error("Invalid translation batch received:",k),b=0;b<v.length;b++)p.push([""]);n.n=19;break;case 18:for(I=0;I<v.length;I++)p.push([""]);case 19:y%100==0&&y>0&&_("번역 중... ".concat(Math.round(y/f.length*100),"%"),"info");case 20:y+=h,n.n=16;break;case 21:return console.log("Writing translations to target column:",{rowIndex:s.rowIndex,targetColumnIndex:c||s.columnIndex+1,translationsCount:p.length,sampleTranslations:p.slice(0,3).map(function(e){return e[0]})}),console.log("First 5 translations raw:",JSON.stringify(p.slice(0,5))),console.log("Translation content check:",{first:p[0]?p[0][0]:"null",second:p[1]?p[1][0]:"null",third:p[2]?p[2][0]:"null",isEmpty:p[0]&&""===p[0][0]}),(T=a.getRangeByIndexes(s.rowIndex,c||s.columnIndex+1,p.length,1)).load(["address","values"]),n.n=22,r.sync();case 22:return console.log("Target range address:",T.address),console.log("Existing target values (first 3):",T.values.slice(0,3)),T.clear(Excel.ClearApplyTo.contents),n.n=23,r.sync();case 23:return console.log("Target range cleared"),console.log("Setting target range values:",{translationsLength:p.length,firstTranslation:p[0],isArray:Array.isArray(p),is2DArray:Array.isArray(p[0])}),E=p.map(function(e){return[String(e[0]||"")]}),console.log("String translations (first 3):",E.slice(0,3)),T.numberFormat=[["@"]],n.n=24,r.sync();case 24:return T.values=E,T.format.autofitColumns(),T.format.font.color="#000000",T.format.fill.color="#FFFFFF",n.n=25,r.sync();case 25:return console.log("Translations written to Excel"),T.load(["values","text","valueTypes"]),n.n=26,r.sync();case 26:if(console.log("Verification - Target range:",{address:T.address,values:T.values.slice(0,3),text:T.text.slice(0,3),valueTypes:T.valueTypes.slice(0,3),actualFirstValue:T.values[0]?T.values[0][0]:"null",firstThreeValues:[T.values[0]?T.values[0][0]:"empty",T.values[1]?T.values[1][0]:"empty",T.values[2]?T.values[2][0]:"empty"]}),!(p.length>0)||T.values[0]&&T.values[0][0]){n.n=30;break}console.log("Values not visible, trying individual cell approach..."),S=0;case 27:if(!(S<Math.min(3,p.length))){n.n=30;break}return a.getCell(s.rowIndex+S,c||s.columnIndex+1).values=[[E[S][0]]],n.n=28,r.sync();case 28:console.log("Set cell ".concat(S," to:"),E[S][0]);case 29:S++,n.n=27;break;case 30:return R=a.getCell(0,c||s.columnIndex+1),(B=a.getCell(0,s.columnIndex)).load("values"),n.n=31,r.sync();case 31:return R.values=[["".concat(B.values[0][0]," (").concat(o.targetLanguage,")")]],n.n=32,r.sync();case 32:return n.a(2,{success:!0,message:"번역이 완료되었습니다. (".concat(f.length,"개 항목)")})}},t)}))).apply(this,arguments)}function N(e,n,t){return P.apply(this,arguments)}function P(){return(P=o(n().m(function e(t,r,o){var a,s,u;return n().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,console.log("translateBatch called with",t.length,"texts"),e.n=1,fetch(c,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({command:"Translate these items to ".concat(r,": ").concat(t.join(", ")),sheetContext:{operation:"translate_batch",texts:t,targetLanguage:r,sourceLanguage:o}})});case 1:if(a=e.v,console.log("Translation response status:",a.status),a.ok){e.n=2;break}throw new Error("HTTP error! status: ".concat(a.status));case 2:return e.n=3,a.json();case 3:if(s=e.v,console.log("Translation result:",s),!(s.success&&s.data&&s.data.translations)){e.n=4;break}return console.log("Translations received:",s.data.translations.length),e.a(2,s.data.translations);case 4:if(!s.error){e.n=5;break}throw console.error("Translation API error:",s.error),new Error(s.error);case 5:throw console.error("Invalid translation response structure:",s),new Error("번역 응답을 받을 수 없습니다.");case 6:e.n=8;break;case 7:return e.p=7,u=e.v,console.error("Translation error:",u),e.a(2,t.map(function(){return""}));case 8:return e.a(2)}},e,null,[[0,7]])}))).apply(this,arguments)}function U(e){for(var n="",t=e;t>=0;)n=String.fromCharCode(t%26+65)+n,t=Math.floor(t/26)-1;return n}function V(e){return"number"==typeof e?Number.isInteger(e)?e.toLocaleString("ko-KR"):e.toLocaleString("ko-KR",{minimumFractionDigits:0,maximumFractionDigits:2}):e}function _(e,n){var t=document.getElementById("status");t.textContent=e,t.className="status-message "+n,t.style.display="block",window.statusTimeout&&clearTimeout(window.statusTimeout),"success"===n&&(window.statusTimeout=setTimeout(function(){t.style.display="none"},5e3))}function W(){document.getElementById("commandInput").value="",document.getElementById("status").style.display="none"}function M(){_("이 애드인은 보안 서버를 통해 AI 기능을 제공합니다. 별도의 API 키 설정이 필요하지 않습니다.","info")}function D(){return(D=o(n().m(function e(){var t,r,o;return n().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,console.log("Testing backend connection..."),e.n=1,fetch("https://excel-addon-backend.vercel.app/api/test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({test:!0})});case 1:return t=e.v,console.log("Test response status:",t.status),console.log("Test response headers:",t.headers),e.n=2,t.json();case 2:r=e.v,console.log("Test response data:",r),_("백엔드 연결 테스트 성공","success"),e.n=4;break;case 3:e.p=3,o=e.v,console.error("Backend test error:",o),_("백엔드 연결 테스트 실패: "+o.message,"error");case 4:return e.a(2)}},e,null,[[0,3]])}))).apply(this,arguments)}function G(e,n){return z.apply(this,arguments)}function z(){return(z=o(n().m(function e(t,r){return n().w(function(e){for(;;)if(0===e.n)return e.a(2,{success:!1,error:"이 기능은 현재 구현 중입니다."})},e)}))).apply(this,arguments)}function H(e,n){return J.apply(this,arguments)}function J(){return(J=o(n().m(function e(t,r){var o,a;return n().w(function(e){for(;;)switch(e.n){case 0:return o=t.workbook.worksheets.getActiveWorksheet(),(a=r.range?o.getRange(r.range):o.getUsedRange()).worksheet.autoFilter.apply(a),e.n=1,t.sync();case 1:return e.a(2,{success:!0,message:"필터가 적용되었습니다."})}},e)}))).apply(this,arguments)}function $(e,n){return q.apply(this,arguments)}function q(){return(q=o(n().m(function e(t,r){var o,a,s,c;return n().w(function(e){for(;;)switch(e.n){case 0:return o=t.workbook.worksheets.getActiveWorksheet(),a=r.type||"row",s=r.position||1,c=r.count||1,"row"===a?o.getRangeByIndexes(s-1,0,c,1).insert(Excel.InsertShiftDirection.down):o.getRangeByIndexes(0,s-1,1,c).insert(Excel.InsertShiftDirection.right),e.n=1,t.sync();case 1:return e.a(2,{success:!0,message:"".concat(c,"개의 ").concat("row"===a?"행":"열","이 삽입되었습니다.")})}},e)}))).apply(this,arguments)}function K(e,n){return Z.apply(this,arguments)}function Z(){return(Z=o(n().m(function e(t,r){var o,a,s,c;return n().w(function(e){for(;;)switch(e.n){case 0:return o=t.workbook.worksheets.getActiveWorksheet(),a=r.type||"row",s=r.position||1,c=r.count||1,"row"===a?o.getRangeByIndexes(s-1,0,c,1).delete(Excel.DeleteShiftDirection.up):o.getRangeByIndexes(0,s-1,1,c).delete(Excel.DeleteShiftDirection.left),e.n=1,t.sync();case 1:return e.a(2,{success:!0,message:"".concat(c,"개의 ").concat("row"===a?"행":"열","이 삭제되었습니다.")})}},e)}))).apply(this,arguments)}function X(e,n){return Y.apply(this,arguments)}function Y(){return(Y=o(n().m(function e(t,r){var o,a;return n().w(function(e){for(;;)switch(e.n){case 0:if(o=t.workbook.worksheets.getActiveWorksheet(),a=r.range?o.getRange(r.range):t.workbook.getSelectedRange(),r.formula){e.n=1;break}return e.a(2,{success:!1,error:"수식을 지정해주세요."});case 1:return a.formulas=[[r.formula]],e.n=2,t.sync();case 2:return e.a(2,{success:!0,message:"수식이 적용되었습니다."})}},e)}))).apply(this,arguments)}function Q(e,n){return ee.apply(this,arguments)}function ee(){return(ee=o(n().m(function e(t,r){return n().w(function(e){for(;;)if(0===e.n)return e.a(2,{success:!1,error:"이 기능은 현재 구현 중입니다."})},e)}))).apply(this,arguments)}}()}();
//# sourceMappingURL=taskpane.js.map