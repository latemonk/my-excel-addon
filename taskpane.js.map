{"version":3,"file":"taskpane.js","mappings":"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","sources":["webpack://worksai-excel-addon/webpack/bootstrap","webpack://worksai-excel-addon/webpack/runtime/global","webpack://worksai-excel-addon/webpack/runtime/hasOwnProperty shorthand","webpack://worksai-excel-addon/webpack/runtime/publicPath","webpack://worksai-excel-addon/webpack/runtime/jsonp chunk loading","webpack://worksai-excel-addon/./src/taskpane/taskpane.html","webpack://worksai-excel-addon/./src/taskpane/taskpane.js"],"sourcesContent":["// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","var scriptUrl;\nif (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + \"\";\nvar document = __webpack_require__.g.document;\nif (!scriptUrl && document) {\n\tif (document.currentScript && document.currentScript.tagName.toUpperCase() === 'SCRIPT')\n\t\tscriptUrl = document.currentScript.src;\n\tif (!scriptUrl) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tif(scripts.length) {\n\t\t\tvar i = scripts.length - 1;\n\t\t\twhile (i > -1 && (!scriptUrl || !/^http(s?):/.test(scriptUrl))) scriptUrl = scripts[i--].src;\n\t\t}\n\t}\n}\n// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration\n// or pass an empty string (\"\") and set the __webpack_public_path__ variable from your code to use your own logic.\nif (!scriptUrl) throw new Error(\"Automatic publicPath is not supported in this browser\");\nscriptUrl = scriptUrl.replace(/^blob:/, \"\").replace(/#.*$/, \"\").replace(/\\?.*$/, \"\").replace(/\\/[^\\/]+$/, \"/\");\n__webpack_require__.p = scriptUrl;","__webpack_require__.b = document.baseURI || self.location.href;\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t926: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n// no on chunks loaded\n\n// no jsonp function","// Imports\nvar ___HTML_LOADER_IMPORT_0___ = new URL(\"./taskpane.css\", import.meta.url);\n// Module\nvar code = \"<!DOCTYPE html> <html> <head> <meta charset=\\\"UTF-8\\\"/> <meta http-equiv=\\\"X-UA-Compatible\\\" content=\\\"IE=Edge\\\"/> <meta name=\\\"viewport\\\" content=\\\"width=device-width,initial-scale=1\\\"> <title>웍스AI 엑셀 도우미</title> <\" + \"script src=\\\"https://appsforoffice.microsoft.com/lib/1.1/hosted/office.js\\\"><\" + \"/script> <link rel=\\\"stylesheet\\\" href=\\\"https://static2.sharepointonline.com/files/fabric/office-ui-fabric-js/1.4.0/css/fabric.min.css\\\"/> <link rel=\\\"stylesheet\\\" href=\\\"https://static2.sharepointonline.com/files/fabric/office-ui-fabric-js/1.4.0/css/fabric.components.min.css\\\"/> <link href=\\\"\" + ___HTML_LOADER_IMPORT_0___ + \"\\\" rel=\\\"stylesheet\\\"/> </head> <body class=\\\"ms-font-m ms-welcome ms-Fabric\\\"> <main id=\\\"app-body\\\" class=\\\"ms-welcome__main\\\"> <div class=\\\"container\\\"> <div class=\\\"header-section\\\"> <h2 class=\\\"ms-font-xl\\\">웍스AI 엑셀 도우미</h2> <p class=\\\"help-text\\\">자연어로 Excel 작업을 요청하세요. (대용량 번역 지원)</p> </div> <div class=\\\"voice-section\\\"> <button id=\\\"voiceButton\\\" class=\\\"voice-button\\\"> <svg width=\\\"24\\\" height=\\\"24\\\" viewBox=\\\"0 0 24 24\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\"> <path d=\\\"M12 14c1.66 0 3-1.34 3-3V5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3z\\\"/> <path d=\\\"M17 11c0 2.76-2.24 5-5 5s-5-2.24-5-5H5c0 3.53 2.61 6.43 6 6.92V21h2v-3.08c3.39-.49 6-3.39 6-6.92h-2z\\\"/> </svg> </button> <div class=\\\"voice-status\\\" id=\\\"voiceStatus\\\">음성 인식 준비</div> </div> <div class=\\\"input-container\\\"> <textarea id=\\\"commandInput\\\" placeholder=\\\"예: A1부터 A10까지 합계를 구해줘\\\" rows=\\\"3\\\"></textarea> <div class=\\\"button-container\\\"> <button id=\\\"executeButton\\\" class=\\\"ms-Button ms-Button--primary\\\"> <span class=\\\"ms-Button-label\\\">실행</span> </button> <button id=\\\"clearButton\\\" class=\\\"ms-Button\\\"> <span class=\\\"ms-Button-label\\\">지우기</span> </button> </div> </div> <div id=\\\"status\\\" class=\\\"status-message\\\"></div> <div class=\\\"examples\\\"> <h3>예제 명령어</h3> <div class=\\\"example-list\\\"> <div class=\\\"example-item\\\" data-command=\\\"A1:B5 셀을 병합해줘\\\"> <strong>셀 병합:</strong> A1:B5 셀을 병합해줘 </div> <div class=\\\"example-item\\\" data-command=\\\"A열의 합계를 구해줘\\\"> <strong>합계 계산:</strong> A열의 합계를 구해줘 </div> <div class=\\\"example-item\\\" data-command=\\\"Name 열의 합계를 구해줘\\\"> <strong>레이블로 합계:</strong> Name 열의 합계를 구해줘 </div> <div class=\\\"example-item\\\" data-command=\\\"선택한 셀을 굵게 만들고 파란색으로 바꿔줘\\\"> <strong>서식 지정:</strong> 선택한 셀을 굵게 만들고 파란색으로 바꿔줘 </div> <div class=\\\"example-item\\\" data-command=\\\"B열 기준으로 내림차순 정렬해줘\\\"> <strong>정렬:</strong> B열 기준으로 내림차순 정렬해줘 </div> <div class=\\\"example-item\\\" data-command=\\\"값이 100보다 큰 셀은 녹색 배경으로 표시해줘\\\"> <strong>조건부 서식:</strong> 값이 100보다 큰 셀은 녹색 배경으로 표시해줘 </div> <div class=\\\"example-item\\\" data-command=\\\"A1:B10 데이터로 막대 차트를 만들어줘\\\"> <strong>차트 생성:</strong> A1:B10 데이터로 막대 차트를 만들어줘 </div> <div class=\\\"example-item\\\" data-command=\\\"D열을 중국어로 번역해서 다음 열에 추가해줘\\\"> <strong>번역:</strong> D열을 중국어로 번역해서 다음 열에 추가해줘 </div> <div class=\\\"example-item\\\" data-command=\\\"A열의 10000개 행을 영어로 번역해줘\\\"> <strong>대용량 번역:</strong> A열의 10000개 행을 영어로 번역해줘 </div> <div class=\\\"example-item\\\" data-command=\\\"D2:D170 사이의 빈 행을 제거해줘\\\"> <strong>빈 행 제거:</strong> D2:D170 사이의 빈 행을 제거해줘 </div> </div> </div> <div class=\\\"settings-section\\\"> <button id=\\\"settingsButton\\\" class=\\\"settings-link\\\">설정</button> </div> </div> </main> </body> </html>\";\n// Exports\nexport default code;","/*\n * Copyright (c) Microsoft Corporation. All rights reserved. Licensed under the MIT license.\n * See LICENSE in the project root for license information.\n */\n\n/* global document, Office, Excel */\n\n// Voice recognition variables\nlet recognition = null;\nlet isListening = false;\n\n// Backend API URL - Vercel 배포 후 실제 URL로 변경해주세요\nconst API_PROXY_URL = process.env.API_PROXY_URL || 'https://your-app.vercel.app/api/openai-proxy';\n\nOffice.onReady((info) => {\n  if (info.host === Office.HostType.Excel) {\n    // Assign event handlers\n    document.getElementById(\"executeButton\").onclick = executeCommand;\n    document.getElementById(\"clearButton\").onclick = clearInput;\n    document.getElementById(\"voiceButton\").onclick = toggleVoiceRecognition;\n    document.getElementById(\"settingsButton\").onclick = showSettings;\n\n    // Handle example clicks\n    const exampleItems = document.querySelectorAll('.example-item');\n    exampleItems.forEach(item => {\n      item.onclick = function() {\n        setCommand(this.getAttribute('data-command'));\n      };\n    });\n\n    // Handle Enter key\n    document.getElementById('commandInput').addEventListener('keydown', function(event) {\n      if (event.key === 'Enter' && !event.shiftKey) {\n        event.preventDefault();\n        executeCommand();\n      }\n    });\n\n    // Initialize speech recognition\n    initializeSpeechRecognition();\n  }\n});\n\n// Initialize speech recognition\nfunction initializeSpeechRecognition() {\n  const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;\n  \n  if (!SpeechRecognition) {\n    showStatus('음성 인식이 지원되지 않는 브라우저입니다.', 'error');\n    document.getElementById('voiceButton').disabled = true;\n    document.getElementById('voiceStatus').textContent = '음성 인식 미지원';\n    return null;\n  }\n  \n  recognition = new SpeechRecognition();\n  recognition.lang = 'ko-KR';\n  recognition.continuous = false;\n  recognition.interimResults = true;\n  recognition.maxAlternatives = 1;\n  \n  recognition.onstart = function() {\n    isListening = true;\n    document.getElementById('voiceButton').classList.add('listening');\n    document.getElementById('voiceStatus').textContent = '듣고 있습니다... 말씀해주세요';\n    document.getElementById('voiceStatus').classList.add('listening');\n  };\n  \n  recognition.onresult = function(event) {\n    const transcript = event.results[0][0].transcript;\n    document.getElementById('commandInput').value = transcript;\n    \n    if (event.results[0].isFinal) {\n      document.getElementById('voiceStatus').textContent = '음성 인식 완료';\n    } else {\n      document.getElementById('voiceStatus').textContent = '인식중: ' + transcript;\n    }\n  };\n  \n  recognition.onerror = function(event) {\n    isListening = false;\n    document.getElementById('voiceButton').classList.remove('listening');\n    document.getElementById('voiceStatus').classList.remove('listening');\n    \n    let errorMessage = '음성 인식 오류';\n    switch(event.error) {\n      case 'no-speech':\n        errorMessage = '음성이 감지되지 않았습니다.';\n        break;\n      case 'audio-capture':\n        errorMessage = '마이크를 찾을 수 없습니다.';\n        break;\n      case 'not-allowed':\n        errorMessage = '마이크 권한이 거부되었습니다.';\n        break;\n      case 'network':\n        errorMessage = '네트워크 오류가 발생했습니다.';\n        break;\n    }\n    \n    document.getElementById('voiceStatus').textContent = errorMessage;\n    showStatus(errorMessage, 'error');\n  };\n  \n  recognition.onend = function() {\n    isListening = false;\n    document.getElementById('voiceButton').classList.remove('listening');\n    document.getElementById('voiceStatus').classList.remove('listening');\n    \n    const command = document.getElementById('commandInput').value.trim();\n    if (command) {\n      document.getElementById('voiceStatus').textContent = '음성 인식 완료. 실행 버튼을 눌러주세요.';\n      document.getElementById('executeButton').focus();\n    } else {\n      document.getElementById('voiceStatus').textContent = '음성 인식 준비';\n    }\n  };\n  \n  return recognition;\n}\n\n// Toggle voice recognition\nfunction toggleVoiceRecognition() {\n  if (!recognition) {\n    recognition = initializeSpeechRecognition();\n    if (!recognition) return;\n  }\n  \n  if (isListening) {\n    recognition.stop();\n  } else {\n    recognition.start();\n  }\n}\n\n// Execute command\nasync function executeCommand() {\n  const command = document.getElementById('commandInput').value.trim();\n  \n  if (!command) {\n    showStatus('명령어를 입력해주세요.', 'error');\n    return;\n  }\n  \n  const button = document.getElementById('executeButton');\n  const originalText = '<span class=\"ms-Button-label\">실행</span>';\n  \n  // Show loading state\n  button.disabled = true;\n  button.innerHTML = '<span class=\"loading\"></span><span>처리중...</span>';\n  showStatus('명령을 처리하고 있습니다...', 'info');\n  \n  try {\n    await Excel.run(async (context) => {\n      // Get current worksheet context\n      const worksheet = context.workbook.worksheets.getActiveWorksheet();\n      const range = context.workbook.getSelectedRange();\n      \n      // Load necessary properties\n      worksheet.load(\"name\");\n      range.load([\"address\", \"rowIndex\", \"columnIndex\", \"rowCount\", \"columnCount\"]);\n      \n      // Get sheet data for context\n      const usedRange = worksheet.getUsedRange();\n      usedRange.load([\"rowCount\", \"columnCount\", \"values\"]);\n      \n      await context.sync();\n      \n      // Build sheet context\n      const sheetContext = {\n        sheetName: worksheet.name,\n        activeRange: {\n          address: range.address,\n          row: range.rowIndex + 1,\n          column: range.columnIndex + 1,\n          numRows: range.rowCount,\n          numColumns: range.columnCount\n        },\n        lastRow: usedRange ? usedRange.rowCount : 0,\n        lastColumn: usedRange ? usedRange.columnCount : 0,\n        headers: [],\n        dataRange: usedRange ? usedRange.values : [],\n        isLargeSheet: usedRange && usedRange.rowCount > 1000\n      };\n      \n      // Extract headers\n      if (usedRange && usedRange.rowCount > 0) {\n        const headerRow = usedRange.values[0];\n        for (let i = 0; i < headerRow.length; i++) {\n          sheetContext.headers.push({\n            column: i + 1,\n            columnLetter: getColumnLetter(i),\n            label: headerRow[i] ? headerRow[i].toString() : ''\n          });\n        }\n      }\n      \n      // Call OpenAI API to interpret the command\n      const interpretation = await callOpenAI(command, sheetContext);\n      \n      if (!interpretation.success) {\n        throw new Error(interpretation.error);\n      }\n      \n      // Execute the interpreted command\n      const result = await executeInterpretedCommand(context, interpretation.data);\n      \n      // Reset button and show success\n      button.disabled = false;\n      button.innerHTML = originalText;\n      \n      if (result.success) {\n        showStatus(result.message || '명령이 성공적으로 실행되었습니다.', 'success');\n        setTimeout(() => {\n          document.getElementById('commandInput').value = '';\n        }, 1000);\n      } else {\n        showStatus(result.error || '명령 실행에 실패했습니다.', 'error');\n      }\n    });\n  } catch (error) {\n    console.error('Error:', error);\n    button.disabled = false;\n    button.innerHTML = originalText;\n    showStatus('오류가 발생했습니다: ' + error.message, 'error');\n  }\n}\n\n// Call OpenAI API through proxy\nasync function callOpenAI(command, sheetContext) {\n  try {\n    const response = await fetch(API_PROXY_URL, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        command: command,\n        sheetContext: sheetContext\n      })\n    });\n    \n    if (!response.ok) {\n      const errorData = await response.json();\n      return {\n        success: false,\n        error: errorData.error || `서버 오류 (${response.status})`\n      };\n    }\n    \n    return await response.json();\n    \n  } catch (error) {\n    console.error('Proxy API Error:', error);\n    return {\n      success: false,\n      error: `API 요청 오류: ${error.toString()}`\n    };\n  }\n}\n\n// Original OpenAI API call (no longer used)\nasync function callOpenAIDirectly(command, sheetContext) {\n  const systemPrompt = `You are an Excel assistant that interprets natural language commands and returns JSON instructions for Excel operations.\n  \nAvailable operations:\n1. merge: Merge cells\n2. sum: Sum values in a range\n3. average: Calculate average\n4. count: Count cells (can count all, numbers only, or based on conditions)\n5. format: Format cells (bold, italic, font color, background color, etc.)\n6. sort: Sort data\n7. filter: Filter data\n8. insert: Insert rows/columns\n9. delete: Delete rows/columns\n10. formula: Add custom formula\n11. chart: Create chart\n12. conditional_format: Add conditional formatting\n13. translate: Translate cell contents to another language\n14. compress: Remove empty rows in a specific column range\n15. retry_translation: Retry translation for failed items marked as [번역 실패]\n\nThe JSON response format and parameter details are the same as the Google Sheets version.\n\nCurrent sheet context:\n- Active range: ${sheetContext.activeRange.address}\n- Sheet dimensions: ${sheetContext.lastRow} rows x ${sheetContext.lastColumn} columns\n- Headers: ${sheetContext.headers.map(h => `Column ${h.columnLetter}: \"${h.label}\"`).join(', ')}\n\nReturn JSON in this format:\n{\n  \"operation\": \"operation_name\",\n  \"parameters\": {\n    // operation-specific parameters\n  }\n}`;\n\n  const url = 'https://api.openai.com/v1/chat/completions';\n  \n  const payload = {\n    model: 'gpt-4.1-2025-04-14',\n    messages: [\n      { role: 'system', content: systemPrompt },\n      { role: 'user', content: `Current Excel state:\nHeaders: ${sheetContext.headers.map(h => `Column ${h.columnLetter}: \"${h.label}\"`).join(', ')}\nActive sheet: ${sheetContext.sheetName}\n\nUser command: ${command}` }\n    ],\n    temperature: 0.3,\n    max_tokens: 500\n  };\n  \n  try {\n    const response = await fetch(url, {\n      method: 'POST',\n      headers: {\n        'Authorization': `Bearer ${OPENAI_API_KEY}`,\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify(payload)\n    });\n    \n    if (!response.ok) {\n      const errorData = await response.json();\n      if (response.status === 429) {\n        return {\n          success: false,\n          error: 'API 요청 한도를 초과했습니다. 잠시 후 다시 시도해주세요.'\n        };\n      } else if (response.status === 401) {\n        return {\n          success: false,\n          error: 'API 키가 유효하지 않습니다. API 키를 확인해주세요.'\n        };\n      }\n      return {\n        success: false,\n        error: `API 오류 (${response.status}): ${errorData.error?.message || '알 수 없는 오류'}`\n      };\n    }\n    \n    const result = await response.json();\n    \n    if (result.choices && result.choices[0]) {\n      const content = result.choices[0].message.content;\n      try {\n        const parsedCommand = JSON.parse(content);\n        return {\n          success: true,\n          data: parsedCommand\n        };\n      } catch (parseError) {\n        console.error('Failed to parse AI response:', content);\n        return {\n          success: false,\n          error: 'AI 응답을 해석할 수 없습니다. 다시 시도해주세요.'\n        };\n      }\n    } else {\n      return {\n        success: false,\n        error: 'OpenAI API 응답을 파싱할 수 없습니다.'\n      };\n    }\n  } catch (error) {\n    console.error('OpenAI API Error:', error);\n    return {\n      success: false,\n      error: `OpenAI API 오류: ${error.toString()}`\n    };\n  }\n}\n\n// Execute the interpreted command\nasync function executeInterpretedCommand(context, commandData) {\n  const operation = commandData.operation;\n  const params = commandData.parameters || {};\n  \n  console.log(`Executing operation: ${operation} with params:`, params);\n  \n  try {\n    switch (operation) {\n      case 'merge':\n        return await executeMerge(context, params);\n      \n      case 'sum':\n        return await executeSum(context, params);\n      \n      case 'average':\n        return await executeAverage(context, params);\n      \n      case 'count':\n        return await executeCount(context, params);\n      \n      case 'format':\n        return await executeFormat(context, params);\n      \n      case 'sort':\n        return await executeSort(context, params);\n      \n      case 'filter':\n        return await executeFilter(context, params);\n      \n      case 'insert':\n        return await executeInsert(context, params);\n      \n      case 'delete':\n        return await executeDelete(context, params);\n      \n      case 'formula':\n        return await executeFormula(context, params);\n      \n      case 'chart':\n        return await executeChart(context, params);\n      \n      case 'conditional_format':\n        return await executeConditionalFormat(context, params);\n      \n      case 'translate':\n        return await executeTranslate(context, params);\n      \n      case 'compress':\n        return await executeCompress(context, params);\n      \n      case 'retry_translation':\n        return await executeRetryTranslation(context, params);\n      \n      default:\n        return {\n          success: false,\n          error: `알 수 없는 작업: ${operation}`\n        };\n    }\n  } catch (error) {\n    return {\n      success: false,\n      error: `작업 실행 중 오류: ${error.toString()}`\n    };\n  }\n}\n\n// Merge cells\nasync function executeMerge(context, params) {\n  const worksheet = context.workbook.worksheets.getActiveWorksheet();\n  const range = params.range ? worksheet.getRange(params.range) : context.workbook.getSelectedRange();\n  \n  range.merge();\n  await context.sync();\n  \n  return {\n    success: true,\n    message: `${range.address} 범위가 병합되었습니다.`\n  };\n}\n\n// Sum values\nasync function executeSum(context, params) {\n  const worksheet = context.workbook.worksheets.getActiveWorksheet();\n  const sourceRange = params.sourceRange ? worksheet.getRange(params.sourceRange) : context.workbook.getSelectedRange();\n  \n  sourceRange.load([\"columnIndex\", \"rowIndex\", \"rowCount\", \"address\"]);\n  await context.sync();\n  \n  if (params.addNewRow === true) {\n    // Add new row for sum\n    const column = sourceRange.columnIndex;\n    const lastRow = sourceRange.rowIndex + sourceRange.rowCount;\n    const newCell = worksheet.getCell(lastRow, column);\n    \n    newCell.formulas = [[`=SUM(${sourceRange.address})`]];\n    await context.sync();\n    \n    newCell.load(\"values\");\n    await context.sync();\n    \n    return {\n      success: true,\n      message: `${newCell.address}에 합계를 계산했습니다: ${formatNumber(newCell.values[0][0])}`,\n      value: newCell.values[0][0]\n    };\n  } else if (params.targetCell) {\n    // Sum to specific cell\n    const targetCell = worksheet.getRange(params.targetCell);\n    targetCell.formulas = [[`=SUM(${sourceRange.address})`]];\n    await context.sync();\n    \n    targetCell.load(\"values\");\n    await context.sync();\n    \n    return {\n      success: true,\n      message: `${targetCell.address}에 합계를 계산했습니다: ${formatNumber(targetCell.values[0][0])}`,\n      value: targetCell.values[0][0]\n    };\n  } else {\n    // Default: add sum below the range\n    const column = sourceRange.columnIndex;\n    const lastRow = sourceRange.rowIndex + sourceRange.rowCount;\n    const newCell = worksheet.getCell(lastRow, column);\n    \n    newCell.formulas = [[`=SUM(${sourceRange.address})`]];\n    await context.sync();\n    \n    newCell.load(\"values\");\n    await context.sync();\n    \n    return {\n      success: true,\n      message: `${newCell.address}에 합계를 계산했습니다: ${formatNumber(newCell.values[0][0])}`,\n      value: newCell.values[0][0]\n    };\n  }\n}\n\n// Calculate average\nasync function executeAverage(context, params) {\n  const worksheet = context.workbook.worksheets.getActiveWorksheet();\n  const sourceRange = params.sourceRange ? worksheet.getRange(params.sourceRange) : context.workbook.getSelectedRange();\n  \n  sourceRange.load([\"columnIndex\", \"rowIndex\", \"rowCount\", \"address\"]);\n  await context.sync();\n  \n  if (params.targetCell) {\n    const targetCell = worksheet.getRange(params.targetCell);\n    targetCell.formulas = [[`=AVERAGE(${sourceRange.address})`]];\n    await context.sync();\n    \n    targetCell.load(\"values\");\n    await context.sync();\n    \n    return {\n      success: true,\n      message: `${targetCell.address}에 평균을 계산했습니다: ${formatNumber(targetCell.values[0][0])}`,\n      value: targetCell.values[0][0]\n    };\n  } else {\n    const column = sourceRange.columnIndex;\n    const lastRow = sourceRange.rowIndex + sourceRange.rowCount;\n    const newCell = worksheet.getCell(lastRow, column);\n    \n    newCell.formulas = [[`=AVERAGE(${sourceRange.address})`]];\n    await context.sync();\n    \n    newCell.load(\"values\");\n    await context.sync();\n    \n    return {\n      success: true,\n      message: `${newCell.address}에 평균을 계산했습니다: ${formatNumber(newCell.values[0][0])}`,\n      value: newCell.values[0][0]\n    };\n  }\n}\n\n// Count cells\nasync function executeCount(context, params) {\n  const worksheet = context.workbook.worksheets.getActiveWorksheet();\n  const sourceRange = params.sourceRange ? worksheet.getRange(params.sourceRange) : context.workbook.getSelectedRange();\n  \n  sourceRange.load([\"address\"]);\n  await context.sync();\n  \n  let formula;\n  if (params.countType === 'countif' && params.condition !== undefined) {\n    let criteria;\n    if (params.operator === 'contains') {\n      criteria = `\"*${params.condition}*\"`;\n    } else if (params.operator === 'equals') {\n      criteria = typeof params.condition === 'string' ? `\"${params.condition}\"` : params.condition;\n    } else if (params.operator && ['>', '<', '>=', '<=', '<>'].includes(params.operator)) {\n      criteria = `\"${params.operator}${params.condition}\"`;\n    } else {\n      if (typeof params.condition === 'string') {\n        criteria = `\"*${params.condition}*\"`;\n      } else {\n        criteria = params.condition;\n      }\n    }\n    formula = `=COUNTIF(${sourceRange.address}, ${criteria})`;\n  } else if (params.countType === 'counta') {\n    formula = `=COUNTA(${sourceRange.address})`;\n  } else {\n    formula = `=COUNT(${sourceRange.address})`;\n  }\n  \n  let resultCell;\n  if (params.targetCell) {\n    resultCell = worksheet.getRange(params.targetCell);\n  } else {\n    const usedRange = worksheet.getUsedRange();\n    await context.sync();\n    \n    const lastRow = usedRange ? usedRange.rowCount : 1;\n    const lastCol = usedRange ? usedRange.columnCount : 1;\n    resultCell = worksheet.getCell(lastRow, lastCol);\n  }\n  \n  resultCell.formulas = [[formula]];\n  await context.sync();\n  \n  resultCell.load(\"values\");\n  await context.sync();\n  \n  return {\n    success: true,\n    message: params.countType === 'countif' ? \n      `\"${params.condition}\"을(를) 포함하는 셀의 개수: ${formatNumber(resultCell.values[0][0])}개` :\n      `개수를 계산했습니다: ${formatNumber(resultCell.values[0][0])}개`,\n    value: resultCell.values[0][0]\n  };\n}\n\n// Format cells\nasync function executeFormat(context, params) {\n  const worksheet = context.workbook.worksheets.getActiveWorksheet();\n  const range = params.range ? worksheet.getRange(params.range) : context.workbook.getSelectedRange();\n  \n  range.load(\"format\");\n  await context.sync();\n  \n  if (params.bold !== undefined) {\n    range.format.font.bold = params.bold;\n  }\n  \n  if (params.italic !== undefined) {\n    range.format.font.italic = params.italic;\n  }\n  \n  if (params.fontSize) {\n    range.format.font.size = params.fontSize;\n  }\n  \n  if (params.fontColor) {\n    range.format.font.color = params.fontColor;\n  }\n  \n  if (params.backgroundColor) {\n    range.format.fill.color = params.backgroundColor;\n  }\n  \n  if (params.horizontalAlignment) {\n    range.format.horizontalAlignment = params.horizontalAlignment === 'left' ? 'Left' :\n                                     params.horizontalAlignment === 'center' ? 'Center' :\n                                     params.horizontalAlignment === 'right' ? 'Right' : 'General';\n  }\n  \n  if (params.numberFormat) {\n    range.numberFormat = [[params.numberFormat]];\n  }\n  \n  await context.sync();\n  \n  return {\n    success: true,\n    message: '서식이 적용되었습니다.'\n  };\n}\n\n// Sort data\nasync function executeSort(context, params) {\n  const worksheet = context.workbook.worksheets.getActiveWorksheet();\n  const range = params.range ? worksheet.getRange(params.range) : worksheet.getUsedRange();\n  \n  const column = params.column || 1;\n  const ascending = params.ascending !== undefined ? params.ascending : true;\n  \n  range.sort.apply([\n    {\n      key: column - 1, // Excel API uses 0-based index\n      ascending: ascending\n    }\n  ]);\n  \n  await context.sync();\n  \n  const columnLetter = getColumnLetter(column - 1);\n  \n  return {\n    success: true,\n    message: `${columnLetter}열 기준으로 ${ascending ? '오름차순' : '내림차순'} 정렬되었습니다.`\n  };\n}\n\n// Create chart\nasync function executeChart(context, params) {\n  const worksheet = context.workbook.worksheets.getActiveWorksheet();\n  const sourceData = params.range ? worksheet.getRange(params.range) : context.workbook.getSelectedRange();\n  \n  const chart = worksheet.charts.add(\n    params.chartType === 'bar' ? 'ColumnClustered' : 'ColumnClustered',\n    sourceData,\n    'Auto'\n  );\n  \n  if (params.title) {\n    chart.title.text = params.title;\n  }\n  \n  // Position the chart\n  chart.left = params.offsetX || 100;\n  chart.top = params.offsetY || 100;\n  \n  await context.sync();\n  \n  return {\n    success: true,\n    message: '차트가 생성되었습니다.'\n  };\n}\n\n// Add conditional formatting\nasync function executeConditionalFormat(context, params) {\n  const worksheet = context.workbook.worksheets.getActiveWorksheet();\n  const range = params.range ? worksheet.getRange(params.range) : worksheet.getUsedRange();\n  \n  const conditionalFormat = range.conditionalFormats.add(Excel.ConditionalFormatType.cellValue);\n  \n  // Set the rule based on condition\n  if (params.condition === 'greater_than' && params.value !== undefined) {\n    conditionalFormat.cellValue.rule = {\n      formula1: params.value.toString(),\n      operator: Excel.ConditionalCellValueOperator.greaterThan\n    };\n  } else if (params.condition === 'less_than' && params.value !== undefined) {\n    conditionalFormat.cellValue.rule = {\n      formula1: params.value.toString(),\n      operator: Excel.ConditionalCellValueOperator.lessThan\n    };\n  } else if (params.condition === 'equal_to' && params.value !== undefined) {\n    conditionalFormat.cellValue.rule = {\n      formula1: params.value.toString(),\n      operator: Excel.ConditionalCellValueOperator.equalTo\n    };\n  } else {\n    // Default to greater than\n    conditionalFormat.cellValue.rule = {\n      formula1: (params.value || 0).toString(),\n      operator: Excel.ConditionalCellValueOperator.greaterThan\n    };\n  }\n  \n  // Set the format\n  conditionalFormat.cellValue.format.fill.color = params.backgroundColor || \"#00ff00\";\n  if (params.fontColor) {\n    conditionalFormat.cellValue.format.font.color = params.fontColor;\n  }\n  if (params.bold) {\n    conditionalFormat.cellValue.format.font.bold = true;\n  }\n  \n  await context.sync();\n  \n  return {\n    success: true,\n    message: `조건부 서식이 적용되었습니다. (${params.condition} ${params.value})`\n  };\n}\n\n// Translate column contents\nasync function executeTranslate(context, params) {\n  const worksheet = context.workbook.worksheets.getActiveWorksheet();\n  \n  if (!params.targetLanguage) {\n    return { success: false, error: '대상 언어를 지정해주세요.' };\n  }\n  \n  let sourceRange;\n  let targetColumnIndex;\n  \n  if (params.sourceRange) {\n    sourceRange = worksheet.getRange(params.sourceRange);\n  } else if (params.sourceColumn) {\n    const columnIndex = params.sourceColumn.charCodeAt(0) - 65;\n    const usedRange = worksheet.getUsedRange();\n    usedRange.load([\"rowCount\"]);\n    await context.sync();\n    \n    if (usedRange.rowCount > 1) {\n      sourceRange = worksheet.getRangeByIndexes(1, columnIndex, usedRange.rowCount - 1, 1);\n    } else {\n      return { success: false, error: '번역할 데이터가 없습니다.' };\n    }\n    \n    targetColumnIndex = params.targetColumn === 'next' ? columnIndex + 1 :\n                       params.targetColumn ? params.targetColumn.charCodeAt(0) - 65 : columnIndex + 1;\n  } else {\n    return { success: false, error: '번역할 열을 지정해주세요.' };\n  }\n  \n  sourceRange.load([\"values\", \"rowIndex\", \"columnIndex\", \"rowCount\"]);\n  await context.sync();\n  \n  const sourceValues = sourceRange.values;\n  const translations = [];\n  const batchSize = 20;\n  \n  // Translate in batches\n  for (let i = 0; i < sourceValues.length; i += batchSize) {\n    const batch = sourceValues.slice(i, Math.min(i + batchSize, sourceValues.length));\n    const batchTexts = batch.map(row => row[0]).filter(text => text);\n    \n    if (batchTexts.length > 0) {\n      const translatedBatch = await translateBatch(batchTexts, params.targetLanguage, params.sourceLanguage);\n      \n      let translationIndex = 0;\n      for (let j = 0; j < batch.length; j++) {\n        if (batch[j][0]) {\n          translations.push([translatedBatch[translationIndex]]);\n          translationIndex++;\n        } else {\n          translations.push(['']);\n        }\n      }\n    } else {\n      for (let j = 0; j < batch.length; j++) {\n        translations.push(['']);\n      }\n    }\n    \n    // Show progress\n    if (i % 100 === 0 && i > 0) {\n      showStatus(`번역 중... ${Math.round((i / sourceValues.length) * 100)}%`, 'info');\n    }\n  }\n  \n  // Write translations\n  const targetRange = worksheet.getRangeByIndexes(\n    sourceRange.rowIndex,\n    targetColumnIndex || sourceRange.columnIndex + 1,\n    translations.length,\n    1\n  );\n  \n  targetRange.values = translations;\n  await context.sync();\n  \n  // Add header\n  const headerCell = worksheet.getCell(0, targetColumnIndex || sourceRange.columnIndex + 1);\n  const sourceHeaderCell = worksheet.getCell(0, sourceRange.columnIndex);\n  sourceHeaderCell.load(\"values\");\n  await context.sync();\n  \n  headerCell.values = [[`${sourceHeaderCell.values[0][0]} (${params.targetLanguage})`]];\n  await context.sync();\n  \n  return {\n    success: true,\n    message: `번역이 완료되었습니다. (${sourceValues.length}개 항목)`\n  };\n}\n\n// Translate a batch of texts through proxy\nasync function translateBatch(texts, targetLanguage, sourceLanguage) {\n  try {\n    const response = await fetch(API_PROXY_URL, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        command: `Translate these items to ${targetLanguage}: ${texts.join(', ')}`,\n        sheetContext: {\n          operation: 'translate_batch',\n          texts: texts,\n          targetLanguage: targetLanguage,\n          sourceLanguage: sourceLanguage\n        }\n      })\n    });\n    \n    if (!response.ok) {\n      throw new Error(`HTTP error! status: ${response.status}`);\n    }\n    \n    const result = await response.json();\n    \n    if (result.success && result.data && result.data.translations) {\n      return result.data.translations;\n    } else if (result.error) {\n      throw new Error(result.error);\n    } else {\n      throw new Error('번역 응답을 받을 수 없습니다.');\n    }\n  } catch (error) {\n    console.error('Translation error:', error);\n    return texts.map(() => '');\n  }\n}\n\n// Helper functions\nfunction getColumnLetter(columnIndex) {\n  let columnLetter = '';\n  let tempIndex = columnIndex;\n  \n  while (tempIndex >= 0) {\n    columnLetter = String.fromCharCode((tempIndex % 26) + 65) + columnLetter;\n    tempIndex = Math.floor(tempIndex / 26) - 1;\n  }\n  \n  return columnLetter;\n}\n\nfunction formatNumber(value) {\n  if (typeof value === 'number') {\n    if (Number.isInteger(value)) {\n      return value.toLocaleString('ko-KR');\n    } else {\n      return value.toLocaleString('ko-KR', { minimumFractionDigits: 0, maximumFractionDigits: 2 });\n    }\n  }\n  return value;\n}\n\nfunction showStatus(message, type) {\n  const status = document.getElementById('status');\n  status.textContent = message;\n  status.className = 'status-message ' + type;\n  status.style.display = 'block';\n  \n  if (window.statusTimeout) {\n    clearTimeout(window.statusTimeout);\n  }\n  \n  if (type === 'success') {\n    window.statusTimeout = setTimeout(() => {\n      status.style.display = 'none';\n    }, 5000);\n  }\n}\n\nfunction clearInput() {\n  document.getElementById('commandInput').value = '';\n  document.getElementById('status').style.display = 'none';\n}\n\nfunction setCommand(command) {\n  document.getElementById('commandInput').value = command;\n  document.getElementById('commandInput').focus();\n}\n\nfunction showSettings() {\n  showStatus('이 애드인은 보안 서버를 통해 AI 기능을 제공합니다. 별도의 API 키 설정이 필요하지 않습니다.', 'info');\n}\n\n// Additional operations (compress, filter, insert, delete, formula, retry_translation)\n// These would need to be implemented based on Excel JavaScript API capabilities\n\nasync function executeCompress(context, params) {\n  // Implementation would be similar to Google Sheets version\n  // but using Excel JavaScript API\n  return {\n    success: false,\n    error: '이 기능은 현재 구현 중입니다.'\n  };\n}\n\nasync function executeFilter(context, params) {\n  const worksheet = context.workbook.worksheets.getActiveWorksheet();\n  const range = params.range ? worksheet.getRange(params.range) : worksheet.getUsedRange();\n  \n  // Apply autofilter\n  range.worksheet.autoFilter.apply(range);\n  \n  await context.sync();\n  \n  return {\n    success: true,\n    message: '필터가 적용되었습니다.'\n  };\n}\n\nasync function executeInsert(context, params) {\n  const worksheet = context.workbook.worksheets.getActiveWorksheet();\n  const type = params.type || 'row';\n  const position = params.position || 1;\n  const count = params.count || 1;\n  \n  if (type === 'row') {\n    const range = worksheet.getRangeByIndexes(position - 1, 0, count, 1);\n    range.insert(Excel.InsertShiftDirection.down);\n  } else {\n    const range = worksheet.getRangeByIndexes(0, position - 1, 1, count);\n    range.insert(Excel.InsertShiftDirection.right);\n  }\n  \n  await context.sync();\n  \n  return {\n    success: true,\n    message: `${count}개의 ${type === 'row' ? '행' : '열'}이 삽입되었습니다.`\n  };\n}\n\nasync function executeDelete(context, params) {\n  const worksheet = context.workbook.worksheets.getActiveWorksheet();\n  const type = params.type || 'row';\n  const position = params.position || 1;\n  const count = params.count || 1;\n  \n  if (type === 'row') {\n    const range = worksheet.getRangeByIndexes(position - 1, 0, count, 1);\n    range.delete(Excel.DeleteShiftDirection.up);\n  } else {\n    const range = worksheet.getRangeByIndexes(0, position - 1, 1, count);\n    range.delete(Excel.DeleteShiftDirection.left);\n  }\n  \n  await context.sync();\n  \n  return {\n    success: true,\n    message: `${count}개의 ${type === 'row' ? '행' : '열'}이 삭제되었습니다.`\n  };\n}\n\nasync function executeFormula(context, params) {\n  const worksheet = context.workbook.worksheets.getActiveWorksheet();\n  const range = params.range ? worksheet.getRange(params.range) : context.workbook.getSelectedRange();\n  \n  if (!params.formula) {\n    return { success: false, error: '수식을 지정해주세요.' };\n  }\n  \n  range.formulas = [[params.formula]];\n  await context.sync();\n  \n  return {\n    success: true,\n    message: '수식이 적용되었습니다.'\n  };\n}\n\nasync function executeRetryTranslation(context, params) {\n  // Implementation would be similar to Google Sheets version\n  // but using Excel JavaScript API\n  return {\n    success: false,\n    error: '이 기능은 현재 구현 중입니다.'\n  };\n}"],"names":["__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","__webpack_modules__","m","g","globalThis","this","Function","e","window","o","obj","prop","Object","prototype","hasOwnProperty","call","scriptUrl","importScripts","location","document","currentScript","tagName","toUpperCase","src","scripts","getElementsByTagName","length","i","test","Error","replace","p","b","baseURI","self","href","URL","t","r","Symbol","n","iterator","toStringTag","c","Generator","u","create","_regeneratorDefine2","f","y","G","v","a","d","bind","l","TypeError","done","value","return","GeneratorFunction","GeneratorFunctionPrototype","getPrototypeOf","setPrototypeOf","__proto__","displayName","_regenerator","w","defineProperty","_invoke","enumerable","configurable","writable","asyncGeneratorStep","Promise","resolve","then","_asyncToGenerator","arguments","apply","_next","_throw","recognition","isListening","API_PROXY_URL","process","initializeSpeechRecognition","SpeechRecognition","webkitSpeechRecognition","lang","continuous","interimResults","maxAlternatives","onstart","getElementById","classList","add","textContent","onresult","event","transcript","results","isFinal","onerror","remove","errorMessage","error","showStatus","onend","trim","focus","disabled","toggleVoiceRecognition","stop","start","executeCommand","_executeCommand","_callee2","command","button","originalText","_t","_context2","innerHTML","Excel","run","_ref","_callee","context","worksheet","range","usedRange","sheetContext","headerRow","interpretation","result","_context","workbook","worksheets","getActiveWorksheet","getSelectedRange","load","getUsedRange","sync","sheetName","name","activeRange","address","row","rowIndex","column","columnIndex","numRows","rowCount","numColumns","columnCount","lastRow","lastColumn","headers","dataRange","values","isLargeSheet","push","columnLetter","getColumnLetter","label","toString","callOpenAI","success","executeInterpretedCommand","data","message","setTimeout","_x38","console","_x","_x2","_callOpenAI","_callee3","response","errorData","_t2","_context3","fetch","method","body","JSON","stringify","ok","json","concat","status","_x5","_x6","_executeInterpretedCommand","_callee5","commandData","operation","params","_t5","_t6","_context5","parameters","log","executeMerge","executeSum","executeAverage","executeCount","executeFormat","executeSort","executeFilter","executeInsert","executeDelete","executeFormula","executeChart","executeConditionalFormat","executeTranslate","executeCompress","executeRetryTranslation","_x7","_x8","_executeMerge","_callee6","_context6","getRange","merge","_x9","_x0","_executeSum","_callee7","sourceRange","newCell","targetCell","_column","_lastRow","_newCell","_context7","addNewRow","getCell","formulas","formatNumber","_x1","_x10","_executeAverage","_callee8","_context8","_x11","_x12","_executeCount","_callee9","formula","criteria","resultCell","lastCol","_context9","countType","condition","operator","includes","_x13","_x14","_executeFormat","_callee0","_context0","bold","format","font","italic","fontSize","size","fontColor","color","backgroundColor","fill","horizontalAlignment","numberFormat","_x15","_x16","_executeSort","_callee1","ascending","_context1","sort","key","_x17","_x18","_executeChart","_callee10","sourceData","chart","_context10","charts","chartType","title","text","left","offsetX","top","offsetY","_x19","_x20","_executeConditionalFormat","_callee11","conditionalFormat","_context11","conditionalFormats","ConditionalFormatType","cellValue","rule","formula1","ConditionalCellValueOperator","greaterThan","lessThan","equalTo","_x21","_x22","_executeTranslate","_callee12","targetColumnIndex","sourceValues","translations","batchSize","batch","batchTexts","translatedBatch","translationIndex","j","_j","headerCell","sourceHeaderCell","_context12","targetLanguage","sourceColumn","charCodeAt","getRangeByIndexes","targetColumn","slice","Math","min","map","filter","translateBatch","sourceLanguage","round","_x23","_x24","_x25","_translateBatch","_callee13","texts","_t7","_context13","join","tempIndex","String","fromCharCode","floor","Number","isInteger","toLocaleString","minimumFractionDigits","maximumFractionDigits","type","className","style","display","statusTimeout","clearTimeout","clearInput","showSettings","_x26","_x27","_executeCompress","_callee14","_context14","_x28","_x29","_executeFilter","_callee15","_context15","autoFilter","_x30","_x31","_executeInsert","_callee16","position","count","_context16","insert","InsertShiftDirection","down","right","_x32","_x33","_executeDelete","_callee17","_context17","delete","DeleteShiftDirection","up","_x34","_x35","_executeFormula","_callee18","_context18","_x36","_x37","_executeRetryTranslation","_callee19","_context19","Office","onReady","info","host","HostType","onclick","querySelectorAll","forEach","item","getAttribute","addEventListener","shiftKey","preventDefault"],"sourceRoot":""}